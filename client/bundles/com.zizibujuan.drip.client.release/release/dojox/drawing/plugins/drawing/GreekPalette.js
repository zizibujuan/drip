//>>built
define("dojox/drawing/plugins/drawing/GreekPalette",["dojo","dijit/popup","../../library/greek","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","dijit/_PaletteMixin","dojo/i18n!dojox/editor/plugins/nls/latinEntities"],function(dojo,popup,greek,focus,Widget,TemplatedMixin,PaletteMixin,latinEntities){var Greeks=dojo.declare(null,{constructor:function(alias){this._alias=alias},getValue:function(){return this._alias},fillCell:function(cell){cell.innerHTML="&"+this._alias+";"}});return dojo.declare("dojox.drawing.plugins.drawing.GreekPalette",[Widget,TemplatedMixin,PaletteMixin],{postMixInProperties:function(){var choices=greek,numChoices=0,entityKey;for(entityKey in choices)numChoices++;var choicesPerRow=Math.floor(Math.sqrt(numChoices)),numRows=choicesPerRow,currChoiceIdx=0,rows=[],row=[];for(entityKey in choices)currChoiceIdx++,row.push(entityKey),currChoiceIdx%numRows===0&&(rows.push(row),row=[]);row.length>0&&rows.push(row),this._palette=rows},show:function(obj){dojo.mixin(obj,{popup:this}),popup.open(obj)},onChange:function(val){var textBlock=this._textBlock;popup.hide(this),textBlock.insertText(this._pushChangeTo,val),textBlock._dropMode=!1},onCancel:function(closeAll){popup.hide(this),this._textBlock._dropMode=!1},templateString:'<div class="dojoxEntityPalette">\n	<table>\n		<tbody>\n			<tr>\n				<td>\n					<table class="dijitPaletteTable">\n						<tbody dojoAttachPoint="gridNode"></tbody>\n				   </table>\n				</td>\n			</tr>\n			<tr>\n				<td>\n					<table dojoAttachPoint="previewPane" class="dojoxEntityPalettePreviewTable">\n						<tbody>\n							<tr>\n								<td class="dojoxEntityPalettePreviewDetailEntity">Type: <span class="dojoxEntityPalettePreviewDetail" dojoAttachPoint="previewNode"></span></td>\n							</tr>\n						</tbody>\n					</table>\n				</td>\n			</tr>\n		</tbody>\n	</table>\n</div>',baseClass:"dojoxEntityPalette",showPreview:!0,dyeClass:Greeks,paletteClass:"editorLatinEntityPalette",cellClass:"dojoxEntityPaletteCell",buildRendering:function(){this.inherited(arguments);var i18n=latinEntities;this._preparePalette(this._palette,i18n);var cells=dojo.query(".dojoxEntityPaletteCell",this.gridNode);dojo.forEach(cells,function(cellNode){this.connect(cellNode,"onmouseenter","_onCellMouseEnter")},this)},_onCellMouseEnter:function(e){this.showPreview&&this._displayDetails(e.target)},_onCellClick:function(evt){var target=evt.type=="click"?evt.currentTarget:this._currentFocus,value=this._getDye(target).getValue();this._setCurrent(target),setTimeout(dojo.hitch(this,function(){focus(target),this._setValueAttr(value,!0)})),dojo.removeClass(target,"dijitPaletteCellHover"),dojo.stopEvent(evt)},postCreate:function(){this.inherited(arguments),this.showPreview||dojo.style(this.previewNode,"display","none"),popup.moveOffScreen(this)},_setCurrent:function(node){"_currentFocus"in this&&(dojo.attr(this._currentFocus,"tabIndex","-1"),dojo.removeClass(this._currentFocus,"dojoxEntityPaletteCellHover")),this._currentFocus=node,node&&(dojo.attr(node,"tabIndex",this.tabIndex),dojo.addClass(this._currentFocus,"dojoxEntityPaletteCellHover")),this.showPreview&&this._displayDetails(node)},_displayDetails:function(cell){var dye=this._getDye(cell);if(dye){var ehtml=dye.getValue(),ename=dye._alias;this.previewNode.innerHTML=ehtml}else this.previewNode.innerHTML="",this.descNode.innerHTML=""},_preparePalette:function(choices,titles){this._cells=[];var url=this._blankGif,dyeClassObj=typeof this.dyeClass=="string"?dojo.getObject(this.dyeClass):this.dyeClass;for(var row=0;row<choices.length;row++){var rowNode=dojo.create("tr",{tabIndex:"-1"},this.gridNode);for(var col=0;col<choices[row].length;col++){var value=choices[row][col];if(value){var cellObject=new dyeClassObj(value),cellNode=dojo.create("td",{"class":this.cellClass,tabIndex:"-1",title:titles[value]});cellObject.fillCell(cellNode,url),this.connect(cellNode,"ondijitclick","_onCellClick"),this._trackMouseState(cellNode,this.cellClass),dojo.place(cellNode,rowNode),cellNode.idx=this._cells.length,this._cells.push({node:cellNode,dye:cellObject})}}}this._xDim=choices[0].length,this._yDim=choices.length},_navigateByArrow:function(evt){var keyIncrementMap={38:-this._xDim,40:this._xDim,39:this.isLeftToRight()?1:-1,37:this.isLeftToRight()?-1:1},increment=keyIncrementMap[evt.keyCode],newFocusIndex=this._currentFocus.idx+increment;if(newFocusIndex<this._cells.length&&newFocusIndex>-1){var focusNode=this._cells[newFocusIndex].node;this._setCurrent(focusNode)}}})})