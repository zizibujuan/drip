//>>built
define("dojox/mdnd/PureSource",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/dom-class","dojo/dnd/common","dojo/dnd/Selector","dojo/dnd/Manager"],function(dojo,declare,lang,connect,array,domClass,dnd,Selector,Manager){return declare("dojox.mdnd.PureSource",Selector,{horizontal:!1,copyOnly:!0,skipForm:!1,withHandles:!1,isSource:!0,targetState:"Disabled",generateText:!0,constructor:function(node,params){lang.mixin(this,lang.mixin({},params));var type=this.accept;this.isDragging=!1,this.mouseDown=!1,this.sourceState="",domClass.add(this.node,"dojoDndSource"),this.horizontal&&domClass.add(this.node,"dojoDndHorizontal"),this.topics=[connect.subscribe("/dnd/cancel",this,"onDndCancel"),connect.subscribe("/dnd/drop",this,"onDndCancel")]},onDndCancel:function(){this.isDragging=!1,this.mouseDown=!1,delete this.mouseButton},copyState:function(keyPressed){return this.copyOnly||keyPressed},destroy:function(){dojox.mdnd.PureSource.superclass.destroy.call(this),array.forEach(this.topics,connect.unsubscribe),this.targetAnchor=null},markupFactory:function(params,node){return params._skipStartup=!0,new dojox.mdnd.PureSource(node,params)},onMouseMove:function(e){if(this.isDragging)return;dojox.mdnd.PureSource.superclass.onMouseMove.call(this,e);var m=Manager.manager();if(this.mouseDown&&!this.isDragging&&this.isSource){var nodes=this.getSelectedNodes();nodes.length&&(m.startDrag(this,nodes,this.copyState(connect.isCopyKey(e))),this.isDragging=!0)}},onMouseDown:function(e){this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))&&(this.mouseDown=!0,this.mouseButton=e.button,dojox.mdnd.PureSource.superclass.onMouseDown.call(this,e))},onMouseUp:function(e){this.mouseDown&&(this.mouseDown=!1,dojox.mdnd.PureSource.superclass.onMouseUp.call(this,e))},onOverEvent:function(){dojox.mdnd.PureSource.superclass.onOverEvent.call(this),Manager.manager().overSource(this)},onOutEvent:function(){dojox.mdnd.PureSource.superclass.onOutEvent.call(this),Manager.manager().outSource(this)},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved")},_legalMouseDown:function(e){if(!this.withHandles)return!0;for(var node=e.target;node&&!domClass.contains(node,"dojoDndItem");node=node.parentNode)if(domClass.contains(node,"dojoDndHandle"))return!0;return!1}})})