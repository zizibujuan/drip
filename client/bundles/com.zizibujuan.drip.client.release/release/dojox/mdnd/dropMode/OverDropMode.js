//>>built
define("dojox/mdnd/dropMode/OverDropMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/connect","dojo/_base/array","dojo/dom-geometry","dojox/mdnd/AreaManager"],function(dojo,declare,connect,array,geom){var odm=declare("dojox.mdnd.dropMode.OverDropMode",null,{_oldXPoint:null,_oldYPoint:null,_oldBehaviour:"up",constructor:function(){this._dragHandler=[connect.connect(dojox.mdnd.areaManager(),"onDragEnter",function(coords,size){var m=dojox.mdnd.areaManager();m._oldIndexArea==-1&&(m._oldIndexArea=m._lastValidIndexArea)})]},addArea:function(areas,object){var length=areas.length,position=geom.position(object.node,!0);object.coords={x:position.x,y:position.y};if(length==0)areas.push(object);else{var x=object.coords.x;for(var i=0;i<length;i++)if(x<areas[i].coords.x){for(var j=length-1;j>=i;j--)areas[j+1]=areas[j];areas[i]=object;break}i==length&&areas.push(object)}return areas},updateAreas:function(areaList){var length=areaList.length;for(var i=0;i<length;i++)this._updateArea(areaList[i])},_updateArea:function(area){var position=geom.position(area.node,!0);area.coords.x=position.x,area.coords.x2=position.x+position.w,area.coords.y=position.y},initItems:function(area){array.forEach(area.items,function(obj){var node=obj.item.node,position=geom.position(node,!0),y=position.y+position.h/2;obj.y=y}),area.initItems=!0},refreshItems:function(area,indexItem,size,added){if(indexItem==-1)return;if(area&&size&&size.h){var height=size.h;area.margin&&(height+=area.margin.t);var length=area.items.length;for(var i=indexItem;i<length;i++){var item=area.items[i];added?item.y+=height:item.y-=height}}},getDragPoint:function(coords,size,mousePosition){return{x:mousePosition.x,y:mousePosition.y}},getTargetArea:function(areaList,coords,currentIndexArea){var index=0,x=coords.x,y=coords.y,end=areaList.length,start=0,direction="right",compute=!1;currentIndexArea==-1||arguments.length<3?compute=!0:this._checkInterval(areaList,currentIndexArea,x,y)?index=currentIndexArea:(this._oldXPoint<x?start=currentIndexArea+1:(start=currentIndexArea-1,end=0,direction="left"),compute=!0);if(compute)if(direction==="right"){for(var i=start;i<end;i++)if(this._checkInterval(areaList,i,x,y)){index=i;break}i==end&&(index=-1)}else{for(var i=start;i>=end;i--)if(this._checkInterval(areaList,i,x,y)){index=i;break}i==end-1&&(index=-1)}return this._oldXPoint=x,index},_checkInterval:function(areaList,index,x,y){var area=areaList[index],node=area.node,coords=area.coords,startX=coords.x,endX=coords.x2,startY=coords.y,endY=startY+node.offsetHeight;return startX<=x&&x<=endX&&startY<=y&&y<=endY?!0:!1},getDropIndex:function(targetArea,coords){var length=targetArea.items.length,coordinates=targetArea.coords,y=coords.y;if(length>0)for(var i=0;i<length;i++){if(y<targetArea.items[i].y)return i;if(i==length-1)return-1}return-1},destroy:function(){array.forEach(this._dragHandler,connect.disconnect)}});return dojox.mdnd.areaManager()._dropMode=new dojox.mdnd.dropMode.OverDropMode,odm})