//>>built
define("dojox/image/FlickrBadge",["dojo","dojox/main","dojox/image/Badge","dojox/data/FlickrRestStore"],function(dojo,dojox){return dojo.getObject("image",!0,dojox),dojo.declare("dojox.image.FlickrBadge",dojox.image.Badge,{children:"a.flickrImage",userid:"",username:"",setid:"",tags:"",searchText:"",target:"",apikey:"8c6803164dbc395fb7131c9d54843627",_store:null,postCreate:function(){if(this.username&&!this.userid){var def=dojo.io.script.get({url:"http://www.flickr.com/services/rest/",preventCache:!0,content:{format:"json",method:"flickr.people.findByUsername",api_key:this.apikey,username:this.username},callbackParamName:"jsoncallback"});def.addCallback(this,function(data){data.user&&data.user.nsid&&(this.userid=data.user.nsid,this._started||this.startup())})}},startup:function(){if(this._started)return;if(this.userid){var query={userid:this.userid};this.setid&&(query.setid=this.setid),this.tags&&(query.tags=this.tags),this.searchText&&(query.text=this.searchText);var args=arguments;this._store=new dojox.data.FlickrRestStore({apikey:this.apikey}),this._store.fetch({count:this.cols*this.rows,query:query,onComplete:dojo.hitch(this,function(items){dojo.forEach(items,function(item){var a=dojo.doc.createElement("a");dojo.addClass(a,"flickrImage"),a.href=this._store.getValue(item,"link"),this.target&&(a.target=this.target);var img=dojo.doc.createElement("img");img.src=this._store.getValue(item,"imageUrlThumb"),dojo.style(img,{width:"100%",height:"100%"}),a.appendChild(img),this.domNode.appendChild(a)},this),dojox.image.Badge.prototype.startup.call(this,args)})})}}})})