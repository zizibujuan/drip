//>>built
define("dojox/date/persian",["..","dojo/_base/lang","dojo/date","./persian/Date"],function(dojox,lang,dd,IDate){var dpersian=lang.getObject("date.persian",!0,dojox);return dpersian.getDaysInMonth=function(month){return month.getDaysInPersianMonth(month.getMonth(),month.getFullYear())},dpersian.compare=function(date1,date2,portion){return date1 instanceof IDate&&(date1=date1.toGregorian()),date2 instanceof IDate&&(date2=date2.toGregorian()),dd.compare.apply(null,arguments)},dpersian.add=function(date,interval,amount){var newPersianDate=new IDate(date);switch(interval){case"day":newPersianDate.setDate(date.getDate()+amount);break;case"weekday":var day=date.getDay();if(day+amount<5&&day+amount>0)newPersianDate.setDate(date.getDate()+amount);else{var adddays=0,remdays=0;day==5?(day=4,remdays=amount>0?-1:1):day==6&&(day=4,remdays=amount>0?-2:2);var add=amount>0?5-day-1:-day,amountdif=amount-add,div=parseInt(amountdif/5);amountdif%5!=0&&(adddays=amount>0?2:-2),adddays=adddays+div*7+amountdif%5+add,newPersianDate.setDate(date.getDate()+adddays+remdays)}break;case"year":newPersianDate.setFullYear(date.getFullYear()+amount);break;case"week":amount*=7,newPersianDate.setDate(date.getDate()+amount);break;case"month":var month=date.getMonth();newPersianDate.setMonth(month+amount);break;case"hour":newPersianDate.setHours(date.getHours()+amount);break;case"minute":newPersianDate._addMinutes(amount);break;case"second":newPersianDate._addSeconds(amount);break;case"millisecond":newPersianDate._addMilliseconds(amount)}return newPersianDate},dpersian.difference=function(date1,date2,interval){date2=date2||new IDate,interval=interval||"day";var yearDiff=date2.getFullYear()-date1.getFullYear(),delta=1;switch(interval){case"weekday":var days=Math.round(dpersian.difference(date1,date2,"day")),weeks=parseInt(dpersian.difference(date1,date2,"week")),mod=days%7;if(mod==0)days=weeks*5;else{var adj=0,aDay=date1.getDay(),bDay=date2.getDay();weeks=parseInt(days/7),mod=days%7;var dtMark=new IDate(date1);dtMark.setDate(dtMark.getDate()+weeks*7);var dayMark=dtMark.getDay();if(days>0)switch(!0){case aDay==5:adj=-1;break;case aDay==6:adj=0;break;case bDay==5:adj=-1;break;case bDay==6:adj=-2;break;case dayMark+mod>5:adj=-2}else if(days<0)switch(!0){case aDay==5:adj=0;break;case aDay==6:adj=1;break;case bDay==5:adj=2;break;case bDay==6:adj=1;break;case dayMark+mod<0:adj=2}days+=adj,days-=weeks*2}delta=days;break;case"year":delta=yearDiff;break;case"month":var startdate=date2.toGregorian()>date1.toGregorian()?date2:date1,enddate=date2.toGregorian()>date1.toGregorian()?date1:date2,month1=startdate.getMonth(),month2=enddate.getMonth();if(yearDiff==0)delta=startdate.getMonth()-enddate.getMonth();else{delta=12-month2,delta+=month1;var i=enddate.getFullYear()+1,e=startdate.getFullYear();for(i;i<e;i++)delta+=12}date2.toGregorian()<date1.toGregorian()&&(delta=-delta);break;case"week":delta=parseInt(dpersian.difference(date1,date2,"day")/7);break;case"day":delta/=24;case"hour":delta/=60;case"minute":delta/=60;case"second":delta/=1e3;case"millisecond":delta*=date2.toGregorian().getTime()-date1.toGregorian().getTime()}return Math.round(delta)},dpersian})