//>>built
define("dojox/charting/plot2d/Indicator","dojo/_base/lang,dojo/_base/array,dojo/_base/declare,./CartesianBase,./_PlotEvents,./common,../axis2d/common,dojox/gfx,dojox/lang/utils,dojox/gfx/fx".split(","),function(o,C,E,F,G,r,H,s,y,I){var J=function(c){var a=c.declaredClass,e;if(-1!=a.indexOf("svg"))try{return o.mixin({},c.rawNode.getBBox())}catch(b){}else{if(-1!=a.indexOf("vml")){var d=c.rawNode,g=d.style.display;d.style.display="inline";a=s.pt2px(parseFloat(d.currentStyle.width));e=s.pt2px(parseFloat(d.currentStyle.height));
a={x:0,y:0,width:a,height:e};v(c,a);d.style.display=g;return a}if(-1!=a.indexOf("silverlight"))return v(c,{width:c.rawNode.actualWidth,height:c.rawNode.actualHeight},0.75);if(c.getTextWidth)return a=c.getTextWidth(),d=c.getFont(),e=s.normalizedLength(d?d.size:s.defaultFont.size),a={width:a,height:e},v(c,a,0.75),a}return null},v=function(c,a,e){var b=a.width,d=a.height,c=c.getShape();switch(c.align){case "end":a.x=c.x-b;break;case "middle":a.x=c.x-b/2;break;default:a.x=c.x}a.y=c.y-d*(e||1);return a};
return E("dojox.charting.plot2d.Indicator",[F,G],{defaultParams:{vertical:!0,fixed:!0,precision:0,lines:!0,labels:"line",markers:!0},optionalParams:{lineStroke:{},outlineStroke:{},shadowStroke:{},lineFill:{},stroke:{},outline:{},shadow:{},fill:{},fillFunc:null,labelFunc:null,font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerSymbol:"",values:[],offset:{},start:!1,animate:!1},constructor:function(c,a){this.opt=o.clone(this.defaultParams);y.updateWithObject(this.opt,
a);if("number"==typeof a.values)a.values=[a.values];y.updateWithPattern(this.opt,a,this.optionalParams);this.animate=this.opt.animate},render:function(c,a){if(this.zoom)return this.performZoom(c,a);if(!this.isDirty())return this;this.cleanGroup(null,!0);if(!this.opt.values)return this;this._updateIndicator();return this},_updateIndicator:function(){var c=this.chart.theme,a=this._hAxis.name,e=this._vAxis.name,b=this._hAxis.getScaler().bounds,d=this._vAxis.getScaler().bounds,g={};g[a]=b.from;g[e]=d.from;
var o=this.toPage(g);g[a]=b.to;g[e]=d.to;var z=this.toPage(g),k=this.events(),b=C.map(this.opt.values,function(b,c){return this._renderIndicator(b,c,a,e,o,z,k,this.animate)},this),d=b.length;if("trend"==this.opt.labels){var g=this.opt.vertical,h=this._data[0][0],i=this._data[d-1][0]-h,h=this.opt.labelFunc?this.opt.labelFunc(-1,this.values,this._data,this.opt.fixed,this.opt.precision):r.getLabel(i,this.opt.fixed,this.opt.precision)+" ("+r.getLabel(100*i/h,!0,2)+"%)";this._renderText(this.getGroup(),
h,this.chart.theme,g?(b[0].x+b[d-1].x)/2:b[1].x,g?b[0].y:(b[1].y+b[d-1].y)/2,-1,this.opt.values,this._data)}if((c=void 0!=this.opt.lineFill?this.opt.lineFill:c.indicator.lineFill)&&1<d)g=Math.min(b[0].x1,b[d-1].x1),h=Math.min(b[0].y1,b[d-1].y1),this.getGroup().createRect({x:g,y:h,width:Math.max(b[0].x2,b[d-1].x2)-g,height:Math.max(b[0].y2,b[d-1].y2)-h}).setFill(c).moveToBack()},_renderIndicator:function(c,a,e,b,d,g,s,z){var k=this.chart.theme,h=this.chart.getCoords(),i=this.opt.vertical,p=this.getGroup().createGroup(),
v=this.chart.isRightToLeft?this.chart.isRightToLeft():!1,y=this.chart.axes.x.scaler.bounds.to+this.chart.axes.x.scaler.bounds.from,f={};f[e]=i?c:0;f[b]=i?0:c;if(v)f.x=y-f.x;var f=this.toPage(f),l=i?f.x>=d.x&&f.x<=g.x:f.y>=g.y&&f.y<=d.y,A=f.x-h.x,B=f.y-h.y,j=i?A:d.x-h.x,q=i?d.y-h.y:B,w=i?j:g.x-h.x,t=i?g.y-h.y:q;if(this.opt.lines&&l){var n=this.opt.hasOwnProperty("lineShadow")?this.opt.lineShadow:k.indicator.lineShadow,u=this.opt.hasOwnProperty("lineStroke")?this.opt.lineStroke:k.indicator.lineStroke,
m=this.opt.hasOwnProperty("lineOutline")?this.opt.lineOutline:k.indicator.lineOutline;n&&p.createLine({x1:j+n.dx,y1:q+n.dy,x2:w+n.dx,y2:t+n.dy}).setStroke(n);if(m)m=r.makeStroke(m),m.width=2*m.width+(u?u.width:0),p.createLine({x1:j,y1:q,x2:w,y2:t}).setStroke(m);p.createLine({x1:j,y1:q,x2:w,y2:t}).setStroke(u)}var D;if(this.opt.markers&&l){var x=this._data[a];x&&(D=C.map(x,function(a){f[e]=i?c:a;f[b]=i?a:c;if(v)f.x=y-f.x;f=this.toPage(f);if(i?f.y<=d.y&&f.y>=g.y:f.x>=d.x&&f.x<=g.x){A=f.x-h.x;B=f.y-
h.y;var j=this.opt.markerSymbol?this.opt.markerSymbol:k.indicator.markerSymbol,l="M"+A+" "+B+" "+j;n=void 0!=this.opt.markerShadow?this.opt.markerShadow:k.indicator.markerShadow;u=void 0!=this.opt.markerStroke?this.opt.markerStroke:k.indicator.markerStroke;m=void 0!=this.opt.markerOutline?this.opt.markerOutline:k.indicator.markerOutline;n&&p.createPath("M"+(A+n.dx)+" "+(B+n.dy)+" "+j).setFill(n.color).setStroke(n);if(m)m=r.makeStroke(m),m.width=2*m.width+(u?u.width:0),p.createPath(l).setStroke(m);
j=p.createPath(l);l=this._shapeFill(void 0!=this.opt.markerFill?this.opt.markerFill:k.indicator.markerFill,j.getBoundingBox());j.setFill(l).setStroke(u)}return a},this))}x=this.opt.start?{x:i?j:j,y:i?q:t}:{x:i?j:w,y:i?t:q};this.opt.labels&&"trend"!=this.opt.labels&&l&&(this.opt.labelFunc?l=this.opt.labelFunc(a,this.opt.values,this._data,this.opt.fixed,this.opt.precision,this.opt.labels):"markers"==this.opt.labels?(l=C.map(D,function(a){return r.getLabel(a,this.opt.fixed,this.opt.precision)},this),
l="[ "+l.join(", ")+" ]"):l=r.getLabel(c,this.opt.fixed,this.opt.precision),this._renderText(p,l,k,x.x,x.y,a,this.opt.values,this._data));s&&this._connectEvents({element:"indicator",run:this.run?this.run[a]:void 0,shape:p,value:c});z&&this._animateIndicator(p,i,i?q:j,i?q+t:j+w,z);return o.mixin(x,{x1:j,y1:q,x2:w,y2:t})},_animateIndicator:function(c,a,e,b,d){I.animateTransform(o.delegate({shape:c,duration:1200,transform:[{name:"translate",start:a?[0,e]:[e,0],end:[0,0]},{name:"scale",start:a?[1,1/b]:
[1/b,1],end:[1,1]},{name:"original"}]},d)).play()},clear:function(){this.inherited(arguments);this._data=[]},addSeries:function(c){this.inherited(arguments);this._data.push(c.data)},_renderText:function(c,a,e,b,d,g,o,s){this.opt.offset&&(b+=this.opt.offset.x,d+=this.opt.offset.y);a=H.createText.gfx(this.chart,c,b,d,"middle",a,this.opt.font?this.opt.font:e.indicator.font,this.opt.fontColor?this.opt.fontColor:e.indicator.fontColor);b=J(a,a.getShape().text);b.x-=2;b.y-=1;b.width+=4;b.height+=2;b.r=this.opt.radius?
this.opt.radius:e.indicator.radius;var k=void 0!=this.opt.shadow?this.opt.shadow:e.indicator.shadow,d=void 0!=this.opt.stroke?this.opt.stroke:e.indicator.stroke,h=void 0!=this.opt.outline?this.opt.outline:e.indicator.outline;k&&c.createRect(b).setFill(k.color).setStroke(k);if(h)h=r.makeStroke(h),h.width=2*h.width+(d?d.width:0),c.createRect(b).setStroke(h);e=this.opt.fillFunc?this.opt.fillFunc(g,o,s):void 0!=this.opt.fill?this.opt.fill:e.indicator.fill;c.createRect(b).setFill(this._shapeFill(e,b)).setStroke(d);
a.moveToFront()},getSeriesStats:function(){return o.delegate(r.defaultStats)}})});