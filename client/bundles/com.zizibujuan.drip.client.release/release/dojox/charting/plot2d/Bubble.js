//>>built
define("dojox/charting/plot2d/Bubble","dojo/_base/lang,dojo/_base/declare,dojo/_base/array,./CartesianBase,./_PlotEvents,./common,dojox/lang/functional,dojox/lang/functional/reversed,dojox/lang/utils,dojox/gfx/fx".split(","),function(m,q,g,v,w,x,y,z,p,A){var B=z.lambda("item.purgeGroup()");return q("dojox.charting.plot2d.Bubble",[v,w],{defaultParams:{animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},styleFunc:null,font:"",fontColor:""},constructor:function(h,e){this.opt=m.clone(m.mixin(this.opt,
this.defaultParams));p.updateWithObject(this.opt,e);p.updateWithPattern(this.opt,e,this.optionalParams);if(!this.opt.labelFunc)this.opt.labelFunc=function(e,h,g){return this._getLabel(e.size,h,g)};this.animate=this.opt.animate},render:function(h,e){var i;if(this.zoom&&!this.isDataDirty())return this.performZoom(h,e);this.resetEvents();if(this.dirty=this.isDirty())g.forEach(this.series,B),this._eventSeries={},this.cleanGroup(),i=this.getGroup(),y.forEachRev(this.series,function(a){a.cleanGroup(i)});
for(var n=this.chart.theme,m=this._hScaler.scaler.getTransformerFromModel(this._hScaler),p=this._vScaler.scaler.getTransformerFromModel(this._vScaler),q=this.events(),r=this.series.length-1;0<=r;--r){var b=this.series[r];if(!this.dirty&&!b.dirty)n.skip(),this._reconnectEvents(b.name);else if(b.cleanGroup(),b.data.length){if("number"!=typeof b.data[0]){i=b.group;var o=n.next("circle",[this.opt,b]),j=g.map(b.data,function(a){return a?{x:m(a.x)+e.l,y:h.height-e.b-p(a.y),radius:this._vScaler.bounds.scale*
(a.size/2)}:null},this),f=null,k=null,l=null,t=this.opt.styleFunc,s=function(a){return t?n.addMixin(o,"circle",[a,t(a)],!0):n.addMixin(o,"circle",a,!0)};if(o.series.shadow&&(l=g.map(j,function(a,d){if(null!==a){var c=s(b.data[d]).series.shadow,c=i.createCircle({cx:a.x+c.dx,cy:a.y+c.dy,r:a.radius}).setStroke(c).setFill(c.color);this.animate&&this._animateBubble(c,h.height-e.b,a.radius);return c}return null},this),l.length))b.dyn.shadow=l[l.length-1].getStroke();if(o.series.outline&&(k=g.map(j,function(a,
d){if(null!==a){var c=s(b.data[d]),c=x.makeStroke(c.series.outline);c.width=2*c.width+o.series.stroke.width;c=i.createCircle({cx:a.x,cy:a.y,r:a.radius}).setStroke(c);this.animate&&this._animateBubble(c,h.height-e.b,a.radius);return c}return null},this),k.length))b.dyn.outline=k[k.length-1].getStroke();f=g.map(j,function(a,d){if(null!==a){var c=s(b.data[d]),g={x:a.x-a.radius,y:a.y-a.radius,width:2*a.radius,height:2*a.radius},f=this._plotFill(c.series.fill,h,e),f=this._shapeFill(f,g),f=i.createCircle({cx:a.x,
cy:a.y,r:a.radius}).setFill(f).setStroke(c.series.stroke);this.animate&&this._animateBubble(f,h.height-e.b,a.radius);this.createLabel(i,b.data[d],g,c);return f}return null},this);if(f.length)b.dyn.fill=f[f.length-1].getFill(),b.dyn.stroke=f[f.length-1].getStroke();if(q){var u=Array(f.length);g.forEach(f,function(a,d){if(null!==a){var c={element:"circle",index:d,run:b,shape:a,outline:k&&k[d]||null,shadow:l&&l[d]||null,x:b.data[d].x,y:b.data[d].y,r:b.data[d].size/2,cx:j[d].x,cy:j[d].y,cr:j[d].radius};
this._connectEvents(c);u[d]=c}},this);this._eventSeries[b.name]=u}else delete this._eventSeries[b.name];b.dirty=!1}}else b.dirty=!1,n.skip()}this.dirty=!1;this.chart.isRightToLeft&&this.chart.isRightToLeft()&&this.chart.applyMirroring(this.group,h,e);return this},_animateBubble:function(h,e,g){A.animateTransform(m.delegate({shape:h,duration:1200,transform:[{name:"translate",start:[0,e],end:[0,0]},{name:"scale",start:[0,1/g],end:[1,1]},{name:"original"}]},this.animate)).play()}})});