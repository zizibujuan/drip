//>>built
define("dojox/charting/action2d/TouchZoomAndPan","dojo/_base/lang,dojo/_base/declare,dojo/_base/event,dojo/sniff,./ChartAction,../Element,dojox/gesture/tap,../plot2d/common".split(","),function(j,g,h,i,k,l,m,n){var o=g(l,{constructor:function(){},render:function(){this.isDirty()&&(this.cleanGroup(),this.group.createRect({width:this.chart.dim.width,height:this.chart.dim.height}).setFill("rgba(0,0,0,0)"))},clear:function(){this.dirty=!0;this.chart.stack[0]!=this&&this.chart.movePlotToFront(this.name);
return this},getSeriesStats:function(){return j.delegate(n.defaultStats)},initializeScalers:function(){return this},isDirty:function(){return this.dirty}});return g("dojox.charting.action2d.TouchZoomAndPan",k,{defaultParams:{axis:"x",scaleFactor:1.2,maxScale:100,enableScroll:!0,enableZoom:!0},optionalParams:{},constructor:function(b,c,a){this._listeners=[{eventName:"ontouchstart",methodName:"onTouchStart"},{eventName:"ontouchmove",methodName:"onTouchMove"},{eventName:"ontouchend",methodName:"onTouchEnd"},
{eventName:m.doubletap,methodName:"onDoubleTap"}];a||(a={});this.axis=a.axis?a.axis:"x";this.scaleFactor=a.scaleFactor?a.scaleFactor:1.2;this.maxScale=a.maxScale?a.maxScale:100;this.enableScroll=void 0!=a.enableScroll?a.enableScroll:!0;this.enableZoom=void 0!=a.enableScroll?a.enableZoom:!0;this._uName="touchZoomPan"+this.axis;this.connect()},connect:function(){this.inherited(arguments);i("ios")&&-1!=this.chart.surface.declaredClass.indexOf("svg")&&this.chart.addPlot(this._uName,{type:o})},disconnect:function(){i("ios")&&
-1!=this.chart.surface.declaredClass.indexOf("svg")&&this.chart.removePlot(this._uName);this.inherited(arguments)},onTouchStart:function(b){var c=this.chart,a=c.getAxis(this.axis),e=b.touches.length;this._startPageCoord={x:b.touches[0].pageX,y:b.touches[0].pageY};(this.enableZoom||this.enableScroll)&&c._delayedRenderHandle&&c.render();this.enableZoom&&2<=e?(this._endPageCoord={x:b.touches[1].pageX,y:b.touches[1].pageY},b={x:(this._startPageCoord.x+this._endPageCoord.x)/2,y:(this._startPageCoord.y+
this._endPageCoord.y)/2},c=a.getScaler(),this._initScale=a.getWindowScale(),this._middleCoord=(this._initData=this.plot.toData())(b)[this.axis],this._startCoord=c.bounds.from,this._endCoord=c.bounds.to):this.enableScroll&&(this._startScroll(a),h.stop(b))},onTouchMove:function(b){var c=this.chart,a=c.getAxis(this.axis),e=b.touches.length,d=a.vertical?"pageY":"pageX",f=a.vertical?"y":"x";this.enableZoom&&2<=e?(a=(this._endPageCoord[f]-this._startPageCoord[f])/(b.touches[1][d]-b.touches[0][d]),this._initScale/
a>this.maxScale||(e=this._initData({x:(b.touches[1].pageX+b.touches[0].pageX)/2,y:(b.touches[1].pageY+b.touches[0].pageY)/2})[this.axis],c.zoomIn(this.axis,[a*(this._startCoord-e)+this._middleCoord,a*(this._endCoord-e)+this._middleCoord]),h.stop(b))):this.enableScroll&&(a=a.vertical?this._startPageCoord[f]-b.touches[0][d]:b.touches[0][d]-this._startPageCoord[f],this.chart.isRightToLeft&&this.chart.isRightToLeft()&&(a*=-1),c.setAxisWindow(this.axis,this._lastScale,this._initOffset-a/this._lastFactor/
this._lastScale),c.delayedRender(),h.stop(b))},onTouchEnd:function(b){var c=this.chart.getAxis(this.axis);if(1==b.touches.length&&this.enableScroll)this._startPageCoord={x:b.touches[0].pageX,y:b.touches[0].pageY},this._startScroll(c)},_startScroll:function(b){var c=b.getScaler().bounds;this._initOffset=b.getWindowOffset();this._lastScale=b.getWindowScale();this._lastFactor=c.span/(c.upper-c.lower)},onDoubleTap:function(b){var c=this.chart,a=c.getAxis(this.axis),e=1/this.scaleFactor;if(1==a.getWindowScale()){var d=
a.getScaler(),a=d.bounds.from,d=d.bounds.to,f=(a+d)/2,g=this.plot.toData(this._startPageCoord)[this.axis];c.zoomIn(this.axis,[e*(a-f)+g,e*(d-f)+g])}else c.setAxisWindow(this.axis,1,0),c.render();h.stop(b)}})});