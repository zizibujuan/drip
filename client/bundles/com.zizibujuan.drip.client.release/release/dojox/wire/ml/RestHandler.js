//>>built
define("dojox/wire/ml/RestHandler",["dojo","dijit","dojox","dojo/require!dojox/wire/_base,dojox/wire/ml/util"],function(dojo,dijit,dojox){dojo.provide("dojox.wire.ml.RestHandler"),dojo.require("dojox.wire._base"),dojo.require("dojox.wire.ml.util"),dojo.declare("dojox.wire.ml.RestHandler",null,{contentType:"text/plain",handleAs:"text",bind:function(method,parameters,deferred,url){method=method.toUpperCase();var self=this,args={url:this._getUrl(method,parameters,url),contentType:this.contentType,handleAs:this.handleAs,headers:this.headers,preventCache:this.preventCache},d=null;method=="POST"?(args.postData=this._getContent(method,parameters),d=dojo.rawXhrPost(args)):method=="PUT"?(args.putData=this._getContent(method,parameters),d=dojo.rawXhrPut(args)):method=="DELETE"?d=dojo.xhrDelete(args):d=dojo.xhrGet(args),d.addCallbacks(function(result){deferred.callback(self._getResult(result))},function(error){deferred.errback(error)})},_getUrl:function(method,parameters,url){var query;method=="GET"||method=="DELETE"?parameters.length>0&&(query=parameters[0]):parameters.length>1&&(query=parameters[1]);if(query){var queryString="";for(var name in query){var value=query[name];if(value){value=encodeURIComponent(value);var variable="{"+name+"}",index=url.indexOf(variable);index>=0?url=url.substring(0,index)+value+url.substring(index+variable.length):(queryString&&(queryString+="&"),queryString+=name+"="+value)}}queryString&&(url+="?"+queryString)}return url},_getContent:function(method,parameters){return method=="POST"||method=="PUT"?parameters?parameters[0]:null:null},_getResult:function(data){return data}})})