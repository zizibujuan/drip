//>>built
define("dojox/wire/Wire",["dojo","dijit","dojox","dojo/require!dojox/wire/_base"],function(dojo,dijit,dojox){dojo.provide("dojox.wire.Wire"),dojo.require("dojox.wire._base"),dojo.declare("dojox.wire.Wire",null,{_wireClass:"dojox.wire.Wire",constructor:function(args){dojo.mixin(this,args);if(this.converter)if(dojo.isString(this.converter)){var convertObject=dojo.getObject(this.converter);if(dojo.isFunction(convertObject))try{var testObj=new convertObject;testObj&&!dojo.isFunction(testObj.convert)?this.converter={convert:convertObject}:this.converter=testObj}catch(e){}else dojo.isObject(convertObject)&&dojo.isFunction(convertObject.convert)&&(this.converter=convertObject);if(dojo.isString(this.converter)){var converterClass=dojox.wire._getClass(this.converter);converterClass?this.converter=new converterClass:this.converter=undefined}}else dojo.isFunction(this.converter)&&(this.converter={convert:this.converter})},getValue:function(defaultObject){var object=undefined;dojox.wire.isWire(this.object)?object=this.object.getValue(defaultObject):object=this.object||defaultObject;if(this.property){var list=this.property.split(".");for(var i in list){if(!object)return object;object=this._getPropertyValue(object,list[i])}}var value=undefined;return this._getValue?value=this._getValue(object):value=object,value&&(this.type&&(this.type=="string"?value=value.toString():this.type=="number"?value=parseInt(value,10):this.type=="boolean"?value=value!="false":this.type=="array"&&(dojo.isArray(value)||(value=[value]))),this.converter&&this.converter.convert&&(value=this.converter.convert(value,this))),value},setValue:function(value,defaultObject){var object=undefined;dojox.wire.isWire(this.object)?object=this.object.getValue(defaultObject):object=this.object||defaultObject;var property=undefined,o;if(this.property){if(!object){if(!dojox.wire.isWire(this.object))throw new Error(this._wireClass+".setValue(): invalid object");object={},this.object.setValue(object,defaultObject)}var list=this.property.split("."),last=list.length-1;for(var i=0;i<last;i++){var p=list[i];o=this._getPropertyValue(object,p),o||(o={},this._setPropertyValue(object,p,o)),object=o}property=list[last]}if(this._setValue){property&&(o=this._getPropertyValue(object,property),o||(o={},this._setPropertyValue(object,property,o)),object=o);var newObject=this._setValue(object,value);if(!object&&newObject){if(!dojox.wire.isWire(this.object))throw new Error(this._wireClass+".setValue(): invalid object");this.object.setValue(newObject,defaultObject)}}else if(property)this._setPropertyValue(object,property,value);else{if(!dojox.wire.isWire(this.object))throw new Error(this._wireClass+".setValue(): invalid property");this.object.setValue(value,defaultObject)}},_getPropertyValue:function(object,property){var value=undefined,i1=property.indexOf("[");if(i1>=0){var i2=property.indexOf("]"),index=property.substring(i1+1,i2),array=null;i1===0?array=object:(property=property.substring(0,i1),array=this._getPropertyValue(object,property),array&&!dojo.isArray(array)&&(array=[array])),array&&(value=array[index])}else if(object.getPropertyValue)value=object.getPropertyValue(property);else{var getter="get"+property.charAt(0).toUpperCase()+property.substring(1);this._useGet(object)?value=object.get(property):this._useAttr(object)?value=object.attr(property):object[getter]?value=object[getter]():value=object[property]}return value},_setPropertyValue:function(object,property,value){var i1=property.indexOf("[");if(i1>=0){var i2=property.indexOf("]"),index=property.substring(i1+1,i2),array=null;i1===0?array=object:(property=property.substring(0,i1),array=this._getPropertyValue(object,property),array||(array=[],this._setPropertyValue(object,property,array))),array[index]=value}else if(object.setPropertyValue)object.setPropertyValue(property,value);else{var setter="set"+property.charAt(0).toUpperCase()+property.substring(1);this._useSet(object)?object.set(property,value):this._useAttr(object)?object.attr(property,value):object[setter]?object[setter](value):object[property]=value}},_useGet:function(object){var useGet=!1;return dojo.isFunction(object.get)&&(useGet=!0),useGet},_useSet:function(object){var useSet=!1;return dojo.isFunction(object.set)&&(useSet=!0),useSet},_useAttr:function(object){var useAttr=!1;return dojo.isFunction(object.attr)&&(useAttr=!0),useAttr}})})