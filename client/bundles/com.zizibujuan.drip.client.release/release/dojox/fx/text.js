//>>built
define("dojox/fx/text",["dojo/_base/lang","./_base","dojo/_base/fx","dojo/fx","dojo/fx/easing","dojo/dom","dojo/dom-style","dojo/_base/html","dojo/_base/connect"],function(lang,dojoxFx,baseFx,coreFx,easingLib,dom,domStyle,htmlLib,connectUtil){var textFx=lang.getObject("dojox.fx.text",!0);return textFx._split=function(args){function animatePieces(piece){var next=piece.nextSibling;if(piece.tagName=="SPAN"&&piece.childNodes.length==1&&piece.firstChild.nodeType==3){var pieceCoords=htmlLib.coords(piece,!0);number++,domStyle.set(piece,{padding:0,margin:0,top:args.crop?"0px":pieceCoords.t+"px",left:args.crop?"0px":pieceCoords.l+"px",display:"inline"});var pieceAnimation=args.pieceAnimation(piece,pieceCoords,nodeCoords,number,numPieces);lang.isArray(pieceAnimation)?animations=animations.concat(pieceAnimation):animations[animations.length]=pieceAnimation}else piece.firstChild&&animatePieces(piece.firstChild);next&&animatePieces(next)}var node=args.node=dom.byId(args.node),s=node.style,cs=domStyle.getComputedStyle(node),nodeCoords=htmlLib.coords(node,!0);args.duration=args.duration||1e3,args.words=args.words||!1;var originalHTML=args.text&&typeof args.text=="string"?args.text:node.innerHTML,originalHeight=s.height,originalWidth=s.width,animations=[];domStyle.set(node,{height:cs.height,width:cs.width});var tagReg=/(<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>)/g,reg=args.words?/(<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>)\s*|([^\s<]+\s*)/g:/(<\/?\w+((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\/?>)\s*|([^\s<]\s*)/g,pieces=typeof args.text=="string"?args.text.match(reg):node.innerHTML.match(reg),html="",numPieces=0,number=0;for(var i=0;i<pieces.length;i++){var piece=pieces[i];piece.match(tagReg)?html+=piece:(html+="<span>"+piece+"</span>",numPieces++)}node.innerHTML=html,animatePieces(node.firstChild);var anim=coreFx.combine(animations);return connectUtil.connect(anim,"onEnd",anim,function(){node.innerHTML=originalHTML,domStyle.set(node,{height:originalHeight,width:originalWidth})}),args.onPlay&&connectUtil.connect(anim,"onPlay",anim,args.onPlay),args.onEnd&&connectUtil.connect(anim,"onEnd",anim,args.onEnd),anim},textFx.explode=function(args){var node=args.node=dom.byId(args.node),s=node.style;args.distance=args.distance||1,args.duration=args.duration||1e3,args.random=args.random||0,typeof args.fade=="undefined"&&(args.fade=!0),typeof args.sync=="undefined"&&(args.sync=!0),args.random=Math.abs(args.random),args.pieceAnimation=function(piece,pieceCoords,coords,number,numPieces){var pieceHeight=pieceCoords.h,pieceWidth=pieceCoords.w,distance=args.distance*2,duration=args.duration,startTop=parseFloat(piece.style.top),startLeft=parseFloat(piece.style.left),delay=0,randomX=0,randomY=0;if(args.random){var seed=Math.random()*args.random+Math.max(1-args.random,0);distance*=seed,duration*=seed,delay=args.unhide&&args.sync||!args.unhide&&!args.sync?args.duration-duration:0,randomX=Math.random()-.5,randomY=Math.random()-.5}var distanceY=(coords.h-pieceHeight)/2-(pieceCoords.y-coords.y),distanceX=(coords.w-pieceWidth)/2-(pieceCoords.x-coords.x),distanceXY=Math.sqrt(Math.pow(distanceX,2)+Math.pow(distanceY,2)),endTop=startTop-distanceY*distance+distanceXY*randomY,endLeft=startLeft-distanceX*distance+distanceXY*randomX,pieceSlide=baseFx.animateProperty({node:piece,duration:duration,delay:delay,easing:args.easing||(args.unhide?easingLib.sinOut:easingLib.circOut),beforeBegin:args.unhide?function(){args.fade&&domStyle.set(piece,"opacity",0),piece.style.position=args.crop?"relative":"absolute",piece.style.top=endTop+"px",piece.style.left=endLeft+"px"}:function(){piece.style.position=args.crop?"relative":"absolute"},properties:{top:args.unhide?{start:endTop,end:startTop}:{start:startTop,end:endTop},left:args.unhide?{start:endLeft,end:startLeft}:{start:startLeft,end:endLeft}}});if(args.fade){var pieceFade=baseFx.animateProperty({node:piece,duration:duration,delay:delay,easing:args.fadeEasing||easingLib.quadOut,properties:{opacity:args.unhide?{start:0,end:1}:{end:0}}});return args.unhide?[pieceFade,pieceSlide]:[pieceSlide,pieceFade]}return pieceSlide};var anim=textFx._split(args);return anim},textFx.converge=function(args){return args.unhide=!0,textFx.explode(args)},textFx.disintegrate=function(args){var node=args.node=dom.byId(args.node),s=node.style;args.duration=args.duration||1500,args.distance=args.distance||1.5,args.random=args.random||0,args.fade||(args.fade=!0);var random=Math.abs(args.random);args.pieceAnimation=function(piece,pieceCoords,coords,number,numPieces){var pieceHeight=pieceCoords.h,pieceWidth=pieceCoords.w,interval=args.interval||args.duration/(1.5*numPieces),duration=args.duration-numPieces*interval,randomDelay=Math.random()*numPieces*interval,uniformDelay=args.reverseOrder||args.distance<0?number*interval:(numPieces-number)*interval,delay=randomDelay*random+Math.max(1-random,0)*uniformDelay,properties={};args.unhide?(properties.top={start:parseFloat(piece.style.top)-coords.h*args.distance,end:parseFloat(piece.style.top)},args.fade&&(properties.opacity={start:0,end:1})):(properties.top={end:parseFloat(piece.style.top)+coords.h*args.distance},args.fade&&(properties.opacity={end:0}));var pieceAnimation=baseFx.animateProperty({node:piece,duration:duration,delay:delay,easing:args.easing||(args.unhide?easingLib.sinIn:easingLib.circIn),properties:properties,beforeBegin:args.unhide?function(){args.fade&&domStyle.set(piece,"opacity",0),piece.style.position=args.crop?"relative":"absolute",piece.style.top=properties.top.start+"px"}:function(){piece.style.position=args.crop?"relative":"absolute"}});return pieceAnimation};var anim=textFx._split(args);return anim},textFx.build=function(args){return args.unhide=!0,textFx.disintegrate(args)},textFx.blockFadeOut=function(args){var node=args.node=dom.byId(args.node),s=node.style;args.duration=args.duration||1e3,args.random=args.random||0;var random=Math.abs(args.random);args.pieceAnimation=function(piece,pieceCoords,coords,number,numPieces){var interval=args.interval||args.duration/(1.5*numPieces),duration=args.duration-numPieces*interval,randomDelay=Math.random()*numPieces*interval,uniformDelay=args.reverseOrder?(numPieces-number)*interval:number*interval,delay=randomDelay*random+Math.max(1-random,0)*uniformDelay,pieceAnimation=baseFx.animateProperty({node:piece,duration:duration,delay:delay,easing:args.easing||easingLib.sinInOut,properties:{opacity:args.unhide?{start:0,end:1}:{end:0}},beforeBegin:args.unhide?function(){domStyle.set(piece,"opacity",0)}:undefined});return pieceAnimation};var anim=textFx._split(args);return anim},textFx.blockFadeIn=function(args){return args.unhide=!0,textFx.blockFadeOut(args)},textFx.backspace=function(args){var node=args.node=dom.byId(args.node),s=node.style;args.words=!1,args.duration=args.duration||2e3,args.random=args.random||0;var random=Math.abs(args.random),delay=10;args.pieceAnimation=function(piece,pieceCoords,coords,number,numPieces){var interval=args.interval||args.duration/(1.5*numPieces),text="textContent"in piece?piece.textContent:piece.innerText,whitespace=text.match(/\s/g);typeof args.wordDelay=="undefined"&&(args.wordDelay=interval*2),args.unhide||(delay=(numPieces-number-1)*interval);var beforeBegin,onEnd;if(args.fixed){if(args.unhide)var beforeBegin=function(){domStyle.set(piece,"opacity",0)}}else if(args.unhide)var beforeBegin=function(){piece.style.display="none"},onEnd=function(){piece.style.display="inline"};else var onEnd=function(){piece.style.display="none"};var pieceAnimation=baseFx.animateProperty({node:piece,duration:1,delay:delay,easing:args.easing||easingLib.sinInOut,properties:{opacity:args.unhide?{start:0,end:1}:{end:0}},beforeBegin:beforeBegin,onEnd:onEnd});if(args.unhide){var randomDelay=Math.random()*text.length*interval,wordDelay=randomDelay*random/2+Math.max(1-random/2,0)*args.wordDelay;delay+=randomDelay*random+Math.max(1-random,0)*interval*text.length+wordDelay*(whitespace&&text.lastIndexOf(whitespace[whitespace.length-1])==text.length-1)}return pieceAnimation};var anim=textFx._split(args);return anim},textFx.type=function(args){return args.unhide=!0,textFx.backspace(args)},textFx})