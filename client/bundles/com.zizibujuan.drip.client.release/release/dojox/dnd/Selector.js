//>>built
define("dojox/dnd/Selector",["dojo","dojox","dojo/dnd/Selector"],function(dojo,dojox){return dojo.declare("dojox.dnd.Selector",dojo.dnd.Selector,{conservative:!0,isSelected:function(node){var id=dojo.isString(node)?node:node.id,item=this.getItem(id);return item&&this.selected[id]},selectNode:function(node,add){add||this.selectNone();var id=dojo.isString(node)?node:node.id,item=this.getItem(id);return item&&(this._removeAnchor(),this.anchor=dojo.byId(node),this._addItemClass(this.anchor,"Anchor"),this.selection[id]=1,this._addItemClass(this.anchor,"Selected")),this},deselectNode:function(node){var id=dojo.isString(node)?node:node.id,item=this.getItem(id);return item&&this.selection[id]&&(this.anchor===dojo.byId(node)&&this._removeAnchor(),delete this.selection[id],this._removeItemClass(this.anchor,"Selected")),this},selectByBBox:function(left,top,right,bottom,add){return add||this.selectNone(),this.forInItems(function(data,id){var node=dojo.byId(id);node&&this._isBoundedByBox(node,left,top,right,bottom)&&this.selectNode(id,!0)},this),this},_isBoundedByBox:function(node,left,top,right,bottom){return this.conservative?this._conservativeBBLogic(node,left,top,right,bottom):this._liberalBBLogic(node,left,top,right,bottom)},shift:function(toNext,add){var selectedNodes=this.getSelectedNodes();selectedNodes&&selectedNodes.length&&this.selectNode(this._getNodeId(selectedNodes[selectedNodes.length-1].id,toNext),add)},_getNodeId:function(nodeId,toNext){var allNodes=this.getAllNodes(),newId=nodeId;for(var i=0,l=allNodes.length;i<l;++i)if(allNodes[i].id==nodeId){var j=Math.min(l-1,Math.max(0,i+(toNext?1:-1)));i!=j&&(newId=allNodes[j].id);break}return newId},_conservativeBBLogic:function(node,left,top,right,bottom){var c=dojo.coords(node),t;return left>right&&(t=left,left=right,right=t),top>bottom&&(t=top,top=bottom,bottom=t),c.x>=left&&c.x+c.w<=right&&c.y>=top&&c.y+c.h<=bottom},_liberalBBLogic:function(node,left,top,right,bottom){var c=dojo.position(node),xBounded,yBounded,tlx,tly,brx,bry,leftGreater=!1,bottomGreater=!1,nodeTlx=c.x,nodeTly=c.y,nodeBrx=c.x+c.w,nodeBry=c.y+c.h;return left<right?(tlx=left,tly=top):(leftGreater=!0,tlx=right,tly=bottom),top<bottom?(bottomGreater=!0,brx=right,bry=bottom):(brx=left,bry=top,tlx=right,tly=bottom),leftGreater&&bottomGreater&&(brx=left,bry=bottom,tlx=right,tly=top),xBounded=(nodeTlx>=tlx||nodeBrx<=brx)&&tlx<=nodeBrx&&brx>=nodeTlx||nodeTlx<=tlx&&nodeBrx>=brx,yBounded=tly<=nodeBry&&bry>=nodeTly||nodeBry>=bry&&nodeTly<=bry,xBounded&&yBounded}})})