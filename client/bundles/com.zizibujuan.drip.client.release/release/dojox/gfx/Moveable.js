//>>built
define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/has","dojo/dom-class","dojo/_base/window","./Mover"],function(lang,declare,arr,event,topic,has,domClass,win,Mover){return declare("dojox.gfx.Moveable",null,{constructor:function(shape,params){this.shape=shape,this.delay=params&&params.delay>0?params.delay:0,this.mover=params&&params.mover?params.mover:Mover,this.events=[this.shape.connect(has("touch")?"touchstart":"mousedown",this,"onMouseDown")]},destroy:function(){arr.forEach(this.events,this.shape.disconnect,this.shape),this.events=this.shape=null},onMouseDown:function(e){this.delay?(this.events.push(this.shape.connect(has("touch")?"touchmove":"mousemove",this,"onMouseMove"),this.shape.connect(has("touch")?"touchend":"mouseup",this,"onMouseUp")),this._lastX=has("touch")?(e.changedTouches?e.changedTouches[0]:e).clientX:e.clientX,this._lastY=has("touch")?(e.changedTouches?e.changedTouches[0]:e).clientY:e.clientY):new this.mover(this.shape,e,this),event.stop(e)},onMouseMove:function(e){var clientX=has("touch")?(e.changedTouches?e.changedTouches[0]:e).clientX:e.clientX,clientY=has("touch")?(e.changedTouches?e.changedTouches[0]:e).clientY:e.clientY;if(Math.abs(clientX-this._lastX)>this.delay||Math.abs(clientY-this._lastY)>this.delay)this.onMouseUp(e),new this.mover(this.shape,e,this);event.stop(e)},onMouseUp:function(e){this.shape.disconnect(this.events.pop())},onMoveStart:function(mover){topic.publish("/gfx/move/start",mover),domClass.add(win.body(),"dojoMove")},onMoveStop:function(mover){topic.publish("/gfx/move/stop",mover),domClass.remove(win.body(),"dojoMove")},onFirstMove:function(mover){},onMove:function(mover,shift){this.onMoving(mover,shift),this.shape.applyLeftTransform(shift),this.onMoved(mover,shift)},onMoving:function(mover,shift){},onMoved:function(mover,shift){}})})