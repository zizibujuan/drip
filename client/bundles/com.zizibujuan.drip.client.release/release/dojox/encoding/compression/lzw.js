//>>built
define("dojox/encoding/compression/lzw",["dojo/_base/lang","../bits"],function(lang,bits){var lzw=lang.getObject("dojox.encoding.compression.lzw",!0),_bits=function(x){var w=1;for(var v=2;x>=v;v<<=1,++w);return w};return lzw.Encoder=function(n){this.size=n,this.init()},lang.extend(lzw.Encoder,{init:function(){this.dict={};for(var i=0;i<this.size;++i)this.dict[String.fromCharCode(i)]=i;this.width=_bits(this.code=this.size),this.p=""},encode:function(value,stream){var c=String.fromCharCode(value),p=this.p+c,r=0;return p in this.dict?(this.p=p,r):(stream.putBits(this.dict[this.p],this.width),(this.code&this.code+1)==0&&stream.putBits(this.code++,r=this.width++),this.dict[p]=this.code++,this.p=c,r+this.width)},flush:function(stream){return this.p.length==0?0:(stream.putBits(this.dict[this.p],this.width),this.p="",this.width)}}),lzw.Decoder=function(n){this.size=n,this.init()},lang.extend(lzw.Decoder,{init:function(){this.codes=new Array(this.size);for(var i=0;i<this.size;++i)this.codes[i]=String.fromCharCode(i);this.width=_bits(this.size),this.p=-1},decode:function(stream){var c=stream.getBits(this.width),v;if(c<this.codes.length)v=this.codes[c],this.p>=0&&this.codes.push(this.codes[this.p]+v.substr(0,1));else{if((c&c+1)==0)return this.codes.push(""),++this.width,"";var x=this.codes[this.p];v=x+x.substr(0,1),this.codes.push(v)}return this.p=c,v}}),lzw})