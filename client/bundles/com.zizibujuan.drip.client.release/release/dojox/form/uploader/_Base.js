//>>built
define("dojox/form/uploader/_Base",["dojo/dom-form","dojo/dom-style","dojo/dom-construct","dojo/dom-attr","dojo/has","dojo/_base/declare","dojo/_base/event","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(domForm,domStyle,domConstruct,domAttr,has,declare,event,Widget,TemplatedMixin,WidgetsInTemplateMixin){return has.add("FormData",function(){return!!window.FormData}),has.add("xhr-sendAsBinary",function(){var xhr=window.XMLHttpRequest&&new window.XMLHttpRequest;return xhr&&!!xhr.sendAsBinary}),has.add("file-multiple",function(){return!!{"true":1,"false":1}[domAttr.get(document.createElement("input",{type:"file"}),"multiple")]}),declare("dojox.form.uploader._Base",[Widget,TemplatedMixin,WidgetsInTemplateMixin],{getForm:function(){if(!this.form){var n=this.domNode;while(n&&n.tagName&&n!==document.body){if(n.tagName.toLowerCase()=="form"){this.form=n;break}n=n.parentNode}}return this.form},getUrl:function(){return this.uploadUrl&&(this.url=this.uploadUrl),this.url?this.url:(this.getForm()&&(this.url=this.form.action),this.url)},connectForm:function(){this.url=this.getUrl(),!this._fcon&&!!this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(evt){0,event.stop(evt),this.submit(this.form)}))},supports:function(what){switch(what){case"multiple":if(this.force=="flash"||this.force=="iframe")return!1;return has("file-multiple");case"FormData":return has(what);case"sendAsBinary":return has("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(name){return name.substring(name.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(bytes){var kb=Math.round(bytes/1024*1e5)/1e5,mb=Math.round(bytes/1048576*1e5)/1e5,gb=Math.round(bytes/1073741824*1e5)/1e5,value=bytes;return kb>1&&(value=kb.toFixed(1)+" kb"),mb>1&&(value=mb.toFixed(1)+" mb"),gb>1&&(value=gb.toFixed(1)+" gb"),{kb:kb,mb:mb,gb:gb,bytes:bytes,value:value}}})})