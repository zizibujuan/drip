//>>built
define("dojox/xml/DomParser",["dojo/_base/kernel","dojo/_base/array"],function(dojo){return dojo.getObject("xml",!0,dojox),dojox.xml.DomParser=new function(){function _doc(){return new function(){var all={};this.nodeType=nodeTypes.DOCUMENT,this.nodeName="#document",this.namespaces={},this._nsPaths={},this.childNodes=[],this.documentElement=null,this._add=function(obj){typeof obj.id!="undefined"&&(all[obj.id]=obj)},this._remove=function(id){all[id]&&delete all[id]},this.byId=this.getElementById=function(id){return all[id]},this.byName=this.getElementsByTagName=byName,this.byNameNS=this.getElementsByTagNameNS=byNameNS,this.childrenByName=childrenByName,this.childrenByNameNS=childrenByNameNS}}function byName(name){function __(node,name,arr){dojo.forEach(node.childNodes,function(c){c.nodeType==nodeTypes.ELEMENT&&(name=="*"?arr.push(c):c.nodeName==name&&arr.push(c),__(c,name,arr))})}var a=[];return __(this,name,a),a}function byNameNS(name,ns){function __(node,name,ns,arr){dojo.forEach(node.childNodes,function(c){c.nodeType==nodeTypes.ELEMENT&&(name=="*"&&c.ownerDocument._nsPaths[ns]==c.namespace?arr.push(c):c.localName==name&&c.ownerDocument._nsPaths[ns]==c.namespace&&arr.push(c),__(c,name,ns,arr))})}ns||(ns=dNs);var a=[];return __(this,name,ns,a),a}function childrenByName(name){var a=[];return dojo.forEach(this.childNodes,function(c){c.nodeType==nodeTypes.ELEMENT&&(name=="*"?a.push(c):c.nodeName==name&&a.push(c))}),a}function childrenByNameNS(name,ns){var a=[];return dojo.forEach(this.childNodes,function(c){c.nodeType==nodeTypes.ELEMENT&&(name=="*"&&c.ownerDocument._nsPaths[ns]==c.namespace?a.push(c):c.localName==name&&c.ownerDocument._nsPaths[ns]==c.namespace&&a.push(c))}),a}function _createTextNode(v){return{nodeType:nodeTypes.TEXT,nodeName:"#text",nodeValue:v.replace(normalize," ").replace(egt,">").replace(elt,"<").replace(eapos,"'").replace(equot,'"').replace(eamp,"&")}}function getAttr(name){for(var i=0;i<this.attributes.length;i++)if(this.attributes[i].nodeName==name)return this.attributes[i].nodeValue;return null}function getAttrNS(name,ns){for(var i=0;i<this.attributes.length;i++)if(this.ownerDocument._nsPaths[ns]==this.attributes[i].namespace&&this.attributes[i].localName==name)return this.attributes[i].nodeValue;return null}function setAttr(name,val){var old=null;for(var i=0;i<this.attributes.length;i++)if(this.attributes[i].nodeName==name){old=this.attributes[i].nodeValue,this.attributes[i].nodeValue=val;break}name=="id"&&(old!=null&&this.ownerDocument._remove(old),this.ownerDocument._add(this))}function setAttrNS(name,val,ns){for(var i=0;i<this.attributes.length;i++)if(this.ownerDocument._nsPaths[ns]==this.attributes[i].namespace&&this.attributes[i].localName==name){this.attributes[i].nodeValue=val;return}}function prev(){var p=this.parentNode;if(p)for(var i=0;i<p.childNodes.length;i++)if(p.childNodes[i]==this&&i>0)return p.childNodes[i-1];return null}function next(){var p=this.parentNode;if(p)for(var i=0;i<p.childNodes.length;i++)if(p.childNodes[i]==this&&i+1<p.childNodes.length)return p.childNodes[i+1];return null}var nodeTypes={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9},reTags=/<([^>\/\s+]*)([^>]*)>([^<]*)/g,reAttr=/([^=]*)=(("([^"]*)")|('([^']*)'))/g,reEntity=/<!ENTITY\s+([^"]*)\s+"([^"]*)">/g,reCData=/<!\[CDATA\[([\u0001-\uFFFF]*?)\]\]>/g,reComments=/<!--([\u0001-\uFFFF]*?)-->/g,trim=/^\s+|\s+$/g,normalize=/\s+/g,egt=/\&gt;/g,elt=/\&lt;/g,equot=/\&quot;/g,eapos=/\&apos;/g,eamp=/\&amp;/g,dNs="_def_";this.parse=function(str){var root=_doc();if(str==null)return root;if(str.length==0)return root;if(str.indexOf("<!ENTITY")>0){var entity,eRe=[];if(reEntity.test(str)){reEntity.lastIndex=0;while((entity=reEntity.exec(str))!=null)eRe.push({entity:"&"+entity[1].replace(trim,"")+";",expression:entity[2]});for(var i=0;i<eRe.length;i++)str=str.replace(new RegExp(eRe[i].entity,"g"),eRe[i].expression)}}var cdSections=[],cdata;while((cdata=reCData.exec(str))!=null)cdSections.push(cdata[1]);for(var i=0;i<cdSections.length;i++)str=str.replace(cdSections[i],i);var comments=[],comment;while((comment=reComments.exec(str))!=null)comments.push(comment[1]);for(i=0;i<comments.length;i++)str=str.replace(comments[i],i);var res,obj=root;while((res=reTags.exec(str))!=null)if(res[2].charAt(0)=="/"&&res[2].replace(trim,"").length>1){obj.parentNode&&(obj=obj.parentNode);var text=(res[3]||"").replace(trim,"");text.length>0&&obj.childNodes.push(_createTextNode(text))}else if(res[1].length>0)if(res[1].charAt(0)=="?"){var name=res[1].substr(1),target=res[2].substr(0,res[2].length-2);obj.childNodes.push({nodeType:nodeTypes.PROCESSING_INSTRUCTION,nodeName:name,nodeValue:target})}else if(res[1].charAt(0)=="!"){if(res[1].indexOf("![CDATA[")==0){var val=parseInt(res[1].replace("![CDATA[","").replace("]]",""));obj.childNodes.push({nodeType:nodeTypes.CDATA_SECTION,nodeName:"#cdata-section",nodeValue:cdSections[val]})}else if(res[1].substr(0,3)=="!--"){var val=parseInt(res[1].replace("!--","").replace("--",""));obj.childNodes.push({nodeType:nodeTypes.COMMENT,nodeName:"#comment",nodeValue:comments[val]})}}else{var name=res[1].replace(trim,""),o={nodeType:nodeTypes.ELEMENT,nodeName:name,localName:name,namespace:dNs,ownerDocument:root,attributes:[],parentNode:null,childNodes:[]};if(name.indexOf(":")>-1){var t=name.split(":");o.namespace=t[0],o.localName=t[1]}o.byName=o.getElementsByTagName=byName,o.byNameNS=o.getElementsByTagNameNS=byNameNS,o.childrenByName=childrenByName,o.childrenByNameNS=childrenByNameNS,o.getAttribute=getAttr,o.getAttributeNS=getAttrNS,o.setAttribute=setAttr,o.setAttributeNS=setAttrNS,o.previous=o.previousSibling=prev,o.next=o.nextSibling=next;var attr;while((attr=reAttr.exec(res[2]))!=null)if(attr.length>0){var name=attr[1].replace(trim,""),val=(attr[4]||attr[6]||"").replace(normalize," ").replace(egt,">").replace(elt,"<").replace(eapos,"'").replace(equot,'"').replace(eamp,"&");if(name.indexOf("xmlns")==0)if(name.indexOf(":")>0){var ns=name.split(":");root.namespaces[ns[1]]=val,root._nsPaths[val]=ns[1]}else root.namespaces[dNs]=val,root._nsPaths[val]=dNs;else{var ln=name,ns=dNs;if(name.indexOf(":")>0){var t=name.split(":");ln=t[1],ns=t[0]}o.attributes.push({nodeType:nodeTypes.ATTRIBUTE,nodeName:name,localName:ln,namespace:ns,nodeValue:val}),ln=="id"&&(o.id=val)}}root._add(o),obj&&(obj.childNodes.push(o),o.parentNode=obj,res[2].charAt(res[2].length-1)!="/"&&(obj=o));var text=res[3];text.length>0&&obj.childNodes.push(_createTextNode(text))}for(var i=0;i<root.childNodes.length;i++){var e=root.childNodes[i];if(e.nodeType==nodeTypes.ELEMENT){root.documentElement=e;break}}return root}},dojox.xml.DomParser})