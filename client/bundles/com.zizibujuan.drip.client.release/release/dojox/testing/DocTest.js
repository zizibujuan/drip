//>>built
define("dojox/testing/DocTest",["dojo/string"],function(){dojo.declare("dojox.testing.DocTest",null,{errors:[],getTests:function(a){a=dojo.moduleUrl(a).path;a=a.substring(0,a.length-1)+".js";dojo.xhrGet({url:a,handleAs:"text"});return this._getTestsFromString(dojo._getText(a),!0)},getTestsFromString:function(a){return this._getTestsFromString(a,!1)},_getTestsFromString:function(a,c){for(var d=dojo.hitch(dojo.string,"trim"),g=a.split("\n"),h=g.length,i=[],e=[],f=[],j=null,k=0;k<h+1;k++){var b=d(g[k]||
"");c&&b.match(/^\/\/\s+>>>\s.*/)||b.match(/^\s*>>>\s.*/)?(j||(j=k+1),0<f.length&&(i.push({commands:e,expectedResult:f.join("\n"),line:j}),e=[],f=[],j=k+1),b=c?d(b).substring(2,b.length):b,b=d(b).substring(3,b.length),e.push(d(b))):(!c||b.match(/^\/\/\s+.*/))&&e.length&&0==f.length?(b=c?d(b).substring(3,b.length):b,f.push(d(b))):0<e.length&&f.length&&((!c||b.match(/^\/\/\s*$/))&&i.push({commands:e,expectedResult:f.join("\n"),line:j}),c&&!b.match(/^\/\//)&&i.push({commands:e,expectedResult:f.join("\n"),
line:j}),e=[],f=[],j=0)}return i},run:function(a){this.errors=[];(a=this.getTests(a))&&this._run(a)},_run:function(a){var c=a.length;this.tests=c;for(var d=0,g=0;g<c;g++){var h=a[g],i=this.runTest(h.commands,h.expectedResult),e=h.commands.join(" ");50<e.length&&e.substr(0,50);i.success?d+=1:this.errors.push({commands:h.commands,actual:i.actualResult,expected:h.expectedResult})}},runTest:function(a,c){var d={success:!1,actualResult:null},g=a.join("\n");d.actualResult=eval(g);if(""+d.actualResult==
c||dojo.toJson(d.actualResult)==c||'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&""+d.actualResult==c.substring(1,c.length-1))d.success=!0;return d}});return dojox.testing.DocTest});