//>>built
define("dojox/mobile/common",["dojo/_base/array","dojo/_base/config","dojo/_base/connect","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-construct","dojo/ready","dijit/registry","./sniff","./uacss"],function(array,config,connect,lang,win,domClass,domConstruct,ready,registry,has){var dm=lang.getObject("dojox.mobile",!0);dm.getScreenSize=function(){return{h:win.global.innerHeight||win.doc.documentElement.clientHeight,w:win.global.innerWidth||win.doc.documentElement.clientWidth}},dm.updateOrient=function(){var dim=dm.getScreenSize();domClass.replace(win.doc.documentElement,dim.h>dim.w?"dj_portrait":"dj_landscape",dim.h>dim.w?"dj_landscape":"dj_portrait")},dm.updateOrient(),dm.tabletSize=500,dm.detectScreenSize=function(force){var dim=dm.getScreenSize(),sz=Math.min(dim.w,dim.h),from,to;sz>=dm.tabletSize&&(force||!this._sz||this._sz<dm.tabletSize)?(from="phone",to="tablet"):sz<dm.tabletSize&&(force||!this._sz||this._sz>=dm.tabletSize)&&(from="tablet",to="phone"),to&&(domClass.replace(win.doc.documentElement,"dj_"+to,"dj_"+from),connect.publish("/dojox/mobile/screenSize/"+to,[dim])),this._sz=sz},dm.detectScreenSize(),dm.hideAddressBarWait=typeof config.mblHideAddressBarWait=="number"?config.mblHideAddressBarWait:1500,dm.hide_1=function(){scrollTo(0,1),dm._hidingTimer=dm._hidingTimer==0?200:dm._hidingTimer*2,setTimeout(function(){dm.isAddressBarHidden()||dm._hidingTimer>dm.hideAddressBarWait?(dm.resizeAll(),dm._hiding=!1):setTimeout(dm.hide_1,dm._hidingTimer)},50)},dm.hideAddressBar=function(evt){if(dm.disableHideAddressBar||dm._hiding)return;dm._hiding=!0,dm._hidingTimer=has("iphone")?200:0;var minH=screen.availHeight;has("android")&&(minH=outerHeight/devicePixelRatio,minH==0&&(dm._hiding=!1,setTimeout(function(){dm.hideAddressBar()},200)),minH<=innerHeight&&(minH=outerHeight),has("android")<3&&(win.doc.documentElement.style.overflow=win.body().style.overflow="visible")),win.body().offsetHeight<minH&&(win.body().style.minHeight=minH+"px",dm._resetMinHeight=!0),setTimeout(dm.hide_1,dm._hidingTimer)},dm.isAddressBarHidden=function(){return pageYOffset===1},dm.resizeAll=function(evt,root){if(dm.disableResizeAll)return;connect.publish("/dojox/mobile/resizeAll",[evt,root]),connect.publish("/dojox/mobile/beforeResizeAll",[evt,root]),dm._resetMinHeight&&(win.body().style.minHeight=dm.getScreenSize().h+"px"),dm.updateOrient(),dm.detectScreenSize();var isTopLevel=function(w){var parent=w.getParent&&w.getParent();return(!parent||!parent.resize)&&!!w.resize},resizeRecursively=function(w){array.forEach(w.getChildren(),function(child){isTopLevel(child)&&child.resize(),resizeRecursively(child)})};root?(root.resize&&root.resize(),resizeRecursively(root)):array.forEach(array.filter(registry.toArray(),isTopLevel),function(w){w.resize()}),connect.publish("/dojox/mobile/afterResizeAll",[evt,root])},dm.openWindow=function(url,target){win.global.open(url,target||"_blank")},config.mblApplyPageStyles!==!1&&domClass.add(win.doc.documentElement,"mobile"),has("chrome")&&domClass.add(win.doc.documentElement,"dj_chrome");if(win.global._no_dojo_dm){var _dm=win.global._no_dojo_dm;for(var i in _dm)dm[i]=_dm[i];dm.deviceTheme.setDm(dm)}return has.add("mblAndroidWorkaround",config.mblAndroidWorkaround!==!1&&has("android")<3,undefined,!0),has.add("mblAndroid3Workaround",config.mblAndroid3Workaround!==!1&&has("android")>=3,undefined,!0),ready(function(){dm.detectScreenSize(!0),config.mblAndroidWorkaroundButtonStyle!==!1&&has("android")&&domConstruct.create("style",{innerHTML:"BUTTON,INPUT[type='button'],INPUT[type='submit'],INPUT[type='reset'],INPUT[type='file']::-webkit-file-upload-button{-webkit-appearance:none;}"},win.doc.head,"first"),has("mblAndroidWorkaround")&&domConstruct.create("style",{innerHTML:".mblView.mblAndroidWorkaround{position:absolute;top:-9999px !important;left:-9999px !important;}"},win.doc.head,"last");var f=dm.resizeAll;if(config.mblHideAddressBar!==!1&&navigator.appVersion.indexOf("Mobile")!=-1||config.mblForceHideAddressBar===!0)dm.hideAddressBar(),config.mblAlwaysHideAddressBar===!0&&(f=dm.hideAddressBar);var ios6=has("iphone")>=6;if((has("android")||ios6)&&win.global.onorientationchange!==undefined){var _f=f,curSize,curClientWidth,curClientHeight;ios6?(curClientWidth=win.doc.documentElement.clientWidth,curClientHeight=win.doc.documentElement.clientHeight):(f=function(evt){var _conn=connect.connect(null,"onresize",null,function(e){connect.disconnect(_conn),_f(e)})},curSize=dm.getScreenSize()),connect.connect(null,"onresize",null,function(e){if(ios6){var newClientWidth=win.doc.documentElement.clientWidth,newClientHeight=win.doc.documentElement.clientHeight;newClientWidth==curClientWidth&&newClientHeight!=curClientHeight&&_f(e),curClientWidth=newClientWidth,curClientHeight=newClientHeight}else{var newSize=dm.getScreenSize();newSize.w==curSize.w&&Math.abs(newSize.h-curSize.h)>=100&&_f(e),curSize=newSize}})}connect.connect(null,win.global.onorientationchange!==undefined?"onorientationchange":"onresize",null,f),win.body().style.visibility="visible"}),dm})