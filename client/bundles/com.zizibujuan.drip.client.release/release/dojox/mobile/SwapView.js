//>>built
define("dojox/mobile/SwapView",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/dom","dojo/dom-class","dijit/registry","./View","./_ScrollableMixin","./sniff","./_css3"],function(array,connect,declare,dom,domClass,registry,View,ScrollableMixin,has,css3){return declare("dojox.mobile.SwapView",[View,ScrollableMixin],{scrollDir:"f",weight:1.2,buildRendering:function(){this.inherited(arguments),domClass.add(this.domNode,"mblSwapView"),this.setSelectable(this.domNode,!1),this.containerNode=this.domNode,this.subscribe("/dojox/mobile/nextPage","handleNextPage"),this.subscribe("/dojox/mobile/prevPage","handlePrevPage"),this.noResize=!0},startup:function(){if(this._started)return;this.inherited(arguments)},resize:function(){this.inherited(arguments),array.forEach(this.getChildren(),function(child){child.resize&&child.resize()})},onTouchStart:function(e){var fromTop=this.domNode.offsetTop,nextView=this.nextView(this.domNode);nextView&&(nextView.stopAnimation(),domClass.add(nextView.domNode,"mblIn"),nextView.containerNode.style.paddingTop=fromTop+"px");var prevView=this.previousView(this.domNode);prevView&&(prevView.stopAnimation(),domClass.add(prevView.domNode,"mblIn"),prevView.containerNode.style.paddingTop=fromTop+"px"),this.inherited(arguments)},handleNextPage:function(w){var refNode=w.refId&&dom.byId(w.refId)||w.domNode;if(this.domNode.parentNode!==refNode.parentNode)return;if(this.getShowingView()!==this)return;this.goTo(1)},handlePrevPage:function(w){var refNode=w.refId&&dom.byId(w.refId)||w.domNode;if(this.domNode.parentNode!==refNode.parentNode)return;if(this.getShowingView()!==this)return;this.goTo(-1)},goTo:function(dir,moveTo){var view=moveTo?registry.byId(moveTo):dir==1?this.nextView(this.domNode):this.previousView(this.domNode);view&&view!==this&&(this.stopAnimation(),view.stopAnimation(),this.domNode._isShowing=!1,view.domNode._isShowing=!0,this.performTransition(view.id,dir,"slide",null,function(){connect.publish("/dojox/mobile/viewChanged",[view])}))},isSwapView:function(node){return node&&node.nodeType===1&&domClass.contains(node,"mblSwapView")},nextView:function(node){for(var n=node.nextSibling;n;n=n.nextSibling)if(this.isSwapView(n))return registry.byNode(n);return null},previousView:function(node){for(var n=node.previousSibling;n;n=n.previousSibling)if(this.isSwapView(n))return registry.byNode(n);return null},scrollTo:function(to){if(!this._beingFlipped){var newView,x;to.x<0?(newView=this.nextView(this.domNode),x=to.x+this.domNode.offsetWidth):(newView=this.previousView(this.domNode),x=to.x-this.domNode.offsetWidth),newView&&(newView.domNode.style.display==="none"&&(newView.domNode.style.display="",newView.resize()),newView._beingFlipped=!0,newView.scrollTo({x:x}),newView._beingFlipped=!1)}this.inherited(arguments)},findDisp:function(node){if(!domClass.contains(node,"mblSwapView"))return this.inherited(arguments);if(!node.parentNode)return null;var nodes=node.parentNode.childNodes;for(var i=0;i<nodes.length;i++){var n=nodes[i];if(n.nodeType===1&&domClass.contains(n,"mblSwapView")&&!domClass.contains(n,"mblIn")&&n.style.display!=="none")return n}return node},slideTo:function(to,duration,easing,fake_pos){if(!this._beingFlipped){var w=this.domNode.offsetWidth,pos=fake_pos||this.getPos(),newView,newX;pos.x<0?(newView=this.nextView(this.domNode),pos.x<-w/4?newView&&(to.x=-w,newX=0):newView&&(newX=w)):(newView=this.previousView(this.domNode),pos.x>w/4?newView&&(to.x=w,newX=0):newView&&(newX=-w)),newView&&(newView._beingFlipped=!0,newView.slideTo({x:newX},duration,easing),newView._beingFlipped=!1,newView.domNode._isShowing=newView&&newX===0),this.domNode._isShowing=!newView||newX!==0}this.inherited(arguments)},onAnimationEnd:function(e){if(e&&e.target&&domClass.contains(e.target,"mblScrollableScrollTo2"))return;this.inherited(arguments)},onFlickAnimationEnd:function(e){if(e&&e.target&&!domClass.contains(e.target,"mblScrollableScrollTo2"))return;this.inherited(arguments),this.domNode._isShowing?(array.forEach(this.domNode.parentNode.childNodes,function(c){this.isSwapView(c)&&(domClass.remove(c,"mblIn"),c._isShowing||(c.style.display="none",c.style[css3.name("transform")]="",c.style.left="0px"))},this),connect.publish("/dojox/mobile/viewChanged",[this]),this.containerNode.style.paddingTop=""):has("css3-animations")||(this.containerNode.style.left="0px")}})})