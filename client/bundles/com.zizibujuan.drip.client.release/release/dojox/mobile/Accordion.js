//>>built
define("dojox/mobile/Accordion",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/sniff","dojo/dom","dojo/dom-class","dojo/dom-construct","dijit/_Contained","dijit/_Container","dijit/_WidgetBase","./iconUtils","./lazyLoadUtils","./_css3","require","dojo/has!dojo-bidi?dojox/mobile/bidi/Accordion"],function(array,declare,lang,has,dom,domClass,domConstruct,Contained,Container,WidgetBase,iconUtils,lazyLoadUtils,css3,require,BidiAccordion){var _AccordionTitle=declare([WidgetBase,Contained],{label:"Label",icon1:"",icon2:"",iconPos1:"",iconPos2:"",selected:!1,baseClass:"mblAccordionTitle",buildRendering:function(){this.inherited(arguments);var a=this.anchorNode=domConstruct.create("a",{className:"mblAccordionTitleAnchor"},this.domNode);a.href="javascript:void(0)",this.textBoxNode=domConstruct.create("div",{className:"mblAccordionTitleTextBox"},a),this.labelNode=domConstruct.create("span",{className:"mblAccordionTitleLabel",innerHTML:this._cv?this._cv(this.label):this.label},this.textBoxNode),this._isOnLine=this.inheritParams()},postCreate:function(){this._clickHandle=this.connect(this.domNode,"onclick","_onClick"),dom.setSelectable(this.domNode,!1)},inheritParams:function(){var parent=this.getParent();return parent&&(this.icon1&&parent.iconBase&&parent.iconBase.charAt(parent.iconBase.length-1)==="/"&&(this.icon1=parent.iconBase+this.icon1),this.icon1||(this.icon1=parent.iconBase),this.iconPos1||(this.iconPos1=parent.iconPos),this.icon2&&parent.iconBase&&parent.iconBase.charAt(parent.iconBase.length-1)==="/"&&(this.icon2=parent.iconBase+this.icon2),this.icon2||(this.icon2=parent.iconBase||this.icon1),this.iconPos2||(this.iconPos2=parent.iconPos||this.iconPos1)),!!parent},_setIcon:function(icon,n){if(!this.getParent())return;this._set("icon"+n,icon),this["iconParentNode"+n]||(this["iconParentNode"+n]=domConstruct.create("div",{className:"mblAccordionIconParent mblAccordionIconParent"+n},this.anchorNode,"first")),this["iconNode"+n]=iconUtils.setIcon(icon,this["iconPos"+n],this["iconNode"+n],this.alt,this["iconParentNode"+n]),this["icon"+n]=icon,domClass.toggle(this.domNode,"mblAccordionHasIcon",icon&&icon!=="none")},_setIcon1Attr:function(icon){this._setIcon(icon,1)},_setIcon2Attr:function(icon){this._setIcon(icon,2)},startup:function(){if(this._started)return;this._isOnLine||this.inheritParams(),this._isOnLine||this.set({icon1:this.icon1,icon2:this.icon2}),this.inherited(arguments)},_onClick:function(e){if(this.onClick(e)===!1)return;var p=this.getParent();!p.fixedHeight&&this.contentWidget.domNode.style.display!=="none"?p.collapse(this.contentWidget,!p.animation):p.expand(this.contentWidget,!p.animation)},onClick:function(){},_setSelectedAttr:function(selected){domClass.toggle(this.domNode,"mblAccordionTitleSelected",selected),this._set("selected",selected)}}),Accordion=declare(has("dojo-bidi")?"dojox.mobile.NonBidiAccordion":"dojox.mobile.Accordion",[WidgetBase,Container,Contained],{iconBase:"",iconPos:"",fixedHeight:!1,singleOpen:!1,animation:!0,roundRect:!1,duration:.3,baseClass:"mblAccordion",_openSpace:1,startup:function(){if(this._started)return;domClass.contains(this.domNode,"mblAccordionRoundRect")?this.roundRect=!0:this.roundRect&&domClass.add(this.domNode,"mblAccordionRoundRect"),this.fixedHeight&&(this.singleOpen=!0);var children=this.getChildren();array.forEach(children,this._setupChild,this);var sel;array.forEach(children,function(child){child.startup(),child._at.startup(),this.collapse(child,!0),child.selected&&(sel=child)},this),!sel&&this.fixedHeight&&(sel=children[children.length-1]),sel?this.expand(sel,!0):this._updateLast(),setTimeout(lang.hitch(this,function(){this.resize()}),0),this._started=!0},_setupChild:function(child){child.domNode.style.overflow!="hidden"&&(child.domNode.style.overflow=this.fixedHeight?"auto":"hidden"),child._at=new _AccordionTitle({label:child.label,alt:child.alt,icon1:child.icon1,icon2:child.icon2,iconPos1:child.iconPos1,iconPos2:child.iconPos2,contentWidget:child}),domConstruct.place(child._at.domNode,child.domNode,"before"),domClass.add(child.domNode,"mblAccordionPane")},addChild:function(widget,insertIndex){this.inherited(arguments),this._started&&(this._setupChild(widget),widget._at.startup(),widget.selected?(this.expand(widget,!0),setTimeout(function(){widget.domNode.style.height=""},0)):this.collapse(widget))},removeChild:function(widget){typeof widget=="number"&&(widget=this.getChildren()[widget]),widget&&widget._at.destroy(),this.inherited(arguments)},getChildren:function(){return array.filter(this.inherited(arguments),function(child){return!(child instanceof _AccordionTitle)})},getSelectedPanes:function(){return array.filter(this.getChildren(),function(pane){return pane.domNode.style.display!="none"})},resize:function(){if(this.fixedHeight){var panes=array.filter(this.getChildren(),function(child){return child._at.domNode.style.display!="none"}),openSpace=this.domNode.clientHeight;array.forEach(panes,function(child){openSpace-=child._at.domNode.offsetHeight}),this._openSpace=openSpace>0?openSpace:0;var sel=this.getSelectedPanes()[0];sel.domNode.style[css3.name("transition")]="",sel.domNode.style.height=this._openSpace+"px"}},_updateLast:function(){var children=this.getChildren();array.forEach(children,function(c,i){domClass.toggle(c._at.domNode,"mblAccordionTitleLast",i===children.length-1&&!domClass.contains(c._at.domNode,"mblAccordionTitleSelected"))},this)},expand:function(pane,noAnimation){pane.lazy&&(lazyLoadUtils.instantiateLazyWidgets(pane.containerNode,pane.requires),pane.lazy=!1);var children=this.getChildren();array.forEach(children,function(c,i){c.domNode.style[css3.name("transition")]=noAnimation?"":"height "+this.duration+"s linear";if(c===pane){c.domNode.style.display="";var h;this.fixedHeight?h=this._openSpace:(h=parseInt(c.height||c.domNode.getAttribute("height")),h||(c.domNode.style.height="",h=c.domNode.offsetHeight,c.domNode.style.height="0px")),setTimeout(function(){c.domNode.style.height=h+"px"},0),this.select(pane)}else this.singleOpen&&this.collapse(c,noAnimation)},this),this._updateLast()},collapse:function(pane,noAnimation){if(pane.domNode.style.display==="none")return;pane.domNode.style[css3.name("transition")]=noAnimation?"":"height "+this.duration+"s linear",pane.domNode.style.height="0px";if(!has("css3-animations")||noAnimation)pane.domNode.style.display="none",this._updateLast();else{var _this=this;setTimeout(function(){pane.domNode.style.display="none",_this._updateLast();if(!_this.fixedHeight&&_this.singleOpen)for(var v=_this.getParent();v;v=v.getParent())if(domClass.contains(v.domNode,"mblView")){v&&v.resize&&v.resize();break}},this.duration*1e3)}this.deselect(pane)},select:function(pane){pane._at.set("selected",!0)},deselect:function(pane){pane._at.set("selected",!1)}});return Accordion.ChildWidgetProperties={alt:"",label:"",icon1:"",icon2:"",iconPos1:"",iconPos2:"",selected:!1,lazy:!1},lang.extend(WidgetBase,Accordion.ChildWidgetProperties),has("dojo-bidi")?declare("dojox.mobile.Accordion",[Accordion,BidiAccordion]):Accordion})