//>>built
define("dojox/app/controllers/History",["dojo/_base/lang","dojo/_base/declare","dojo/on","../Controller","../utils/hash"],function(c,e,g,f,d){return e("dojox.app.controllers.History",f,{constructor:function(a){this.events={"app-domNode":this.onDomNodeChange};if(this.app.domNode)this.onDomNodeChange({oldNode:null,newNode:this.app.domNode});this.bind(window,"popstate",c.hitch(this,this.onPopState))},onDomNodeChange:function(a){null!=a.oldNode&&this.unbind(a.oldNode,"startTransition");this.bind(a.newNode,
"startTransition",c.hitch(this,this.onStartTransition))},onStartTransition:function(a){var b=a.detail.url||"#"+a.detail.target;a.detail.params&&(b=d.buildWithParams(b,a.detail.params));history.pushState(a.detail,a.detail.href,b)},onPopState:function(a){if(this.app.getStatus()===this.app.lifecycle.STARTED){var b=a.state;b||(b=window.location.hash?{target:d.getTarget(location.hash),url:location.hash,params:d.getParams(location.hash)}:{target:this.app.defaultView});a._sim&&history.replaceState(b,b.title,
b.href);this.app.emit("app-transition",{viewId:b.target,opts:c.mixin({reverse:!0},a.detail,{params:b.params})})}}})});
//@ sourceMappingURL=History.js.map