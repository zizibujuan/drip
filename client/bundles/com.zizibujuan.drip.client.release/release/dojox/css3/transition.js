//>>built
define("dojox/css3/transition",["dojo/_base/lang","dojo/_base/array","dojo/Deferred","dojo/when","dojo/promise/all","dojo/on","dojo/sniff"],function(lang,array,Deferred,when,all,on,has){var transitionEndEventName="transitionend",transitionPrefix="t",translateMethodStart="translate3d(",translateMethodEnd=",0,0)";has("webkit")?(transitionPrefix="WebkitT",transitionEndEventName="webkitTransitionEnd"):has("mozilla")&&(transitionPrefix="MozT",translateMethodStart="translateX(",translateMethodEnd=")");var transition=function(args){var defaultConfig={startState:{},endState:{},node:null,duration:250,"in":!0,direction:1,autoClear:!0};lang.mixin(this,defaultConfig),lang.mixin(this,args),this.deferred||(this.deferred=new Deferred)};lang.extend(transition,{play:function(){transition.groupedPlay([this])},_applyState:function(state){var style=this.node.style;for(var property in state)state.hasOwnProperty(property)&&(style[property]=state[property])},initState:function(){this.node.style[transitionPrefix+"ransitionProperty"]="none",this.node.style[transitionPrefix+"ransitionDuration"]="0ms",this._applyState(this.startState)},_beforeStart:function(){this.node.style.display==="none"&&(this.node.style.display=""),this.beforeStart()},_beforeClear:function(){this.node.style[transitionPrefix+"ransitionProperty"]=null,this.node.style[transitionPrefix+"ransitionDuration"]=null,this["in"]!==!0&&(this.node.style.display="none"),this.beforeClear()},_onAfterEnd:function(){this.deferred.resolve(this.node),this.node.id&&transition.playing[this.node.id]===this.deferred&&delete transition.playing[this.node.id],this.onAfterEnd()},beforeStart:function(){},beforeClear:function(){},onAfterEnd:function(){},start:function(){this._beforeStart(),this._startTime=(new Date).getTime(),this._cleared=!1;var self=this;self.node.style[transitionPrefix+"ransitionProperty"]="all",self.node.style[transitionPrefix+"ransitionDuration"]=self.duration+"ms",on.once(self.node,transitionEndEventName,function(){self.clear()}),this._applyState(this.endState)},clear:function(){if(this._cleared)return;this._cleared=!0,this._beforeClear(),this._removeState(this.endState),this._onAfterEnd()},_removeState:function(state){var style=this.node.style;for(var property in state)state.hasOwnProperty(property)&&(style[property]=null)}}),transition.slide=function(node,config){var ret=new transition(config);ret.node=node;var startX="0",endX="0";return ret["in"]?ret.direction===1?startX="100%":startX="-100%":ret.direction===1?endX="-100%":endX="100%",ret.startState[transitionPrefix+"ransform"]=translateMethodStart+startX+translateMethodEnd,ret.endState[transitionPrefix+"ransform"]=translateMethodStart+endX+translateMethodEnd,ret},transition.fade=function(node,config){var ret=new transition(config);ret.node=node;var startOpacity="0",endOpacity="0";return ret["in"]?endOpacity="1":startOpacity="1",lang.mixin(ret,{startState:{opacity:startOpacity},endState:{opacity:endOpacity}}),ret},transition.flip=function(node,config){var ret=new transition(config);return ret.node=node,ret["in"]?(lang.mixin(ret,{startState:{opacity:"0"},endState:{opacity:"1"}}),ret.startState[transitionPrefix+"ransform"]="scale(0,0.8) skew(0,-30deg)",ret.endState[transitionPrefix+"ransform"]="scale(1,1) skew(0,0)"):(lang.mixin(ret,{startState:{opacity:"1"},endState:{opacity:"0"}}),ret.startState[transitionPrefix+"ransform"]="scale(1,1) skew(0,0)",ret.endState[transitionPrefix+"ransform"]="scale(0,0.8) skew(0,30deg)"),ret};var getWaitingList=function(nodes){var defs=[];return array.forEach(nodes,function(node){node.id&&transition.playing[node.id]&&defs.push(transition.playing[node.id])}),all(defs)};return transition.getWaitingList=getWaitingList,transition.groupedPlay=function(args){var animNodes=array.filter(args,function(item){return item.node}),waitingList=getWaitingList(animNodes);array.forEach(args,function(item){item.node.id&&(transition.playing[item.node.id]=item.deferred)}),when(waitingList,function(){array.forEach(args,function(item){item.initState()}),setTimeout(function(){array.forEach(args,function(item){item.start()}),on.once(args[args.length-1].node,transitionEndEventName,function(){var timeout;for(var i=0;i<args.length-1;i++)args[i].deferred.fired!==0&&(timeout=(new Date).getTime()-args[i]._startTime,timeout>=args[i].duration&&args[i].clear())})},33)})},transition.chainedPlay=function(args){var animNodes=array.filter(args,function(item){return item.node}),waitingList=getWaitingList(animNodes);array.forEach(args,function(item){item.node.id&&(transition.playing[item.node.id]=item.deferred)}),when(waitingList,function(){array.forEach(args,function(item){item.initState()});for(var i=1,len=args.length;i<len;i++)args[i-1].deferred.then(lang.hitch(args[i],function(){this.start()}));setTimeout(function(){args[0].start()},33)})},transition.playing={},transition})