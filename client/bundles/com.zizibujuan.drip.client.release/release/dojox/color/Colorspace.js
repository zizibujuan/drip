//>>built
define("dojox/color/Colorspace",["./_base","dojo/_base/lang","dojox/math/matrix"],function(dcolor,lang,dxm){return dcolor.Colorspace=new function(){var self=this,wpMap={2:{E:{x:1/3,y:1/3,t:5400},D50:{x:.34567,y:.3585,t:5e3},D55:{x:.33242,y:.34743,t:5500},D65:{x:.31271,y:.32902,t:6500},D75:{x:.29902,y:.31485,t:7500},A:{x:.44757,y:.40745,t:2856},B:{x:.34842,y:.35161,t:4874},C:{x:.31006,y:.31616,t:6774},9300:{x:.2848,y:.2932,t:9300},F2:{x:.37207,y:.37512,t:4200},F7:{x:.31285,y:.32918,t:6500},F11:{x:.38054,y:.37691,t:4e3}},10:{E:{x:1/3,y:1/3,t:5400},D50:{x:.34773,y:.35952,t:5e3},D55:{x:.33411,y:.34877,t:5500},D65:{x:.31382,y:.331,t:6500},D75:{x:.29968,y:.3174,t:7500},A:{x:.45117,y:.40594,t:2856},B:{x:.3498,y:.3527,t:4874},C:{x:.31039,y:.31905,t:6774},F2:{x:.37928,y:.36723,t:4200},F7:{x:.31565,y:.32951,t:6500},F11:{x:.38543,y:.3711,t:4e3}}},profiles={"Adobe RGB 98":[2.2,"D65",.64,.33,.297361,.21,.71,.627355,.15,.06,.075285],"Apple RGB":[1.8,"D65",.625,.34,.244634,.28,.595,.672034,.155,.07,.083332],"Best RGB":[2.2,"D50",.7347,.2653,.228457,.215,.775,.737352,.13,.035,.034191],"Beta RGB":[2.2,"D50",.6888,.3112,.303273,.1986,.7551,.663786,.1265,.0352,.032941],"Bruce RGB":[2.2,"D65",.64,.33,.240995,.28,.65,.683554,.15,.06,.075452],"CIE RGB":[2.2,"E",.735,.265,.176204,.274,.717,.812985,.167,.009,.010811],"ColorMatch RGB":[1.8,"D50",.63,.34,.274884,.295,.605,.658132,.15,.075,.066985],"DON RGB 4":[2.2,"D50",.696,.3,.27835,.215,.765,.68797,.13,.035,.03368],"ECI RGB":[1.8,"D50",.67,.33,.32025,.21,.71,.602071,.14,.08,.077679],"EktaSpace PS5":[2.2,"D50",.695,.305,.260629,.26,.7,.734946,.11,.005,.004425],"NTSC RGB":[2.2,"C",.67,.33,.298839,.21,.71,.586811,.14,.08,.11435],"PAL/SECAM RGB":[2.2,"D65",.64,.33,.222021,.29,.6,.706645,.15,.06,.071334],"Pro Photo RGB":[1.8,"D50",.7347,.2653,.28804,.1596,.8404,.711874,.0366,1e-4,86e-6],"SMPTE/C RGB":[2.2,"D65",.63,.34,.212395,.31,.595,.701049,.155,.07,.086556],sRGB:[2.2,"D65",.64,.33,.212656,.3,.6,.715158,.15,.06,.072186],"Wide Gamut RGB":[2.2,"D50",.735,.265,.258187,.115,.826,.724938,.157,.018,.016875]},adaptors={"XYZ scaling":{ma:[[1,0,0],[0,1,0],[0,0,1]],mai:[[1,0,0],[0,1,0],[0,0,1]]},Bradford:{ma:[[.8951,-0.7502,.0389],[.2664,1.7135,-0.0685],[-0.1614,.0367,1.0296]],mai:[[.986993,.432305,-0.008529],[-0.147054,.51836,.040043],[.159963,.049291,.968487]]},"Von Kries":{ma:[[.40024,-0.2263,0],[.7076,1.16532,0],[-0.08081,.0457,.91822]],mai:[[1.859936,.361191,0],[-1.129382,.638812,0],[.219897,-0.000006,1.089064]]}},cMaps={XYZ:{xyY:function(xyz,kwArgs){kwArgs=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},kwArgs||{});var wp=self.whitepoint(kwArgs.whitepoint,kwArgs.observer),sum=xyz.X+xyz.Y+xyz.Z;if(sum==0)var x=wp.x,y=wp.y;else var x=xyz.X/sum,y=xyz.Y/sum;return{x:x,y:y,Y:xyz.Y}},Lab:function(xyz,kwArgs){kwArgs=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},kwArgs||{});var kappa=self.kappa(kwArgs.useApproximation),epsilon=self.epsilon(kwArgs.useApproximation),wp=self.whitepoint(kwArgs.whitepoint,kwArgs.observer),xr=xyz.X/wp.x,yr=xyz.Y/wp.y,zr=xyz.z/wp.z,fx=xr>epsilon?Math.pow(xr,1/3):(kappa*xr+16)/116,fy=yr>epsilon?Math.pow(yr,1/3):(kappa*yr+16)/116,fz=zr>epsilon?Math.pow(zr,1/3):(kappa*zr+16)/116,L=116*fy-16,a=500*(fx-fy),b=200*(fy-fz);return{L:L,a:a,b:b}},Luv:function(xyz,kwArgs){kwArgs=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},kwArgs||{});var kappa=self.kappa(kwArgs.useApproximation),epsilon=self.epsilon(kwArgs.useApproximation),wp=self.whitepoint(kwArgs.whitepoint,kwArgs.observer),ud=4*xyz.X/(xyz.X+15*xyz.Y+3*xyz.Z),vd=9*xyz.Y/(xyz.X+15*xyz.Y+3*xyz.Z),udr=4*wp.x/(wp.x+15*wp.y+3*wp.z),vdr=9*wp.y/(wp.x+15*wp.y+3*wp.z),yr=xyz.Y/wp.y,L=yr>epsilon?116*Math.pow(yr,1/3)-16:kappa*yr,u=13*L*(ud-udr),v=13*L*(vd-vdr);return{L:L,u:u,v:v}}},xyY:{XYZ:function(xyY){if(xyY.y==0)var X=0,Y=0,Z=0;else var X=xyY.x*xyY.Y/xyY.y,Y=xyY.Y,Z=(1-xyY.x-xyY.y)*xyY.Y/xyY.y;return{X:X,Y:Y,Z:Z}}},Lab:{XYZ:function(lab,kwArgs){kwArgs=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},kwArgs||{});var b=kwArgs.useApproximation,kappa=self.kappa(b),epsilon=self.epsilon(b),wp=self.whitepoint(kwArgs.whitepoint,kwArgs.observer),yr=lab.L>kappa*epsilon?Math.pow((lab.L+16)/116,3):lab.L/kappa,fy=yr>epsilon?(lab.L+16)/116:(kappa*yr+16)/116,fx=lab.a/500+fy,fz=fy-lab.b/200,fxcube=Math.pow(fx,3),fzcube=Math.pow(fz,3),xr=fxcube>epsilon?fxcube:(116*fx-16)/kappa,zr=fzcube>epsilon?fzcube:(116*fz-16)/kappa;return{X:xr*wp.x,Y:yr*wp.y,Z:zr*wp.z}},LCHab:function(lab){var L=lab.L,C=Math.pow(lab.a*lab.a+lab.b*lab.b,.5),H=Math.atan(lab.b,lab.a)*(180/Math.PI);return H<0&&(H+=360),H<360&&(H-=360),{L:L,C:C,H:H}}},LCHab:{Lab:function(lch){var hRad=lch.H*(Math.PI/180),L=lch.L,a=lch.C/Math.pow(Math.pow(Math.tan(hRad),2)+1,.5);90<lchH&&lch.H<270&&(a=-a);var b=Math.pow(Math.pow(lch.C,2)-Math.pow(a,2),.5);return lch.H>180&&(b=-b),{L:L,a:a,b:b}}},Luv:{XYZ:function(Luv,kwArgs){kwArgs=dojo.mixin({whitepoint:"D65",observer:"10",useApproximation:!0},kwArgs||{});var b=kwArgs.useApproximation,kappa=self.kappa(b),epsilon=self.epsilon(b),wp=self.whitepoint(kwArgs.whitepoint,kwArgs.observer),uz=4*wp.x/(wp.x+15*wp.y+3*wp.z),vz=9*wp.y/(wp.x+15*wp.y+3*wp.z),Y=Luv.L>kappa*epsilon?Math.pow((Luv.L+16)/116,3):Luv.L/kappa,a=1/3*(52*Luv.L/(Luv.u+13*Luv.L*uz)-1),b=-5*Y,c=-0.3333333333333333,d=Y*(39*Luv.L/(Luv.v+13*Luv.L*vz)-5),X=(d-b)/(a-c),Z=X*a+b;return{X:X,Y:Y,Z:Z}},LCHuv:function(Luv){var L=Luv.L,C=Math.pow(Luv.u*Luv.u+Luv.v*Luv*v,.5),H=Math.atan(Luv.v,Luv.u)*(180/Math.PI);return H<0&&(H+=360),H>360&&(H-=360),{L:L,C:C,H:H}}},LCHuv:{Luv:function(LCH){var hRad=LCH.H*(Math.PI/180),L=LCH.L,u=LCH.C/Math.pow(Math.pow(Math.tan(hRad),2)+1,.5),v=Math.pow(LCH.C*LCH.C-u*u,.5);return 90<LCH.H&&LCH.H>270&&(u*=-1),LCH.H>180&&(v*=-1),{L:L,u:u,v:v}}}},converters={CMY:{CMYK:function(obj,kwArgs){return dcolor.fromCmy(obj).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromCmy(obj).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromCmy(obj).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(dcolor.fromCmy(obj).toXYZ(kwArgs))},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(converters.CMY.Lab(obj))},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.Luv.XYZ(dcolor.fromCmy(obj).toXYZ(kwArgs)))},Luv:function(obj,kwArgs){return cMaps.Luv.XYZ(dcolor.fromCmy(obj).toXYZ(kwArgs))},RGB:function(obj,kwArgs){return dcolor.fromCmy(obj)},XYZ:function(obj,kwArgs){return dcolor.fromCmy(obj).toXYZ(kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(dcolor.fromCmy(obj).toXYZ(kwArgs))}},CMYK:{CMY:function(obj,kwArgs){return dcolor.fromCmyk(obj).toCmy()},HSL:function(obj,kwArgs){return dcolor.fromCmyk(obj).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromCmyk(obj).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(dcolor.fromCmyk(obj).toXYZ(kwArgs))},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(converters.CMYK.Lab(obj))},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.Luv.XYZ(dcolor.fromCmyk(obj).toXYZ(kwArgs)))},Luv:function(obj,kwArgs){return cMaps.Luv.XYZ(dcolor.fromCmyk(obj).toXYZ(kwArgs))},RGB:function(obj,kwArgs){return dcolor.fromCmyk(obj)},XYZ:function(obj,kwArgs){return dcolor.fromCmyk(obj).toXYZ(kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(dcolor.fromCmyk(obj).toXYZ(kwArgs))}},HSL:{CMY:function(obj,kwArgs){return dcolor.fromHsl(obj).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromHsl(obj).toCmyk()},HSV:function(obj,kwArgs){return dcolor.fromHsl(obj).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(dcolor.fromHsl(obj).toXYZ(kwArgs))},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(converters.CMYK.Lab(obj))},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.Luv.XYZ(dcolor.fromHsl(obj).toXYZ(kwArgs)))},Luv:function(obj,kwArgs){return cMaps.Luv.XYZ(dcolor.fromHsl(obj).toXYZ(kwArgs))},RGB:function(obj,kwArgs){return dcolor.fromHsl(obj)},XYZ:function(obj,kwArgs){return dcolor.fromHsl(obj).toXYZ(kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(dcolor.fromHsl(obj).toXYZ(kwArgs))}},HSV:{CMY:function(obj,kwArgs){return dcolor.fromHsv(obj).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromHsv(obj).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromHsv(obj).toHsl()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(dcolor.fromHsv(obj).toXYZ(kwArgs))},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(converters.CMYK.Lab(obj))},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.Luv.XYZ(dcolor.fromHsv(obj).toXYZ(kwArgs)))},Luv:function(obj,kwArgs){return cMaps.Luv.XYZ(dcolor.fromHsv(obj).toXYZ(kwArgs))},RGB:function(obj,kwArgs){return dcolor.fromHsv(obj)},XYZ:function(obj,kwArgs){return dcolor.fromHsv(obj).toXYZ(kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(dcolor.fromHsv(obj).toXYZ(kwArgs))}},Lab:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(obj,kwArgs)).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(obj,kwArgs)).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(obj,kwArgs)).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(obj,kwArgs)).toHsv()},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(obj,kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.Luv.LCHuv(cMaps.Lab.XYZ(obj,kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.XYZ.Luv(cMaps.Lab.XYZ(obj,kwArgs),kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(obj,kwArgs))},XYZ:function(obj,kwArgs){return cMaps.Lab.XYZ(obj,kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(cMaps.Lab.XYZ(obj,kwArgs),kwArgs)}},LCHab:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs).toHsv()},Lab:function(obj,kwArgs){return cMaps.Lab.LCHab(obj,kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.Luv.LCHuv(cMaps.XYZ.Luv(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.XYZ.Luv(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs)},XYZ:function(obj,kwArgs){return cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj,kwArgs),kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(cMaps.Lab.XYZ(cMaps.LCHab.Lab(obj),kwArgs),kwArgs)}},LCHuv:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs)},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(cMaps.XYZ.Lab(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.LCHuv.Luv(obj,kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs)},XYZ:function(obj,kwArgs){return cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(cMaps.Luv.XYZ(cMaps.LCHuv.Luv(obj),kwArgs),kwArgs)}},Luv:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(obj,kwArgs),kwArgs).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(obj,kwArgs),kwArgs).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(obj,kwArgs),kwArgs).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(obj,kwArgs),kwArgs).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(cMaps.Luv.XYZ(obj,kwArgs),kwArgs)},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(cMaps.XYZ.Lab(cMaps.Luv.XYZ(obj,kwArgs),kwArgs),kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.Luv.LCHuv(obj,kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.Luv.XYZ(obj,kwArgs),kwArgs)},XYZ:function(obj,kwArgs){return cMaps.Luv.XYZ(obj,kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(cMaps.Luv.XYZ(obj,kwArgs),kwArgs)}},RGB:{CMY:function(obj,kwArgs){return obj.toCmy()},CMYK:function(obj,kwArgs){return obj.toCmyk()},HSL:function(obj,kwArgs){return obj.toHsl()},HSV:function(obj,kwArgs){return obj.toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(obj.toXYZ(kwArgs),kwArgs)},LCHab:function(obj,kwArgs){return cMaps.LCHab.Lab(cMaps.XYZ.Lab(obj.toXYZ(kwArgs),kwArgs),kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.XYZ.Luv(obj.toXYZ(kwArgs),kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.XYZ.Luv(obj.toXYZ(kwArgs),kwArgs)},XYZ:function(obj,kwArgs){return obj.toXYZ(kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(obj.toXYZ(kwArgs),kwArgs)}},XYZ:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(obj,kwArgs).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(obj,kwArgs).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(obj,kwArgs).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(obj,kwArgs).toHsv()},Lab:function(obj,kwArgs){return cMaps.XYZ.Lab(obj,kwArgs)},LCHab:function(obj,kwArgs){return cMaps.Lab.LCHab(cMaps.XYZ.Lab(obj,kwArgs),kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.Luv.LCHuv(cMaps.XYZ.Luv(obj,kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.XYZ.Luv(obj,kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(obj,kwArgs)},xyY:function(obj,kwArgs){return cMaps.XYZ.xyY(dcolor.fromXYZ(obj,kwArgs),kwArgs)}},xyY:{CMY:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs).toCmy()},CMYK:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs).toCmyk()},HSL:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs).toHsl()},HSV:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs).toHsv()},Lab:function(obj,kwArgs){return cMaps.Lab.XYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs)},LCHab:function(obj,kwArgs){return cMaps.LCHab.Lab(cMaps.Lab.XYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs),kwArgs)},LCHuv:function(obj,kwArgs){return cMaps.LCHuv.Luv(cMaps.Luv.XYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs),kwArgs)},Luv:function(obj,kwArgs){return cMaps.Luv.XYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs)},RGB:function(obj,kwArgs){return dcolor.fromXYZ(cMaps.xyY.XYZ(obj,kwArgs),kwArgs)},XYZ:function(obj,kwArgs){return cMaps.xyY.XYZ(obj,kwArgs)}}};this.whitepoint=function(wpName,observer){observer=observer||"10";var x=0,y=0,t=0;wpMap[observer]&&wpMap[observer][wpName]?(x=wpMap[observer][wpName].x,y=wpMap[observer][wpName].y,t=wpMap[observer][wpName].t):0;var wp={x:x,y:y,z:1-x-y,t:t,Y:1};return this.convert(wp,"xyY","XYZ")},this.tempToWhitepoint=function(t){if(t<4e3)return 0,{x:0,y:0};if(t>25e3)return 0,{x:0,y:0};var t1=t,t2=t*t,t3=t2*t,ten9=Math.pow(10,9),ten6=Math.pow(10,6),ten3=Math.pow(10,3);if(t<=7e3)var x=-4.607*ten9/t3+2.9678*ten6/t2+.09911*ten3/t+.2444063;else var x=-2.0064*ten9/t3+1.9018*ten6/t2+.24748*ten3/t+.23704;var y=-3*x*x+2.87*x-.275;return{x:x,y:y}},this.primaries=function(kwArgs){kwArgs=dojo.mixin({profile:"sRGB",whitepoint:"D65",observer:"10",adaptor:"Bradford"},kwArgs||{});var m=[];profiles[kwArgs.profile]?m=profiles[kwArgs.profile].slice(0):0;var primary={name:kwArgs.profile,gamma:m[0],whitepoint:m[1],xr:m[2],yr:m[3],Yr:m[4],xg:m[5],yg:m[6],Yg:m[7],xb:m[8],yb:m[9],Yb:m[10]};if(kwArgs.whitepoint!=primary.whitepoint){var r=this.convert(this.adapt({color:this.convert({x:xr,y:yr,Y:Yr},"xyY","XYZ"),adaptor:kwArgs.adaptor,source:primary.whitepoint,destination:kwArgs.whitepoint}),"XYZ","xyY"),g=this.convert(this.adapt({color:this.convert({x:xg,y:yg,Y:Yg},"xyY","XYZ"),adaptor:kwArgs.adaptor,source:primary.whitepoint,destination:kwArgs.whitepoint}),"XYZ","xyY"),b=this.convert(this.adapt({color:this.convert({x:xb,y:yb,Y:Yb},"xyY","XYZ"),adaptor:kwArgs.adaptor,source:primary.whitepoint,destination:kwArgs.whitepoint}),"XYZ","xyY");primary=dojo.mixin(primary,{xr:r.x,yr:r.y,Yr:r.Y,xg:g.x,yg:g.y,Yg:g.Y,xb:b.x,yb:b.y,Yb:b.Y,whitepoint:kwArgs.whitepoint})}return dojo.mixin(primary,{zr:1-primary.xr-primary.yr,zg:1-primary.xg-primary.yg,zb:1-primary.xb-primary.yb})},this.adapt=function(kwArgs){(!kwArgs.color||!kwArgs.source)&&0,kwArgs=dojo.mixin({adaptor:"Bradford",destination:"D65"},kwArgs);var swp=this.whitepoint(kwArgs.source),dwp=this.whitepoint(kwArgs.destination);if(adaptors[kwArgs.adaptor])var ma=adaptors[kwArgs.adaptor].ma,mai=adaptors[kwArgs.adaptor].mai;else 0;var dSrc=dxm.multiply([[swp.x,swp.y,swp.z]],ma),dDest=dxm.multiply([[dwp.x,dwp.y,dwp.z]],ma),center=[[dDest[0][0]/dSrc[0][0],0,0],[0,dDest[0][1]/dSrc[0][1],0],[0,0,dDest[0][2]/dSrc[0][2]]],m=dxm.multiply(dxm.multiply(ma,center),mai),r=dxm.multiply([[kwArgs.color.X,kwArgs.color.Y,kwArgs.color.Z]],m)[0];return{X:r[0],Y:r[1],Z:r[2]}},this.matrix=function(to,primary){var p=primary,wp=this.whitepoint(p.whitepoint),Xr=p.xr/p.yr,Yr=1,Zr=(1-p.xr-p.yr)/p.yr,Xg=p.xg/p.yg,Yg=1,Zg=(1-p.xg-p.yg)/p.yg,Xb=p.xb/p.yb,Yb=1,Zb=(1-p.xb-p.yb)/p.yb,m1=[[Xr,Yr,Zr],[Xg,Yg,Zg],[Xb,Yb,Zb]],m2=[[wp.X,wp.Y,wp.Z]],sm=dxm.multiply(m2,dxm.inverse(m1)),Sr=sm[0][0],Sg=sm[0][1],Sb=sm[0][2],result=[[Sr*Xr,Sr*Yr,Sr*Zr],[Sg*Xg,Sg*Yg,Sg*Zg],[Sb*Xb,Sb*Yb,Sb*Zb]];return to=="RGB"?dxm.inverse(result):result},this.epsilon=function(useApprox){return useApprox||typeof useApprox=="undefined"?.008856:216/24289},this.kappa=function(useApprox){return useApprox||typeof useApprox=="undefined"?903.3:24389/27},this.convert=function(color,from,to,kwArgs){if(converters[from]&&converters[from][to])return converters[from][to](color,kwArgs);0}},dojo.mixin(dcolor,{fromXYZ:function(xyz,kwArgs){kwArgs=kwArgs||{};var p=dcolor.Colorspace.primaries(kwArgs),m=dcolor.Colorspace.matrix("RGB",p),rgb=dojox.math.matrix.multiply([[xyz.X,xyz.Y,xyz.Z]],m),r=rgb[0][0],g=rgb[0][1],b=rgb[0][2];if(p.profile=="sRGB")var R=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,G=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:12.92*g,B=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:12.92*b;else var R=Math.pow(r,1/p.gamma),G=Math.pow(g,1/p.gamma),B=Math.pow(b,1/p.gamma);return new dcolor.Color({r:Math.floor(R*255),g:Math.floor(G*255),b:Math.floor(B*255)})}}),dojo.extend(dcolor.Color,{toXYZ:function(kwArgs){kwArgs=kwArgs||{};var p=dcolor.Colorspace.primaries(kwArgs),m=dcolor.Colorspace.matrix("XYZ",p),_r=this.r/255,_g=this.g/255,_b=this.b/255;if(p.profile=="sRGB")var r=_r>.04045?Math.pow((_r+.055)/1.055,2.4):_r/12.92,g=_g>.04045?Math.pow((_g+.055)/1.055,2.4):_g/12.92,b=_b>.04045?Math.pow((_b+.055)/1.055,2.4):_b/12.92;else var r=Math.pow(_r,p.gamma),g=Math.pow(_g,p.gamma),b=Math.pow(_b,p.gamma);var xyz=dxm([[r,g,b]],m);return{X:xyz[0][0],Y:xyz[0][1],Z:xyz[0][2]}}}),dcolor.Colorspace})