//>>built
define("dojox/lang/functional/lambda",["../..","dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(dojox,dojo,lang,arr){var df=lang.getObject("lang.functional",!0,dojox),lcache={},split="ab".split(/a*/).length>1?String.prototype.split:function(sep){var r=this.split.call(this,sep),m=sep.exec(this);return m&&m.index==0&&r.unshift(""),r},lambda=function(s){var args=[],sects=split.call(s,/\s*->\s*/m);if(sects.length>1)while(sects.length)s=sects.pop(),args=sects.pop().split(/\s*,\s*|\s+/m),sects.length&&sects.push("(function("+args+"){return ("+s+")})");else if(s.match(/\b_\b/))args=["_"];else{var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(l||r)l&&(args.push("$1"),s="$1"+s),r&&(args.push("$2"),s+="$2");else{var vars=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};arr.forEach(vars,function(v){v in t||(args.push(v),t[v]=1)})}}return{args:args,body:s}},compose=function(a){return a.length?function(){var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);for(--i;i>=0;--i)x=df.lambda(a[i]).call(this,x);return x}:function(x){return x}};return lang.mixin(df,{rawLambda:function(s){return lambda(s)},buildLambda:function(s){return s=lambda(s),"function("+s.args.join(",")+"){return ("+s.body+");}"},lambda:function(s){return typeof s=="function"?s:s instanceof Array?compose(s):s in lcache?lcache[s]:(s=lambda(s),lcache[s]=new Function(s.args,"return ("+s.body+");"))},clearLambdaCache:function(){lcache={}}}),df})