//>>built
define("dojox/editor/plugins/Save",["dojo","dijit","dojox","dijit/_editor/_Plugin","dijit/form/Button","dojo/_base/connect","dojo/_base/declare","dojo/i18n","dojo/i18n!dojox/editor/plugins/nls/Save"],function(dojo,dijit,dojox,_Plugin){return dojo.declare("dojox.editor.plugins.Save",_Plugin,{iconClassPrefix:"dijitAdditionalEditorIcon",url:"",logResults:!0,_initButton:function(){var strings=dojo.i18n.getLocalization("dojox.editor.plugins","Save");this.button=new dijit.form.Button({label:strings.save,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Save",tabIndex:"-1",onClick:dojo.hitch(this,"_save")})},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(editor){this.editor=editor,this._initButton()},_save:function(){var content=this.editor.get("value");this.save(content)},save:function(content){var headers={"Content-Type":"text/html"};if(this.url){var postArgs={url:this.url,postData:content,headers:headers,handleAs:"text"};this.button.set("disabled",!0);var deferred=dojo.xhrPost(postArgs);deferred.addCallback(dojo.hitch(this,this.onSuccess)),deferred.addErrback(dojo.hitch(this,this.onError))}else 0},onSuccess:function(resp,ioargs){this.button.set("disabled",!1),this.logResults&&0},onError:function(error,ioargs){this.button.set("disabled",!1),this.logResults&&0}}),dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin)return;var name=o.args.name.toLowerCase();name==="save"&&(o.plugin=new dojox.editor.plugins.Save({url:"url"in o.args?o.args.url:"",logResults:"logResults"in o.args?o.args.logResults:!0}))}),dojox.editor.plugins.Save})