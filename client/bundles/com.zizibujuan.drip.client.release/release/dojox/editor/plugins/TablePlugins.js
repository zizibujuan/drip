//>>built
require({cache:{"url:dojox/editor/plugins/resources/insertTable.html":'<div class="dijitDialog" tabindex="-1" role="dialog" aria-labelledby="${id}_title">\n	<div dojoAttachPoint="titleBar" class="dijitDialogTitleBar">\n	<span dojoAttachPoint="titleNode" class="dijitDialogTitle" id="${id}_title">${insertTableTitle}</span>\n	<span dojoAttachPoint="closeButtonNode" class="dijitDialogCloseIcon" dojoAttachEvent="onclick: onCancel" title="${buttonCancel}">\n		<span dojoAttachPoint="closeText" class="closeText" title="${buttonCancel}">x</span>\n	</span>\n	</div>\n    <div dojoAttachPoint="containerNode" class="dijitDialogPaneContent">\n        <table class="etdTable"><tr>\n            <td>\n                <label>${rows}</label>\n			</td><td>\n                <span dojoAttachPoint="selectRow" dojoType="dijit.form.TextBox" value="2"></span>\n            </td><td><table><tr><td class="inner">\n                <label>${columns}</label>\n			</td><td class="inner">\n                <span dojoAttachPoint="selectCol" dojoType="dijit.form.TextBox" value="2"></span>\n            </td></tr></table></td></tr>		\n			<tr><td>\n                <label>${tableWidth}</label>\n            </td><td>\n                <span dojoAttachPoint="selectWidth" dojoType="dijit.form.TextBox" value="100"></span>\n			</td><td>\n                <select dojoAttachPoint="selectWidthType" hasDownArrow="true" dojoType="dijit.form.FilteringSelect">\n                  <option value="percent">${percent}</option>\n                  <option value="pixels">${pixels}</option>\n                </select></td></tr>	\n            <tr><td>\n                <label>${borderThickness}</label>\n            </td><td>\n                <span dojoAttachPoint="selectBorder" dojoType="dijit.form.TextBox" value="1"></span>\n            </td><td>\n                ${pixels}\n            </td></tr><tr><td>\n                <label>${cellPadding}</label>\n            </td><td>\n                <span dojoAttachPoint="selectPad" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellpad"></td></tr><tr><td>\n                <label>${cellSpacing}</label>\n            </td><td>\n                <span dojoAttachPoint="selectSpace" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellspace"></td></tr></table>\n        <div class="dialogButtonContainer">\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onInsert">${buttonInsert}</div>\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onCancel">${buttonCancel}</div>\n        </div>\n	</div>\n</div>\n',"url:dojox/editor/plugins/resources/modifyTable.html":'<div class="dijitDialog" tabindex="-1" role="dialog" aria-labelledby="${id}_title">\n	<div dojoAttachPoint="titleBar" class="dijitDialogTitleBar">\n	<span dojoAttachPoint="titleNode" class="dijitDialogTitle" id="${id}_title">${modifyTableTitle}</span>\n	<span dojoAttachPoint="closeButtonNode" class="dijitDialogCloseIcon" dojoAttachEvent="onclick: onCancel" title="${buttonCancel}">\n		<span dojoAttachPoint="closeText" class="closeText" title="${buttonCancel}">x</span>\n	</span>\n	</div>\n    <div dojoAttachPoint="containerNode" class="dijitDialogPaneContent">\n        <table class="etdTable">\n          <tr><td>\n                <label>${backgroundColor}</label>\n            </td><td colspan="2">\n                <span class="colorSwatchBtn" dojoAttachPoint="backgroundCol"></span>\n            </td></tr><tr><td>\n                <label>${borderColor}</label>\n            </td><td colspan="2">\n                <span class="colorSwatchBtn" dojoAttachPoint="borderCol"></span>\n            </td></tr><tr><td>\n                <label>${align}</label>\n            </td><td colspan="2">	\n                <select dojoAttachPoint="selectAlign" dojoType="dijit.form.FilteringSelect">\n                  <option value="default">${default}</option>\n                  <option value="left">${left}</option>\n                  <option value="center">${center}</option>\n                  <option value="right">${right}</option>\n                </select>\n            </td></tr>\n            <tr><td>\n                <label>${tableWidth}</label>\n            </td><td>\n                <span dojoAttachPoint="selectWidth" dojoType="dijit.form.TextBox" value="100"></span>\n            </td><td>\n                <select dojoAttachPoint="selectWidthType" hasDownArrow="true" dojoType="dijit.form.FilteringSelect">\n                  <option value="percent">${percent}</option>\n                  <option value="pixels">${pixels}</option>\n                </select></td></tr>	\n            <tr><td>\n                <label>${borderThickness}</label>\n            </td><td>\n                <span dojoAttachPoint="selectBorder" dojoType="dijit.form.TextBox" value="1"></span>\n            </td><td>\n                ${pixels}\n            </td></tr><tr><td>\n                <label>${cellPadding}</label>\n            </td><td>\n                <span dojoAttachPoint="selectPad" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellpad"></td></tr><tr><td>\n                <label>${cellSpacing}</label>\n            </td><td>\n                <span dojoAttachPoint="selectSpace" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellspace"></td></tr>\n        </table>\n        <div class="dialogButtonContainer">\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onSet">${buttonSet}</div>\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onCancel">${buttonCancel}</div>\n        </div>\n	</div>\n</div>\n'}}),define("dojox/editor/plugins/TablePlugins",["dojo/_base/declare","dijit/_editor/_Plugin","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Dialog","dijit/Menu","dijit/MenuItem","dijit/MenuSeparator","dojo/text!./resources/insertTable.html","dojo/text!./resources/modifyTable.html","dojo/i18n!./nls/TableDialog","dijit/_base/popup","dijit/popup","dijit/ColorPalette","dojox/widget/ColorPicker","dojo/_base/connect","dijit/TooltipDialog","dijit/form/Button","dijit/form/DropDownButton","dijit/form/TextBox","dijit/form/FilteringSelect"],function(declare,_Plugin,_WidgetBase,_TemplatedMixin,_WidgetsInTemplateMixin,Dialog,Menu,MenuItem,MenuSeparator,insertTableTemplate,modifyTableTemplate,tableDialogStrings){dojo.experimental("dojox.editor.plugins.TablePlugins");var TableHandler=declare(_Plugin,{tablesConnected:!1,currentlyAvailable:!1,alwaysAvailable:!1,availableCurrentlySet:!1,initialized:!1,tableData:null,shiftKeyDown:!1,editorDomNode:null,undoEnabled:!0,refCount:0,doMixins:function(){dojo.mixin(this.editor,{getAncestorElement:function(tagName){return this._sCall("getAncestorElement",[tagName])},hasAncestorElement:function(tagName){return this._sCall("hasAncestorElement",[tagName])},selectElement:function(elem){this._sCall("selectElement",[elem])},byId:function(id){return dojo.byId(id,this.document)},query:function(arg,scope,returnFirstOnly){var ar=dojo.query(arg,scope||this.document);return returnFirstOnly?ar[0]:ar}})},initialize:function(editor){this.refCount++,editor.customUndo=!0;if(this.initialized)return;this.initialized=!0,this.editor=editor,this.editor._tablePluginHandler=this,editor.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.editorDomNode=this.editor.editNode||this.editor.iframe.document.body.firstChild,this._myListeners=[dojo.connect(this.editorDomNode,"mouseup",this.editor,"onClick"),dojo.connect(this.editor,"onDisplayChanged",this,"checkAvailable"),dojo.connect(this.editor,"onBlur",this,"checkAvailable"),dojo.connect(this.editor,"_saveSelection",this,function(){this._savedTableInfo=this.getTableInfo()}),dojo.connect(this.editor,"_restoreSelection",this,function(){delete this._savedTableInfo})],this.doMixins(),this.connectDraggable()}))},getTableInfo:function(forceNewData){if(this._savedTableInfo)return this._savedTableInfo;forceNewData&&this._tempStoreTableData(!1);if(this.tableData)return this.tableData;var tr,trs,td,tds,tbl,cols,tdIndex,trIndex,o;return td=this.editor.getAncestorElement("td"),td&&(tr=td.parentNode),tbl=this.editor.getAncestorElement("table"),tbl?(tds=dojo.query("td",tbl),tds.forEach(function(d,i){td==d&&(tdIndex=i)}),trs=dojo.query("tr",tbl),trs.forEach(function(r,i){tr==r&&(trIndex=i)}),cols=tds.length/trs.length,o={tbl:tbl,td:td,tr:tr,trs:trs,tds:tds,rows:trs.length,cols:cols,tdIndex:tdIndex,trIndex:trIndex,colIndex:tdIndex%cols}):o={},this.tableData=o,this._tempStoreTableData(500),this.tableData},connectDraggable:function(){if(!dojo.isIE)return;this.editorDomNode.ondragstart=dojo.hitch(this,"onDragStart"),this.editorDomNode.ondragend=dojo.hitch(this,"onDragEnd")},onDragStart:function(){var e=window.event;e.srcElement.id||(e.srcElement.id="tbl_"+(new Date).getTime())},onDragEnd:function(){var e=window.event,node=e.srcElement,id=node.id,doc=this.editor.document;node.tagName.toLowerCase()=="table"&&setTimeout(function(){var node=dojo.byId(id,doc);dojo.removeAttr(node,"align")},100)},checkAvailable:function(){return this.availableCurrentlySet?this.currentlyAvailable:this.editor?this.alwaysAvailable?!0:(this.currentlyAvailable=this.editor.focused&&(this._savedTableInfo?this._savedTableInfo.tbl:this.editor.hasAncestorElement("table")),this.currentlyAvailable?this.connectTableKeys():this.disconnectTableKeys(),this._tempAvailability(500),dojo.publish(this.editor.id+"_tablePlugins",[this.currentlyAvailable]),this.currentlyAvailable):!1},_prepareTable:function(tbl){var tds=this.editor.query("td",tbl);return 0,tds[0].id||tds.forEach(function(td,i){td.id||(td.id="tdid"+i+this.getTimeStamp())},this),tds},getTimeStamp:function(){return(new Date).getTime()},_tempStoreTableData:function(type){type!==!0&&(type===!1?this.tableData=null:type===undefined?0:setTimeout(dojo.hitch(this,function(){this.tableData=null}),type))},_tempAvailability:function(type){type===!0?this.availableCurrentlySet=!0:type===!1?this.availableCurrentlySet=!1:type===undefined?0:(this.availableCurrentlySet=!0,setTimeout(dojo.hitch(this,function(){this.availableCurrentlySet=!1}),type))},connectTableKeys:function(){if(this.tablesConnected)return;this.tablesConnected=!0;var node=this.editor.iframe?this.editor.document:this.editor.editNode;this.cnKeyDn=dojo.connect(node,"onkeydown",this,"onKeyDown"),this.cnKeyUp=dojo.connect(node,"onkeyup",this,"onKeyUp"),this._myListeners.push(dojo.connect(node,"onkeypress",this,"onKeyUp"))},disconnectTableKeys:function(){dojo.disconnect(this.cnKeyDn),dojo.disconnect(this.cnKeyUp),this.tablesConnected=!1},onKeyDown:function(evt){var key=evt.keyCode;key==16&&(this.shiftKeyDown=!0);if(key==9){var o=this.getTableInfo();o.tdIndex=this.shiftKeyDown?o.tdIndex-1:tabTo=o.tdIndex+1,o.tdIndex>=0&&o.tdIndex<o.tds.length?(this.editor.selectElement(o.tds[o.tdIndex]),this.currentlyAvailable=!0,this._tempAvailability(!0),this._tempStoreTableData(!0),this.stopEvent=!0):(this.stopEvent=!1,this.onDisplayChanged()),this.stopEvent&&dojo.stopEvent(evt)}},onKeyUp:function(evt){var key=evt.keyCode;key==16&&(this.shiftKeyDown=!1),(key==37||key==38||key==39||key==40)&&this.onDisplayChanged(),key==9&&this.stopEvent&&dojo.stopEvent(evt)},onDisplayChanged:function(){this.currentlyAvailable=!1,this._tempStoreTableData(!1),this._tempAvailability(!1),this.checkAvailable()},uninitialize:function(editor){this.editor==editor&&(this.refCount--,!this.refCount&&this.initialized&&(this.tablesConnected&&this.disconnectTableKeys(),this.initialized=!1,dojo.forEach(this._myListeners,function(l){dojo.disconnect(l)}),delete this._myListeners,delete this.editor._tablePluginHandler,delete this.editor),this.inherited(arguments))}}),TablePlugins=declare("dojox.editor.plugins.TablePlugins",_Plugin,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,buttonClass:dijit.form.Button,commandName:"",label:"",alwaysAvailable:!1,undoEnabled:!0,onDisplayChanged:function(withinTable){this.alwaysAvailable||(this.available=withinTable,this.button.set("disabled",!this.available))},setEditor:function(editor){this.editor=editor,this.editor.customUndo=!0,this.inherited(arguments),this._availableTopic=dojo.subscribe(this.editor.id+"_tablePlugins",this,"onDisplayChanged"),this.onEditorLoaded()},onEditorLoaded:function(){if(!this.editor._tablePluginHandler){var tablePluginHandler=new TableHandler;tablePluginHandler.initialize(this.editor)}else this.editor._tablePluginHandler.initialize(this.editor)},selectTable:function(){var o=this.getTableInfo();o&&o.tbl&&this.editor._sCall("selectElement",[o.tbl])},_initButton:function(){this.command=this.commandName,this.label=this.editor.commands[this.command]=this._makeTitle(this.command),this.inherited(arguments),delete this.command,this.connect(this.button,"onClick","modTable"),this.onDisplayChanged(!1)},modTable:function(cmd,args){dojo.isIE&&this.editor.focus(),this.begEdit();var o=this.getTableInfo(),sw=dojo.isString(cmd)?cmd:this.commandName,r,c,i,adjustColWidth=!1;switch(sw){case"insertTableRowBefore":r=o.tbl.insertRow(o.trIndex);for(i=0;i<o.cols;i++)c=r.insertCell(-1),c.innerHTML="&nbsp;";break;case"insertTableRowAfter":r=o.tbl.insertRow(o.trIndex+1);for(i=0;i<o.cols;i++)c=r.insertCell(-1),c.innerHTML="&nbsp;";break;case"insertTableColumnBefore":o.trs.forEach(function(r){c=r.insertCell(o.colIndex),c.innerHTML="&nbsp;"}),adjustColWidth=!0;break;case"insertTableColumnAfter":o.trs.forEach(function(r){c=r.insertCell(o.colIndex+1),c.innerHTML="&nbsp;"}),adjustColWidth=!0;break;case"deleteTableRow":o.tbl.deleteRow(o.trIndex),0;break;case"deleteTableColumn":o.trs.forEach(function(tr){tr.deleteCell(o.colIndex)}),adjustColWidth=!0;break;case"modifyTable":break;case"insertTable":}adjustColWidth&&this.makeColumnsEven(),this.endEdit()},begEdit:function(){this.editor._tablePluginHandler.undoEnabled&&(this.editor.customUndo?this.editor.beginEditing():this.valBeforeUndo=this.editor.getValue())},endEdit:function(){if(this.editor._tablePluginHandler.undoEnabled){if(this.editor.customUndo)this.editor.endEditing();else{var afterUndo=this.editor.getValue();this.editor.setValue(this.valBeforeUndo),this.editor.replaceValue(afterUndo)}this.editor.onDisplayChanged()}},makeColumnsEven:function(){setTimeout(dojo.hitch(this,function(){var o=this.getTableInfo(!0),w=Math.floor(100/o.cols);o.tds.forEach(function(d){dojo.attr(d,"width",w+"%")})}),10)},getTableInfo:function(forceNewData){return this.editor._tablePluginHandler.getTableInfo(forceNewData)},_makeTitle:function(str){this._strings=dojo.i18n.getLocalization("dojox.editor.plugins","TableDialog");var title=this._strings[str+"Title"]||this._strings[str+"Label"]||str;return title},getSelectedCells:function(){var cells=[],tbl=this.getTableInfo().tbl;this.editor._tablePluginHandler._prepareTable(tbl);var e=this.editor,text=e._sCall("getSelectedHtml",[null]),str=text.match(/id="*\w*"*/g);dojo.forEach(str,function(a){var id=a.substring(3,a.length);id.charAt(0)=='"'&&id.charAt(id.length-1)=='"'&&(id=id.substring(1,id.length-1));var node=e.byId(id);node&&node.tagName.toLowerCase()=="td"&&cells.push(node)},this);if(!cells.length){var sel=dijit.range.getSelection(e.window);if(sel.rangeCount){var r=sel.getRangeAt(0),node=r.startContainer;while(node&&node!=e.editNode&&node!=e.document){if(node.nodeType===1){var tg=node.tagName?node.tagName.toLowerCase():"";if(tg==="td")return[node]}node=node.parentNode}}}return cells},updateState:function(){this.button&&((this.available||this.alwaysAvailable)&&!this.get("disabled")?this.button.set("disabled",!1):this.button.set("disabled",!0))},destroy:function(){this.inherited(arguments),dojo.unsubscribe(this._availableTopic),this.editor._tablePluginHandler.uninitialize(this.editor)}}),TableContextMenu=declare(TablePlugins,{constructor:function(){this.connect(this,"setEditor",function(editor){editor.onLoadDeferred.addCallback(dojo.hitch(this,function(){this._createContextMenu()})),this.button.domNode.style.display="none"})},destroy:function(){this.menu&&(this.menu.destroyRecursive(),delete this.menu),this.inherited(arguments)},_initButton:function(){this.inherited(arguments),this.commandName=="tableContextMenu"&&(this.button.domNode.display="none")},_createContextMenu:function(){var pMenu=new Menu({targetNodeIds:[this.editor.iframe]}),messages=tableDialogStrings;pMenu.addChild(new MenuItem({label:messages.selectTableLabel,onClick:dojo.hitch(this,"selectTable")})),pMenu.addChild(new MenuSeparator),pMenu.addChild(new MenuItem({label:messages.insertTableRowBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableRowBefore")})),pMenu.addChild(new MenuItem({label:messages.insertTableRowAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableRowAfter")})),pMenu.addChild(new MenuItem({label:messages.insertTableColumnBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnBefore")})),pMenu.addChild(new MenuItem({label:messages.insertTableColumnAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnAfter")})),pMenu.addChild(new MenuSeparator),pMenu.addChild(new MenuItem({label:messages.deleteTableRowLabel,onClick:dojo.hitch(this,"modTable","deleteTableRow")})),pMenu.addChild(new MenuItem({label:messages.deleteTableColumnLabel,onClick:dojo.hitch(this,"modTable","deleteTableColumn")})),this.menu=pMenu}}),InsertTable=declare("dojox.editor.plugins.InsertTable",TablePlugins,{alwaysAvailable:!0,modTable:function(){var w=new dojox.editor.plugins.EditorTableDialog({});w.show();var c=dojo.connect(w,"onBuildTable",this,function(obj){dojo.disconnect(c);var res=this.editor.execCommand("inserthtml",obj.htmlText)})}}),ModifyTable=declare("dojox.editor.plugins.ModifyTable",TablePlugins,{modTable:function(){if(!this.editor._tablePluginHandler.checkAvailable())return;var o=this.getTableInfo(),w=new EditorModifyTableDialog({table:o.tbl});w.show(),this.connect(w,"onSetTable",function(color){var o=this.getTableInfo();dojo.attr(o.td,"bgcolor",color)})}}),CellColorDropDown=declare([_WidgetBase,_TemplatedMixin,_WidgetsInTemplateMixin],{templateString:"<div style='display: none; position: absolute; top: -10000; z-index: -10000'><div dojoType='dijit.TooltipDialog' dojoAttachPoint='dialog' class='dojoxEditorColorPicker'><div dojoType='dojox.widget.ColorPicker' dojoAttachPoint='_colorPicker'></div><div style='margin: 0.5em 0em 0em 0em'><button dojoType='dijit.form.Button' type='submit' dojoAttachPoint='_setButton'>${buttonSet}</button>&nbsp;<button dojoType='dijit.form.Button' type='button' dojoAttachPoint='_cancelButton'>${buttonCancel}</button></div></div></div>",widgetsInTemplate:!0,constructor:function(){dojo.mixin(this,tableDialogStrings)},startup:function(){this._started||(this.inherited(arguments),this.connect(this.dialog,"execute",function(){this.onChange(this.get("value"))}),this.connect(this._cancelButton,"onClick",function(){dijit.popup.close(this.dialog)}),this.connect(this.dialog,"onCancel","onCancel"),dojo.style(this.domNode,"display","block"))},_setValueAttr:function(value,priorityChange){this._colorPicker.set("value",value,priorityChange)},_getValueAttr:function(){return this._colorPicker.get("value")},setColor:function(color){this._colorPicker.setColor(color,!1)},onChange:function(value){},onCancel:function(){}}),ColorTableCell=declare("dojox.editor.plugins.ColorTableCell",TablePlugins,{constructor:function(){this.closable=!0,this.buttonClass=dijit.form.DropDownButton;var picker=new CellColorDropDown;dojo.body().appendChild(picker.domNode),picker.startup(),this.dropDown=picker.dialog,this.connect(picker,"onChange",function(color){this.editor.focus(),this.modTable(null,color)}),this.connect(picker,"onCancel",function(){this.editor.focus()}),this.connect(picker.dialog,"onOpen",function(){var o=this.getTableInfo(),tds=this.getSelectedCells(o.tbl);if(tds&&tds.length>0){var t=tds[0]==this.lastObject?tds[0]:tds[tds.length-1],color;while(t&&t!==this.editor.document&&((color=dojo.style(t,"backgroundColor"))=="transparent"||color.indexOf("rgba")==0))t=t.parentNode;color!="transparent"&&color.indexOf("rgba")!=0&&picker.setColor(color)}}),this.connect(this,"setEditor",function(editor){editor.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.connect(this.editor.editNode,"onmouseup",function(evt){this.lastObject=evt.target})}))})},_initButton:function(){this.command=this.commandName,this.label=this.editor.commands[this.command]=this._makeTitle(this.command),this.inherited(arguments),delete this.command,this.onDisplayChanged(!1)},modTable:function(cmd,args){this.begEdit();var o=this.getTableInfo(),tds=this.getSelectedCells(o.tbl);dojo.forEach(tds,function(td){dojo.style(td,"backgroundColor",args)}),this.endEdit()}});declare("dojox.editor.plugins.EditorTableDialog",[Dialog,_TemplatedMixin,_WidgetsInTemplateMixin],{baseClass:"EditorTableDialog",templateString:insertTableTemplate,postMixInProperties:function(){dojo.mixin(this,tableDialogStrings),this.inherited(arguments)},postCreate:function(){dojo.addClass(this.domNode,this.baseClass),this.inherited(arguments)},onInsert:function(){0;var rows=this.selectRow.get("value")||1,cols=this.selectCol.get("value")||1,width=this.selectWidth.get("value"),widthType=this.selectWidthType.get("value"),border=this.selectBorder.get("value"),pad=this.selectPad.get("value"),space=this.selectSpace.get("value"),_id="tbl_"+(new Date).getTime(),t='<table id="'+_id+'"width="'+width+(widthType=="percent"?"%":"")+'" border="'+border+'" cellspacing="'+space+'" cellpadding="'+pad+'">\n';for(var r=0;r<rows;r++){t+="	<tr>\n";for(var c=0;c<cols;c++)t+='		<td width="'+Math.floor(100/cols)+'%">&nbsp;</td>\n';t+="	</tr>\n"}t+="</table><br />",this.onBuildTable({htmlText:t,id:_id});var cl=dojo.connect(this,"onHide",function(){dojo.disconnect(cl);var self=this;setTimeout(function(){self.destroyRecursive()},10)});this.hide()},onCancel:function(){var c=dojo.connect(this,"onHide",function(){dojo.disconnect(c);var self=this;setTimeout(function(){self.destroyRecursive()},10)})},onBuildTable:function(tableText){}});var EditorModifyTableDialog=declare([Dialog,_TemplatedMixin,_WidgetsInTemplateMixin],{baseClass:"EditorTableDialog",table:null,tableAtts:{},templateString:modifyTableTemplate,postMixInProperties:function(){dojo.mixin(this,tableDialogStrings),this.inherited(arguments)},postCreate:function(){dojo.addClass(this.domNode,this.baseClass),this.inherited(arguments),this._cleanupWidgets=[];var w1=new dijit.ColorPalette({});this.connect(w1,"onChange",function(color){dijit.popup.close(w1),this.setBrdColor(color)}),this.connect(w1,"onBlur",function(){dijit.popup.close(w1)}),this.connect(this.borderCol,"click",function(){dijit.popup.open({popup:w1,around:this.borderCol}),w1.focus()});var w2=new dijit.ColorPalette({});this.connect(w2,"onChange",function(color){dijit.popup.close(w2),this.setBkColor(color)}),this.connect(w2,"onBlur",function(){dijit.popup.close(w2)}),this.connect(this.backgroundCol,"click",function(){dijit.popup.open({popup:w2,around:this.backgroundCol}),w2.focus()}),this._cleanupWidgets.push(w1),this._cleanupWidgets.push(w2),this.setBrdColor(dojo.attr(this.table,"bordercolor")),this.setBkColor(dojo.attr(this.table,"bgcolor"));var w=dojo.attr(this.table,"width");w||(w=this.table.style.width);var p="pixels";dojo.isString(w)&&w.indexOf("%")>-1&&(p="percent",w=w.replace(/%/,"")),w?(this.selectWidth.set("value",w),this.selectWidthType.set("value",p)):(this.selectWidth.set("value",""),this.selectWidthType.set("value","percent")),this.selectBorder.set("value",dojo.attr(this.table,"border")),this.selectPad.set("value",dojo.attr(this.table,"cellPadding")),this.selectSpace.set("value",dojo.attr(this.table,"cellSpacing")),this.selectAlign.set("value",dojo.attr(this.table,"align"))},setBrdColor:function(color){this.brdColor=color,dojo.style(this.borderCol,"backgroundColor",color)},setBkColor:function(color){this.bkColor=color,dojo.style(this.backgroundCol,"backgroundColor",color)},onSet:function(){dojo.attr(this.table,"borderColor",this.brdColor),dojo.attr(this.table,"bgColor",this.bkColor),this.selectWidth.get("value")&&(dojo.style(this.table,"width",""),dojo.attr(this.table,"width",this.selectWidth.get("value")+(this.selectWidthType.get("value")=="pixels"?"":"%"))),dojo.attr(this.table,"border",this.selectBorder.get("value")),dojo.attr(this.table,"cellPadding",this.selectPad.get("value")),dojo.attr(this.table,"cellSpacing",this.selectSpace.get("value")),dojo.attr(this.table,"align",this.selectAlign.get("value"));var c=dojo.connect(this,"onHide",function(){dojo.disconnect(c);var self=this;setTimeout(function(){self.destroyRecursive()},10)});this.hide()},onCancel:function(){var c=dojo.connect(this,"onHide",function(){dojo.disconnect(c);var self=this;setTimeout(function(){self.destroyRecursive()},10)})},onSetTable:function(tableText){},destroy:function(){this.inherited(arguments),dojo.forEach(this._cleanupWidgets,function(w){w&&w.destroy&&w.destroy()}),delete this._cleanupWidgets}});return dojo.subscribe(dijit._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin)return;if(o.args&&o.args.command){var cmd=o.args.command.charAt(0).toLowerCase()+o.args.command.substring(1,o.args.command.length);switch(cmd){case"insertTableRowBefore":case"insertTableRowAfter":case"insertTableColumnBefore":case"insertTableColumnAfter":case"deleteTableRow":case"deleteTableColumn":o.plugin=new TablePlugins({commandName:cmd});break;case"colorTableCell":o.plugin=new ColorTableCell({commandName:cmd});break;case"modifyTable":o.plugin=new ModifyTable({commandName:cmd});break;case"insertTable":o.plugin=new InsertTable({commandName:cmd});break;case"tableContextMenu":o.plugin=new TableContextMenu({commandName:cmd})}}}),TablePlugins})