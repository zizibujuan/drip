//>>built
define("dojox/treemap/DrillDownUp",["dojo/_base/lang","dojo/_base/event","dojo/_base/declare","dojo/dom-geometry","dojo/dom-construct","dojo/dom-style","dojo/_base/fx","dojo/has!touch?dojox/gesture/tap"],function(lang,event,declare,domGeom,domConstruct,domStyle,fx,tap){return declare("dojox.treemap.DrillDownUp",null,{postCreate:function(){this.inherited(arguments),this.connect(this.domNode,"dblclick",this._onDoubleClick),tap&&this.connect(this.domNode,tap.doubletap,this._onDoubleClick)},_onDoubleClick:function(e){var renderer=this._getRendererFromTarget(e.target);if(renderer.item){var item=renderer.item;if(this._isLeaf(item)){item=renderer.parentItem,renderer=this.itemToRenderer[this.getIdentity(item)];if(renderer==null)return}this.rootItem==item?this.drillUp(renderer):this.drillDown(renderer),event.stop(e)}},drillUp:function(renderer){var item=renderer.item;this.domNode.removeChild(renderer);var parent=this._getRenderer(item).parentItem;this.set("rootItem",parent),this.validateRendering(),domConstruct.place(renderer,this.domNode),domStyle.set(renderer,"zIndex",40);var finalBox=domGeom.position(this._getRenderer(item),!0),corner=domGeom.getMarginBox(this.domNode);fx.animateProperty({node:renderer,duration:500,properties:{left:{end:finalBox.x-corner.l},top:{end:finalBox.y-corner.t},height:{end:finalBox.h},width:{end:finalBox.w}},onAnimate:lang.hitch(this,function(values){var box=domGeom.getContentBox(renderer);this._layoutGroupContent(renderer,box.w,box.h,renderer.level+1,!1,!0)}),onEnd:lang.hitch(this,function(){this.domNode.removeChild(renderer)})}).play()},drillDown:function(renderer){var box=domGeom.getMarginBox(this.domNode),item=renderer.item,parentNode=renderer.parentNode,spanInfo=domGeom.position(renderer,!0);parentNode.removeChild(renderer),domConstruct.place(renderer,this.domNode),domStyle.set(renderer,{left:spanInfo.x-box.l+"px",top:spanInfo.y-box.t+"px"});var zIndex=domStyle.get(renderer,"zIndex");domStyle.set(renderer,"zIndex",40),fx.animateProperty({node:renderer,duration:500,properties:{left:{end:box.l},top:{end:box.t},height:{end:box.h},width:{end:box.w}},onAnimate:lang.hitch(this,function(values){var box2=domGeom.getContentBox(renderer);this._layoutGroupContent(renderer,box2.w,box2.h,renderer.level+1,!1)}),onEnd:lang.hitch(this,function(){domStyle.set(renderer,"zIndex",zIndex),this.set("rootItem",item)})}).play()}})})