//>>built
require({cache:{"url:dojox/grid/enhanced/templates/FilterBar.html":'<table class="dojoxGridFBar" border="0" cellspacing="0" role="presentation" dojoAttachEvent="onclick:_onClickFilterBar, onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onmousemove:_onMouseMove"\n	><tr><td class="dojoxGridFBarBtnTD"\n		><span dojoType="dijit.form.Button" class="dojoxGridFBarBtn" dojoAttachPoint="defineFilterButton" label="..." iconClass="dojoxGridFBarDefFilterBtnIcon" showLabel="true" dojoAttachEvent="onClick:_showFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n	></td><td class="dojoxGridFBarInfoTD"\n		><span class="dojoxGridFBarInner"\n			><span class="dojoxGridFBarStatus" dojoAttachPoint="statusBarNode">${_noFilterMsg}</span\n			><span dojoType="dijit.form.Button" class="dojoxGridFBarClearFilterBtn" dojoAttachPoint="clearFilterButton" \n				label="${_filterBarClearBtnLabel}" iconClass="dojoxGridFBarClearFilterBtnIcon" showLabel="true" \n				dojoAttachEvent="onClick:_clearFilterDefDialog, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n			><span dojotype="dijit.form.Button" class="dojoxGridFBarCloseBtn" dojoAttachPoint="closeFilterBarButton" \n				label="${_closeFilterBarBtnLabel}" iconClass="dojoxGridFBarCloseBtnIcon" showLabel="false" \n				dojoAttachEvent="onClick:_closeFilterBar, onMouseEnter:_onEnterButton, onMouseLeave:_onLeaveButton, onMouseMove:_onMoveButton"></span\n		></span\n	></td></tr\n></table>\n'}}),define("dojox/grid/enhanced/plugins/filter/FilterBar",["dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/lang","dojo/_base/sniff","dojo/_base/event","dojo/_base/html","dojo/_base/window","dojo/query","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/fx","dojo/_base/fx","dojo/string","dijit/focus","dojo/text!../../templates/FilterBar.html"],function(declare,array,connect,lang,has,event,html,win,query,_Widget,_TemplatedMixin,_WidgetsInTemplateMixin,fx,baseFx,string,dijitFocus,template){var _focusClass="dojoxGridFBarHover",_filteredClass="dojoxGridFBarFiltered",_stopEvent=function(evt){try{evt&&evt.preventDefault&&event.stop(evt)}catch(e){}};return declare("dojox.grid.enhanced.plugins.filter.FilterBar",[_Widget,_TemplatedMixin,_WidgetsInTemplateMixin],{templateString:template,widgetsInTemplate:!0,_timeout_statusTooltip:300,_handle_statusTooltip:null,_curColIdx:-1,plugin:null,postMixInProperties:function(){var plugin=this.plugin,nls=plugin.nls;this._filterBarDefBtnLabel=nls.filterBarDefButton,this._filterBarClearBtnLabel=nls.filterBarClearButton,this._closeFilterBarBtnLabel=nls.closeFilterBarBtn;var itemsName=plugin.args.itemsName||nls.defaultItemsName;this._noFilterMsg=string.substitute(nls.filterBarMsgNoFilterTemplate,["",itemsName]);var t=this.plugin.args.statusTipTimeout;typeof t=="number"&&(this._timeout_statusTooltip=t);var g=plugin.grid;g.showFilterBar=lang.hitch(this,"showFilterBar"),g.toggleFilterBar=lang.hitch(this,"toggleFilterBar"),g.isFilterBarShown=lang.hitch(this,"isFilterBarShown")},postCreate:function(){this.inherited(arguments),this.plugin.args.closeFilterbarButton||html.style(this.closeFilterBarButton.domNode,"display","none");var _this=this,g=this.plugin.grid,old_func=this.oldGetHeaderHeight=lang.hitch(g,g._getHeaderHeight);this.placeAt(g.viewsHeaderNode,"after"),this.connect(this.plugin.filterDefDialog,"showDialog","_onShowFilterDefDialog"),this.connect(this.plugin.filterDefDialog,"closeDialog","_onCloseFilterDefDialog"),this.connect(g.layer("filter"),"onFiltered",this._onFiltered),this.defineFilterButton.domNode.title=this.plugin.nls.filterBarDefButton,html.hasClass(win.body(),"dijit_a11y")&&this.defineFilterButton.set("label",this.plugin.nls.a11yFilterBarDefButton),this.connect(this.defineFilterButton.domNode,"click",_stopEvent),this.connect(this.clearFilterButton.domNode,"click",_stopEvent),this.connect(this.closeFilterBarButton.domNode,"click",_stopEvent),this.toggleClearFilterBtn(!0),this._initAriaInfo(),g._getHeaderHeight=function(){return old_func()+html.marginBox(_this.domNode).h},g.focus.addArea({name:"filterbar",onFocus:lang.hitch(this,this._onFocusFilterBar,!1),onBlur:lang.hitch(this,this._onBlurFilterBar)}),g.focus.placeArea("filterbar","after","header")},uninitialize:function(){var g=this.plugin.grid;g._getHeaderHeight=this.oldGetHeaderHeight,g.focus.removeArea("filterbar"),this.plugin=null},isFilterBarShown:function(){return html.style(this.domNode,"display")!="none"},showFilterBar:function(toShow,useAnim,animArgs){var g=this.plugin.grid;if(useAnim){if(Boolean(toShow)==this.isFilterBarShown())return;animArgs=animArgs||{};var anims=[],defaultDuration=500;anims.push(fx[toShow?"wipeIn":"wipeOut"](lang.mixin({node:this.domNode,duration:defaultDuration},animArgs)));var curHeight=g.views.views[0].domNode.offsetHeight,prop={duration:defaultDuration,properties:{height:{end:lang.hitch(this,function(){var barHeight=this.domNode.scrollHeight;return has("ff")&&(barHeight-=2),toShow?curHeight-barHeight:curHeight+barHeight})}}};array.forEach(g.views.views,function(view){anims.push(baseFx.animateProperty(lang.mixin({node:view.domNode},prop,animArgs)),baseFx.animateProperty(lang.mixin({node:view.scrollboxNode},prop,animArgs)))}),anims.push(baseFx.animateProperty(lang.mixin({node:g.viewsNode},prop,animArgs))),fx.combine(anims).play()}else html.style(this.domNode,"display",toShow?"":"none"),g.update()},toggleFilterBar:function(useAnim,animArgs){this.showFilterBar(!this.isFilterBarShown(),useAnim,animArgs)},getColumnIdx:function(coordX){var headers=query("[role='columnheader']",this.plugin.grid.viewsHeaderNode),idx=-1;for(var i=headers.length-1;i>=0;--i){var coord=html.position(headers[i]);if(coordX>=coord.x&&coordX<coord.x+coord.w){idx=i;break}}return idx>=0&&this.plugin.grid.layout.cells[idx].filterable!==!1?idx:-1},toggleClearFilterBtn:function(toHide){html.style(this.clearFilterButton.domNode,"display",toHide?"none":"")},_closeFilterBar:function(e){_stopEvent(e);var rulesCnt=this.plugin.filterDefDialog.getCriteria();if(rulesCnt){var handle=connect.connect(this.plugin.filterDefDialog,"clearFilter",this,function(){this.showFilterBar(!1,!0),connect.disconnect(handle)});this._clearFilterDefDialog(e)}else this.showFilterBar(!1,!0)},_showFilterDefDialog:function(e){_stopEvent(e),this.plugin.filterDefDialog.showDialog(this._curColIdx),this.plugin.grid.focus.focusArea("filterbar")},_clearFilterDefDialog:function(e){_stopEvent(e),this.plugin.filterDefDialog.onClearFilter(),this.plugin.grid.focus.focusArea("filterbar")},_onEnterButton:function(e){this._onBlurFilterBar(),_stopEvent(e)},_onMoveButton:function(e){this._onBlurFilterBar()},_onLeaveButton:function(e){this._leavingBtn=!0},_onShowFilterDefDialog:function(colIdx){typeof colIdx=="number"&&(this._curColIdx=colIdx),this._defPaneIsShown=!0},_onCloseFilterDefDialog:function(){this._defPaneIsShown=!1,this._curColIdx=-1,dijitFocus.focus(this.defineFilterButton.domNode)},_onClickFilterBar:function(e){_stopEvent(e),this._clearStatusTipTimeout(),this.plugin.grid.focus.focusArea("filterbar"),this.plugin.filterDefDialog.showDialog(this.getColumnIdx(e.clientX))},_onMouseEnter:function(e){this._onFocusFilterBar(!0,null),this._updateTipPosition(e),this._setStatusTipTimeout()},_onMouseMove:function(e){this._leavingBtn&&(this._onFocusFilterBar(!0,null),this._leavingBtn=!1),this._isFocused&&(this._setStatusTipTimeout(),this._highlightHeader(this.getColumnIdx(e.clientX)),this._handle_statusTooltip&&this._updateTipPosition(e))},_onMouseLeave:function(e){this._onBlurFilterBar()},_updateTipPosition:function(evt){this._tippos={x:evt.pageX,y:evt.pageY}},_onFocusFilterBar:function(highlightOnly,evt,step){if(!this.isFilterBarShown())return!1;this._isFocused=!0,html.addClass(this.domNode,_focusClass);if(!highlightOnly){var hasFilter=html.style(this.clearFilterButton.domNode,"display")!=="none",hasCloseButton=html.style(this.closeFilterBarButton.domNode,"display")!=="none";typeof this._focusPos=="undefined"&&(step>0?this._focusPos=0:(hasCloseButton?this._focusPos=1:this._focusPos=0,hasFilter&&++this._focusPos)),this._focusPos===0?dijitFocus.focus(this.defineFilterButton.focusNode):this._focusPos===1&&hasFilter?dijitFocus.focus(this.clearFilterButton.focusNode):dijitFocus.focus(this.closeFilterBarButton.focusNode)}return _stopEvent(evt),!0},_onBlurFilterBar:function(evt,step){this._isFocused&&(this._isFocused=!1,html.removeClass(this.domNode,_focusClass),this._clearStatusTipTimeout(),this._clearHeaderHighlight());var toBlur=!0;if(step){var buttonCount=3;html.style(this.closeFilterBarButton.domNode,"display")==="none"&&--buttonCount,html.style(this.clearFilterButton.domNode,"display")==="none"&&--buttonCount;if(buttonCount==1)delete this._focusPos;else{var current=this._focusPos;for(var next=current+step;next<0;next+=buttonCount);next%=buttonCount,step>0&&next<current||step<0&&next>current?delete this._focusPos:(this._focusPos=next,toBlur=!1)}}return toBlur},_onFiltered:function(filteredSize,originSize){var p=this.plugin,itemsName=p.args.itemsName||p.nls.defaultItemsName,msg="",g=p.grid,filterLayer=g.layer("filter");filterLayer.filterDef()?(msg=string.substitute(p.nls.filterBarMsgHasFilterTemplate,[filteredSize,originSize,itemsName]),html.addClass(this.domNode,_filteredClass)):(msg=string.substitute(p.nls.filterBarMsgNoFilterTemplate,[originSize,itemsName]),html.removeClass(this.domNode,_filteredClass)),this.statusBarNode.innerHTML=msg,this._focusPos=0},_initAriaInfo:function(){this.defineFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarDefButton),this.clearFilterButton.domNode.setAttribute("aria-label",this.plugin.nls.waiFilterBarClearButton)},_isInColumn:function(mousePos_x,headerNode,colIndex){var coord=html.position(headerNode);return mousePos_x>=coord.x&&mousePos_x<coord.x+coord.w},_setStatusTipTimeout:function(){this._clearStatusTipTimeout(),this._defPaneIsShown||(this._handle_statusTooltip=setTimeout(lang.hitch(this,this._showStatusTooltip),this._timeout_statusTooltip))},_clearStatusTipTimeout:function(){clearTimeout(this._handle_statusTooltip),this._handle_statusTooltip=null},_showStatusTooltip:function(){this._handle_statusTooltip=null,this.plugin&&this.plugin.filterStatusTip.showDialog(this._tippos.x,this._tippos.y,this.getColumnIdx(this._tippos.x))},_highlightHeader:function(colIdx){if(colIdx!=this._previousHeaderIdx){var g=this.plugin.grid,cell=g.getCell(this._previousHeaderIdx);cell&&html.removeClass(cell.getHeaderNode(),"dojoxGridCellOver"),cell=g.getCell(colIdx),cell&&html.addClass(cell.getHeaderNode(),"dojoxGridCellOver"),this._previousHeaderIdx=colIdx}},_clearHeaderHighlight:function(){if(typeof this._previousHeaderIdx!="undefined"){var g=this.plugin.grid,cell=g.getCell(this._previousHeaderIdx);cell&&g.onHeaderCellMouseOut({cellNode:cell.getHeaderNode()}),delete this._previousHeaderIdx}}})})