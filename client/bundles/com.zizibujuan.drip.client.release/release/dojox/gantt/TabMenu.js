//>>built
define("dojox/gantt/TabMenu",["./contextMenuTab","./GanttTaskControl","./GanttProjectControl","dijit/Dialog","dijit/form/Button","dijit/form/Form","dijit/registry","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/date/locale","dojo/request","dojo/on","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/dom-attr","dojo/dom-geometry","dojo/keys","dojo/domReady!"],function(contextMenuTab,GanttTaskControl,GanttProjectControl,Dialog,Button,Form,registry,declare,arrayUtil,lang,locale,request,on,dom,domClass,domConstruct,domStyle,domAttr,domGeometry,keys){return declare("dojox.gantt.TabMenu",[],{constructor:function(chart){this.ganttChart=chart,this.menuPanel=null,this.paneContentArea=null,this.paneActionBar=null,this.tabPanelDlg=null,this.tabPanelDlgId=null,this.arrTabs=[],this.isShow=!1,this.buildContent()},buildContent:function(){this.createMenuPanel(),this.createTabPanel();var taskSucAdd=this.createTab(11,"Add Successor Task","t",!0,this);taskSucAdd.addItem(1,"Id","id",!0),taskSucAdd.addItem(2,"Name","name"),taskSucAdd.addItem(3,"Start Time","startTime"),taskSucAdd.addItem(4,"Duration (hours)","duration"),taskSucAdd.addItem(5,"Percent Complete (%)","percentage"),taskSucAdd.addItem(6,"Task Assignee","taskOwner"),taskSucAdd.addAction("addSuccessorTaskAction");var taskChildAdd=this.createTab(10,"Add Child Task","t",!0,this);taskChildAdd.addItem(1,"Id","id",!0),taskChildAdd.addItem(2,"Name","name"),taskChildAdd.addItem(3,"Start Time","startTime"),taskChildAdd.addItem(4,"Duration (hours)","duration"),taskChildAdd.addItem(5,"Percent Complete (%)","percentage"),taskChildAdd.addItem(6,"Task Assignee","taskOwner"),taskChildAdd.addAction("addChildTaskAction");var taskDuration=this.createTab(4,"Set Duration(hours)","t",!0,this,!0);taskDuration.addItem(1,"Duration (hours)","duration",!0),taskDuration.addAction("durationUpdateAction");var taskCP=this.createTab(5,"Set Complete Percentage (%)","t",!0,this,!0);taskCP.addItem(1,"Percent Complete (%)","percentage",!0),taskCP.addAction("cpUpdateAction");var taskOwner=this.createTab(20,"Set Owner","t",!0,this,!0);taskOwner.addItem(1,"Task Assignee","taskOwner",!0),taskOwner.addAction("ownerUpdateAction");var taskPrevious=this.createTab(13,"Set Previous Task","t",!0,this);taskPrevious.addItem(1,"Previous Task Id","previousTaskId",!0),taskPrevious.addAction("ptUpdateAction");var taskRename=this.createTab(1,"Rename Task","t",!0,this,!0);taskRename.addItem(1,"New Name","name",!0),taskRename.addAction("renameTaskAction");var taskDelete=this.createTab(2,"Delete Task","t",!0,this);taskDelete.addAction("deleteAction");var projectAdd=this.createTab(12,"Add New Project","p",!1,this);projectAdd.addItem(1,"Id","id",!0),projectAdd.addItem(2,"Name","name",!0),projectAdd.addItem(3,"Start Date","startDate",!0),projectAdd.addAction("addProjectAction");var projectCP=this.createTab(8,"Set Complete Percentage (%)","p",!0,this,!0);projectCP.addItem(1,"Percent Complete (%)","percentage",!0),projectCP.addAction("cpProjectAction");var projectRename=this.createTab(6,"Rename Project","p",!0,this,!0);projectRename.addItem(1,"New Name","name",!0),projectRename.addAction("renameProjectAction");var projectDelete=this.createTab(7,"Delete Project","p",!0,this);projectDelete.addAction("deleteProjectAction");var projectTaskAdd=this.createTab(9,"Add New Task","p",!0,this);projectTaskAdd.addItem(1,"Id","id",!0),projectTaskAdd.addItem(2,"Name","name"),projectTaskAdd.addItem(3,"Start Time","startTime"),projectTaskAdd.addItem(4,"Duration (hours)","duration"),projectTaskAdd.addItem(5,"Percent Complete (%)","percentage"),projectTaskAdd.addItem(6,"Task Assignee","taskOwner"),projectTaskAdd.addItem(7,"Parent Task Id","parentTaskId"),projectTaskAdd.addItem(8,"Previous Task Id","previousTaskId"),projectTaskAdd.addAction("addTaskAction")},createMenuPanel:function(){this.menuPanel=domConstruct.create("div",{innerHTML:"<table></table>",className:"ganttMenuPanel"},this.ganttChart.content),domClass.add(this.menuPanel.firstChild,"ganttContextMenu"),this.menuPanel.firstChild.cellPadding=0,this.menuPanel.firstChild.cellSpacing=0},createTabPanel:function(){this.tabPanelDlg=registry.byId(this.tabPanelDlgId)||new Dialog({title:"Settings"}),this.tabPanelDlgId=this.tabPanelDlg.id,this.tabPanelDlg.closeButtonNode.style.display="none";var tabPanel=this.tabPanelDlg.containerNode;this.paneContentArea=domConstruct.create("div",{className:"dijitDialogPaneContentArea"},tabPanel),this.paneActionBar=domConstruct.create("div",{className:"dijitDialogPaneActionBar"},tabPanel),this.paneContentArea.innerHTML="<table cellpadding=0 cellspacing=0><tr><th></th></tr><tr><td></td></tr></table>";var headerCell=this.paneContentArea.firstChild.rows[0].cells[0];headerCell.colSpan=2,headerCell.innerHTML="Description: ",domClass.add(headerCell,"ganttDialogContentHeader");var contentCell=this.paneContentArea.firstChild.rows[1].cells[0];contentCell.innerHTML="<table></table>",domClass.add(contentCell.firstChild,"ganttDialogContentCell"),contentCell.align="center",this.ok=new Button({label:"OK"}),this.cancel=new Button({label:"Cancel"}),this.paneActionBar.appendChild(this.ok.domNode),this.paneActionBar.appendChild(this.cancel.domNode)},addItemMenuPanel:function(tab){var row=this.menuPanel.firstChild.insertRow(this.menuPanel.firstChild.rows.length),cell=domConstruct.create("td",{className:"ganttContextMenuItem",innerHTML:tab.Description});domAttr.set(cell,"tabIndex",0),this.ganttChart._events.push(on(cell,"click",lang.hitch(this,function(){try{this.hide(),tab.show()}catch(e){0}}))),this.ganttChart._events.push(on(cell,"keydown",lang.hitch(this,function(event){if(event.keyCode!=keys.ENTER)return;try{this.hide(),tab.show()}catch(e){0}}))),this.ganttChart._events.push(on(cell,"mouseover",lang.hitch(this,function(){domClass.add(cell,"ganttContextMenuItemHover")}))),this.ganttChart._events.push(on(cell,"mouseout",lang.hitch(this,function(){domClass.remove(cell,"ganttContextMenuItemHover")}))),row.appendChild(cell)},show:function(elem,object){object.constructor==GanttTaskControl?arrayUtil.forEach(this.arrTabs,function(tab){tab.type=="t"&&(tab.object=object,this.addItemMenuPanel(tab))},this):object.constructor==GanttProjectControl&&arrayUtil.forEach(this.arrTabs,function(tab){tab.type=="p"&&(tab.object=object,this.addItemMenuPanel(tab))},this),this.isShow=!0,domStyle.set(this.menuPanel,{zIndex:15,visibility:"visible"});var menuBox=domGeometry.position(this.menuPanel,!0),bBox=domGeometry.position(this.ganttChart.content,!0),pos=domGeometry.position(elem,!0);pos.y+menuBox.h>bBox.y+bBox.h+50?this.menuPanel.style.top=pos.y-menuBox.h+pos.h+"px":this.menuPanel.style.top=pos.y+"px",domGeometry.isBodyLtr()?this.menuPanel.style.left=pos.x+pos.w+5+"px":this.menuPanel.style.left=pos.x-menuBox.w-5+"px"},hide:function(){this.isShow=!1,this.menuPanel.style.visibility="hidden"},clear:function(){this.menuPanel.removeChild(this.menuPanel.firstChild),this.menuPanel.innerHTML="<table></table>",domClass.add(this.menuPanel.firstChild,"ganttContextMenu"),this.menuPanel.firstChild.cellPadding=0,this.menuPanel.firstChild.cellSpacing=0},createTab:function(id,desc,type,showOInfo,menu,withDefaultValue){var tab=new contextMenuTab(id,desc,type,showOInfo,menu,withDefaultValue);return this.arrTabs.push(tab),tab}})})