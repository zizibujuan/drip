//>>built
require({cache:{"url:dojox/atom/widget/templates/FeedEntryEditor.html":'<div class="feedEntryViewer">\n    <table border="0" width="100%" class="feedEntryViewerMenuTable" dojoAttachPoint="feedEntryViewerMenu" style="display: none;">\n        <tr width="100%"  dojoAttachPoint="entryCheckBoxDisplayOptions">\n        	<td align="left" dojoAttachPoint="entryNewButton">\n                <span class="feedEntryViewerMenu" dojoAttachPoint="doNew" dojoAttachEvent="onclick:_toggleNew"></span>\n        	</td>\n            <td align="left" dojoAttachPoint="entryEditButton" style="display: none;">\n                <span class="feedEntryViewerMenu" dojoAttachPoint="edit" dojoAttachEvent="onclick:_toggleEdit"></span>\n            </td>\n            <td align="left" dojoAttachPoint="entrySaveCancelButtons" style="display: none;">\n                <span class="feedEntryViewerMenu" dojoAttachPoint="save" dojoAttachEvent="onclick:saveEdits"></span>\n                <span class="feedEntryViewerMenu" dojoAttachPoint="cancel" dojoAttachEvent="onclick:cancelEdits"></span>\n            </td>\n            <td align="right">\n                <span class="feedEntryViewerMenu" dojoAttachPoint="displayOptions" dojoAttachEvent="onclick:_toggleOptions"></span>\n            </td>\n        </tr>\n        <tr class="feedEntryViewerDisplayCheckbox" dojoAttachPoint="entryCheckBoxRow" width="100%" style="display: none;">\n            <td dojoAttachPoint="feedEntryCelltitle">\n                <input type="checkbox" name="title" value="Title" dojoAttachPoint="feedEntryCheckBoxTitle" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelTitle"></label>\n            </td>\n            <td dojoAttachPoint="feedEntryCellauthors">\n                <input type="checkbox" name="authors" value="Authors" dojoAttachPoint="feedEntryCheckBoxAuthors" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelAuthors"></label>\n            </td>\n            <td dojoAttachPoint="feedEntryCellcontributors">\n                <input type="checkbox" name="contributors" value="Contributors" dojoAttachPoint="feedEntryCheckBoxContributors" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelContributors"></label>\n            </td>\n            <td dojoAttachPoint="feedEntryCellid">\n                <input type="checkbox" name="id" value="Id" dojoAttachPoint="feedEntryCheckBoxId" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelId"></label>\n            </td>\n            <td rowspan="2" align="right">\n                <span class="feedEntryViewerMenu" dojoAttachPoint="close" dojoAttachEvent="onclick:_toggleOptions"></span>\n            </td>\n		</tr>\n		<tr class="feedEntryViewerDisplayCheckbox" dojoAttachPoint="entryCheckBoxRow2" width="100%" style="display: none;">\n            <td dojoAttachPoint="feedEntryCellupdated">\n                <input type="checkbox" name="updated" value="Updated" dojoAttachPoint="feedEntryCheckBoxUpdated" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelUpdated"></label>\n            </td>\n            <td dojoAttachPoint="feedEntryCellsummary">\n                <input type="checkbox" name="summary" value="Summary" dojoAttachPoint="feedEntryCheckBoxSummary" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelSummary"></label>\n            </td>\n            <td dojoAttachPoint="feedEntryCellcontent">\n                <input type="checkbox" name="content" value="Content" dojoAttachPoint="feedEntryCheckBoxContent" dojoAttachEvent="onclick:_toggleCheckbox"/>\n				<label for="title" dojoAttachPoint="feedEntryCheckBoxLabelContent"></label>\n            </td>\n        </tr>\n    </table>\n    \n    <table class="feedEntryViewerContainer" border="0" width="100%">\n        <tr class="feedEntryViewerTitle" dojoAttachPoint="entryTitleRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryTitleHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        	<select dojoAttachPoint="entryTitleSelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\n                        		<option value="text">Text</option>\n								<option value="html">HTML</option>\n								<option value="xhtml">XHTML</option>\n                        	</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan="2" dojoAttachPoint="entryTitleNode">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n        <tr class="feedEntryViewerAuthor" dojoAttachPoint="entryAuthorRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryAuthorHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entryAuthorNode">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n\n        <tr class="feedEntryViewerContributor" dojoAttachPoint="entryContributorRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryContributorHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entryContributorNode" class="feedEntryViewerContributorNames">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        \n        <tr class="feedEntryViewerId" dojoAttachPoint="entryIdRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryIdHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entryIdNode" class="feedEntryViewerIdText">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class="feedEntryViewerUpdated" dojoAttachPoint="entryUpdatedRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryUpdatedHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entryUpdatedNode" class="feedEntryViewerUpdatedText">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class="feedEntryViewerSummary" dojoAttachPoint="entrySummaryRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2" colspan="2">\n							<span class="lp" dojoAttachPoint="entrySummaryHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        	<select dojoAttachPoint="entrySummarySelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\n                        		<option value="text">Text</option>\n								<option value="html">HTML</option>\n								<option value="xhtml">XHTML</option>\n                        	</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entrySummaryNode">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    \n        <tr class="feedEntryViewerContent" dojoAttachPoint="entryContentRow" style="display: none;">\n            <td>\n                <table width="100%" cellpadding="0" cellspacing="0" border="0">\n                    <tr class="graphic-tab-lgray">\n						<td class="lp2">\n							<span class="lp" dojoAttachPoint="entryContentHeader"></span>\n						</td>\n                    </tr>\n                    <tr>\n                        <td>\n                        	<select dojoAttachPoint="entryContentSelect" dojoAttachEvent="onchange:_switchEditor" style="display: none">\n                        		<option value="text">Text</option>\n								<option value="html">HTML</option>\n								<option value="xhtml">XHTML</option>\n                        	</select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td dojoAttachPoint="entryContentNode">\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</div>\n',"url:dojox/atom/widget/templates/PeopleEditor.html":'<div class="peopleEditor">\n	<table style="width: 100%">\n		<tbody dojoAttachPoint="peopleEditorEditors"></tbody>\n	</table>\n	<span class="peopleEditorButton" dojoAttachPoint="peopleEditorButton" dojoAttachEvent="onclick:_add"></span>\n</div>'}}),define("dojox/atom/widget/FeedEntryEditor",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/connect","dojo/_base/declare","dojo/_base/fx","dojo/_base/sniff","dojo/dom","dojo/dom-style","dojo/dom-construct","dijit/_Widget","dijit/_Templated","dijit/_Container","dijit/Editor","dijit/form/TextBox","dijit/form/SimpleTextarea","./FeedEntryViewer","../io/model","dojo/text!./templates/FeedEntryEditor.html","dojo/text!./templates/PeopleEditor.html","dojo/i18n!./nls/FeedEntryViewer","dojo/i18n!./nls/FeedEntryEditor","dojo/i18n!./nls/PeopleEditor"],function(dojo,lang,connect,declare,fx,has,domUtil,domStyle,domConstruct,_Widget,_Templated,_Container,Editor,TextBox,SimpleTextarea,FeedEntryViewer,model,template,peopleEditorTemplate,i18nViewer,i18nEditor,i18nPeople){dojo.experimental("dojox.atom.widget.FeedEntryEditor");var FeedEntryEditor=declare("dojox.atom.widget.FeedEntryEditor",FeedEntryViewer,{_contentEditor:null,_oldContent:null,_setObject:null,enableEdit:!1,_contentEditorCreator:null,_editors:{},entryNewButton:null,_editable:!1,templateString:template,postCreate:function(){this.entrySelectionTopic!==""&&(this._subscriptions=[dojo.subscribe(this.entrySelectionTopic,this,"_handleEvent")]);var _nlsResources=i18nViewer;this.displayOptions.innerHTML=_nlsResources.displayOptions,this.feedEntryCheckBoxLabelTitle.innerHTML=_nlsResources.title,this.feedEntryCheckBoxLabelAuthors.innerHTML=_nlsResources.authors,this.feedEntryCheckBoxLabelContributors.innerHTML=_nlsResources.contributors,this.feedEntryCheckBoxLabelId.innerHTML=_nlsResources.id,this.close.innerHTML=_nlsResources.close,this.feedEntryCheckBoxLabelUpdated.innerHTML=_nlsResources.updated,this.feedEntryCheckBoxLabelSummary.innerHTML=_nlsResources.summary,this.feedEntryCheckBoxLabelContent.innerHTML=_nlsResources.content,_nlsResources=i18nEditor,this.doNew.innerHTML=_nlsResources.doNew,this.edit.innerHTML=_nlsResources.edit,this.save.innerHTML=_nlsResources.save,this.cancel.innerHTML=_nlsResources.cancel},setEntry:function(entry,feed,leaveMenuState){this._entry!==entry?(this._editMode=!1,leaveMenuState=!1):leaveMenuState=!0,FeedEntryEditor.superclass.setEntry.call(this,entry,feed),this._editable=this._isEditable(entry),!leaveMenuState&&!this._editable&&(domStyle.set(this.entryEditButton,"display","none"),domStyle.set(this.entrySaveCancelButtons,"display","none")),this._editable&&this.enableEdit&&(leaveMenuState||(domStyle.set(this.entryEditButton,"display",""),this.enableMenuFade&&this.entrySaveCancelButton&&fx.fadeOut({node:this.entrySaveCancelButton,duration:250}).play()))},_toggleEdit:function(){this._editable&&this.enableEdit&&(domStyle.set(this.entryEditButton,"display","none"),domStyle.set(this.entrySaveCancelButtons,"display",""),this._editMode=!0,this.setEntry(this._entry,this._feed,!0))},_handleEvent:function(entrySelectionEvent){entrySelectionEvent.source!=this&&entrySelectionEvent.action=="delete"&&entrySelectionEvent.entry&&entrySelectionEvent.entry==this._entry&&domStyle.set(this.entryEditButton,"display","none"),FeedEntryEditor.superclass._handleEvent.call(this,entrySelectionEvent)},_isEditable:function(entry){var retVal=!1;if(entry&&entry!==null&&entry.links&&entry.links!==null)for(var x in entry.links)if(entry.links[x].rel&&entry.links[x].rel=="edit"){retVal=!0;break}return retVal},setTitle:function(titleAnchorNode,editMode,entry){if(!editMode)FeedEntryEditor.superclass.setTitle.call(this,titleAnchorNode,editMode,entry),entry.title&&entry.title.value&&entry.title.value!==null&&this.setFieldValidity("title",!0);else if(entry.title&&entry.title.value&&entry.title.value!==null){this._toLoad||(this._toLoad=[]),this.entryTitleSelect.value=entry.title.type;var editor=this._createEditor(titleAnchorNode,entry.title,!0,entry.title.type==="html"||entry.title.type==="xhtml");editor.name="title",this._toLoad.push(editor),this.setFieldValidity("titleedit",!0),this.setFieldValidity("title",!0)}},setAuthors:function(authorsAnchorNode,editMode,entry){editMode?entry.authors&&entry.authors.length>0&&(this._editors.authors=this._createPeopleEditor(this.entryAuthorNode,{data:entry.authors,name:"Author"}),this.setFieldValidity("authors",!0)):(FeedEntryEditor.superclass.setAuthors.call(this,authorsAnchorNode,editMode,entry),entry.authors&&entry.authors.length>0&&this.setFieldValidity("authors",!0))},setContributors:function(contributorsAnchorNode,editMode,entry){editMode?entry.contributors&&entry.contributors.length>0&&(this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{data:entry.contributors,name:"Contributor"}),this.setFieldValidity("contributors",!0)):(FeedEntryEditor.superclass.setContributors.call(this,contributorsAnchorNode,editMode,entry),entry.contributors&&entry.contributors.length>0&&this.setFieldValidity("contributors",!0))},setId:function(idAnchorNode,editMode,entry){editMode?entry.id&&entry.id!==null&&(this._editors.id=this._createEditor(idAnchorNode,entry.id),this.setFieldValidity("id",!0)):(FeedEntryEditor.superclass.setId.call(this,idAnchorNode,editMode,entry),entry.id&&entry.id!==null&&this.setFieldValidity("id",!0))},setUpdated:function(updatedAnchorNode,editMode,entry){editMode?entry.updated&&entry.updated!==null&&(this._editors.updated=this._createEditor(updatedAnchorNode,entry.updated),this.setFieldValidity("updated",!0)):(FeedEntryEditor.superclass.setUpdated.call(this,updatedAnchorNode,editMode,entry),entry.updated&&entry.updated!==null&&this.setFieldValidity("updated",!0))},setSummary:function(summaryAnchorNode,editMode,entry){if(!editMode)FeedEntryEditor.superclass.setSummary.call(this,summaryAnchorNode,editMode,entry),entry.summary&&entry.summary.value&&entry.summary.value!==null&&this.setFieldValidity("summary",!0);else if(entry.summary&&entry.summary.value&&entry.summary.value!==null){this._toLoad||(this._toLoad=[]),this.entrySummarySelect.value=entry.summary.type;var editor=this._createEditor(summaryAnchorNode,entry.summary,!0,entry.summary.type==="html"||entry.summary.type==="xhtml");editor.name="summary",this._toLoad.push(editor),this.setFieldValidity("summaryedit",!0),this.setFieldValidity("summary",!0)}},setContent:function(contentAnchorNode,editMode,entry){if(!editMode)FeedEntryEditor.superclass.setContent.call(this,contentAnchorNode,editMode,entry),entry.content&&entry.content.value&&entry.content.value!==null&&this.setFieldValidity("content",!0);else if(entry.content&&entry.content.value&&entry.content.value!==null){this._toLoad||(this._toLoad=[]),this.entryContentSelect.value=entry.content.type;var editor=this._createEditor(contentAnchorNode,entry.content,!0,entry.content.type==="html"||entry.content.type==="xhtml");editor.name="content",this._toLoad.push(editor),this.setFieldValidity("contentedit",!0),this.setFieldValidity("content",!0)}},_createEditor:function(anchorNode,node,multiline,rte){var viewNode,box;if(!node)return rte?{anchorNode:anchorNode,entryValue:"",editor:null,generateEditor:function(){var node=document.createElement("div");node.innerHTML=this.entryValue,this.anchorNode.appendChild(node);var _editor=new Editor({},node);return this.editor=_editor,_editor}}:(multiline?(viewNode=document.createElement("textarea"),anchorNode.appendChild(viewNode),domStyle.set(viewNode,"width","90%"),box=new SimpleTextarea({},viewNode)):(viewNode=document.createElement("input"),anchorNode.appendChild(viewNode),domStyle.set(viewNode,"width","95%"),box=new TextBox({},viewNode)),box.attr("value",""),box);var value;return node.value!==undefined?value=node.value:node.attr?value=node.attr("value"):value=node,rte?(value.indexOf("<")!=-1&&(value=value.replace(/</g,"&lt;")),{anchorNode:anchorNode,entryValue:value,editor:null,generateEditor:function(){var node=document.createElement("div");node.innerHTML=this.entryValue,this.anchorNode.appendChild(node);var _editor=new Editor({},node);return this.editor=_editor,_editor}}):(multiline?(viewNode=document.createElement("textarea"),anchorNode.appendChild(viewNode),domStyle.set(viewNode,"width","90%"),box=new SimpleTextarea({},viewNode)):(viewNode=document.createElement("input"),anchorNode.appendChild(viewNode),domStyle.set(viewNode,"width","95%"),box=new TextBox({},viewNode)),box.attr("value",value),box)},_switchEditor:function(event){var type=null,target=null,parent=null;has("ie")?target=event.srcElement:target=event.target,target===this.entryTitleSelect?(parent=this.entryTitleNode,type="title"):target===this.entrySummarySelect?(parent=this.entrySummaryNode,type="summary"):(parent=this.entryContentNode,type="content");var editor=this._editors[type],newEditor,value;if(target.value==="text"){if(editor.isInstanceOf(Editor)){value=editor.attr("value",!1),editor.close(!1,!0),editor.destroy();while(parent.firstChild)domConstruct.destroy(parent.firstChild);newEditor=this._createEditor(parent,{value:value},!0,!1),this._editors[type]=newEditor}}else if(!editor.isInstanceOf(Editor)){value=editor.attr("value"),editor.destroy();while(parent.firstChild)domConstruct.destroy(parent.firstChild);newEditor=this._createEditor(parent,{value:value},!0,!0),newEditor=lang.hitch(newEditor,newEditor.generateEditor)(),this._editors[type]=newEditor}},_createPeopleEditor:function(anchorNode,node){var viewNode=document.createElement("div");return anchorNode.appendChild(viewNode),new PeopleEditor(node,viewNode)},saveEdits:function(){domStyle.set(this.entrySaveCancelButtons,"display","none"),domStyle.set(this.entryEditButton,"display",""),domStyle.set(this.entryNewButton,"display","");var modifiedEntry=!1,value,i,changed,entry,authors,contributors;if(!this._new){entry=this.getEntry(),this._editors.title&&(this._editors.title.attr("value")!=entry.title.value||this.entryTitleSelect.value!=entry.title.type)&&(value=this._editors.title.attr("value"),this.entryTitleSelect.value==="xhtml"&&(value=this._enforceXhtml(value),value.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')!==0&&(value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>")),entry.title=new model.Content("title",value,null,this.entryTitleSelect.value),modifiedEntry=!0),this._editors.id.attr("value")!=entry.id&&(entry.id=this._editors.id.attr("value"),modifiedEntry=!0),this._editors.summary&&(this._editors.summary.attr("value")!=entry.summary.value||this.entrySummarySelect.value!=entry.summary.type)&&(value=this._editors.summary.attr("value"),this.entrySummarySelect.value==="xhtml"&&(value=this._enforceXhtml(value),value.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')!==0&&(value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>")),entry.summary=new model.Content("summary",value,null,this.entrySummarySelect.value),modifiedEntry=!0),this._editors.content&&(this._editors.content.attr("value")!=entry.content.value||this.entryContentSelect.value!=entry.content.type)&&(value=this._editors.content.attr("value"),this.entryContentSelect.value==="xhtml"&&(value=this._enforceXhtml(value),value.indexOf('<div xmlns="http://www.w3.org/1999/xhtml">')!==0&&(value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>")),entry.content=new model.Content("content",value,null,this.entryContentSelect.value),modifiedEntry=!0);if(this._editors.authors)if(modifiedEntry){entry.authors=[],authors=this._editors.authors.getValues();for(i in authors)(authors[i].name||authors[i].email||authors[i].uri)&&entry.addAuthor(authors[i].name,authors[i].email,authors[i].uri)}else{var currentAuthors=entry.authors,searchAuthors=function(name,email,uri){for(i in currentAuthors)if(currentAuthors[i].name===name&&currentAuthors[i].email===email&&currentAuthors[i].uri===uri)return!0;return!1};authors=this._editors.authors.getValues(),changed=!1;for(i in authors)if(!searchAuthors(authors[i].name,authors[i].email,authors[i].uri)){changed=!0;break}if(changed){entry.authors=[];for(i in authors)(authors[i].name||authors[i].email||authors[i].uri)&&entry.addAuthor(authors[i].name,authors[i].email,authors[i].uri);modifiedEntry=!0}}if(this._editors.contributors)if(modifiedEntry){entry.contributors=[],contributors=this._editors.contributors.getValues();for(i in contributors)(contributors[i].name||contributors[i].email||contributors[i].uri)&&entry.addAuthor(contributors[i].name,contributors[i].email,contributors[i].uri)}else{var currentContributors=entry.contributors,searchContributors=function(name,email,uri){for(i in currentContributors)if(currentContributors[i].name===name&&currentContributors[i].email===email&&currentContributors[i].uri===uri)return!0;return!1};contributors=this._editors.contributors.getValues(),changed=!1;for(i in contributors)if(searchContributors(contributors[i].name,contributors[i].email,contributors[i].uri)){changed=!0;break}if(changed){entry.contributors=[];for(i in contributors)(contributors[i].name||contributors[i].email||contributors[i].uri)&&entry.addContributor(contributors[i].name,contributors[i].email,contributors[i].uri);modifiedEntry=!0}}modifiedEntry&&dojo.publish(this.entrySelectionTopic,[{action:"update",source:this,entry:entry,callback:this._handleSave}])}else{this._new=!1,entry=new model.Entry,value=this._editors.title.attr("value"),this.entryTitleSelect.value==="xhtml"&&(value=this._enforceXhtml(value),value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>"),entry.setTitle(value,this.entryTitleSelect.value),entry.id=this._editors.id.attr("value"),authors=this._editors.authors.getValues();for(i in authors)(authors[i].name||authors[i].email||authors[i].uri)&&entry.addAuthor(authors[i].name,authors[i].email,authors[i].uri);contributors=this._editors.contributors.getValues();for(i in contributors)(contributors[i].name||contributors[i].email||contributors[i].uri)&&entry.addContributor(contributors[i].name,contributors[i].email,contributors[i].uri);value=this._editors.summary.attr("value"),this.entrySummarySelect.value==="xhtml"&&(value=this._enforceXhtml(value),value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>"),entry.summary=new model.Content("summary",value,null,this.entrySummarySelect.value),value=this._editors.content.attr("value"),this.entryContentSelect.value==="xhtml"&&(value=this._enforceXhtml(value),value='<div xmlns="http://www.w3.org/1999/xhtml">'+value+"</div>"),entry.content=new model.Content("content",value,null,this.entryContentSelect.value),domStyle.set(this.entryNewButton,"display",""),dojo.publish(this.entrySelectionTopic,[{action:"post",source:this,entry:entry}])}this._editMode=!1,this.setEntry(entry,this._feed,!0)},_handleSave:function(entry,location){this._editMode=!1,this.clear(),this.setEntry(entry,this.getFeed(),!0)},cancelEdits:function(){this._new=!1,domStyle.set(this.entrySaveCancelButtons,"display","none"),this._editable&&domStyle.set(this.entryEditButton,"display",""),domStyle.set(this.entryNewButton,"display",""),this._editMode=!1,this.clearEditors(),this.setEntry(this.getEntry(),this.getFeed(),!0)},clear:function(){this._editable=!1,this.clearEditors(),FeedEntryEditor.superclass.clear.apply(this),this._contentEditor&&(this._contentEditor=this._setObject=this._oldContent=this._contentEditorCreator=null,this._editors={})},clearEditors:function(){for(var key in this._editors)this._editors[key].isInstanceOf(Editor)&&this._editors[key].close(!1,!0),this._editors[key].destroy();this._editors={}},_enforceXhtml:function(html){var xhtml=null;if(html){var brRegExp=/<br>/g;xhtml=html.replace(brRegExp,"<br/>"),xhtml=this._closeTag(xhtml,"hr"),xhtml=this._closeTag(xhtml,"img")}return xhtml},_closeTag:function(xhtml,tag){var tagStart="<"+tag,tagIndex=xhtml.indexOf(tagStart);if(tagIndex!==-1)while(tagIndex!==-1){var tempString="",foundTagEnd=!1;for(var i=0;i<xhtml.length;i++){var c=xhtml.charAt(i);i<=tagIndex||foundTagEnd?tempString+=c:(c===">"&&(tempString+="/",foundTagEnd=!0),tempString+=c)}xhtml=tempString,tagIndex=xhtml.indexOf(tagStart,tagIndex+1)}return xhtml},_toggleNew:function(){domStyle.set(this.entryNewButton,"display","none"),domStyle.set(this.entryEditButton,"display","none"),domStyle.set(this.entrySaveCancelButtons,"display",""),this.entrySummarySelect.value="text",this.entryContentSelect.value="text",this.entryTitleSelect.value="text",this.clearNodes(),this._new=!0;var _nlsResources=i18nViewer,titleHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.title});this.entryTitleHeader.appendChild(titleHeader.domNode),this._editors.title=this._createEditor(this.entryTitleNode,null),this.setFieldValidity("title",!0);var authorHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.authors});this.entryAuthorHeader.appendChild(authorHeader.domNode),this._editors.authors=this._createPeopleEditor(this.entryAuthorNode,{name:"Author"}),this.setFieldValidity("authors",!0);var contributorHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.contributors});this.entryContributorHeader.appendChild(contributorHeader.domNode),this._editors.contributors=this._createPeopleEditor(this.entryContributorNode,{name:"Contributor"}),this.setFieldValidity("contributors",!0);var idHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.id});this.entryIdHeader.appendChild(idHeader.domNode),this._editors.id=this._createEditor(this.entryIdNode,null),this.setFieldValidity("id",!0);var updatedHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.updated});this.entryUpdatedHeader.appendChild(updatedHeader.domNode),this._editors.updated=this._createEditor(this.entryUpdatedNode,null),this.setFieldValidity("updated",!0);var summaryHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.summary});this.entrySummaryHeader.appendChild(summaryHeader.domNode),this._editors.summary=this._createEditor(this.entrySummaryNode,null,!0),this.setFieldValidity("summaryedit",!0),this.setFieldValidity("summary",!0);var contentHeader=new FeedEntryViewer.EntryHeader({title:_nlsResources.content});this.entryContentHeader.appendChild(contentHeader.domNode),this._editors.content=this._createEditor(this.entryContentNode,null,!0),this.setFieldValidity("contentedit",!0),this.setFieldValidity("content",!0),this._displaySections()},_displaySections:function(){domStyle.set(this.entrySummarySelect,"display","none"),domStyle.set(this.entryContentSelect,"display","none"),domStyle.set(this.entryTitleSelect,"display","none"),this.isFieldValid("contentedit")&&domStyle.set(this.entryContentSelect,"display",""),this.isFieldValid("summaryedit")&&domStyle.set(this.entrySummarySelect,"display",""),this.isFieldValid("titleedit")&&domStyle.set(this.entryTitleSelect,"display",""),FeedEntryEditor.superclass._displaySections.apply(this);if(this._toLoad){for(var i in this._toLoad){var editor;this._toLoad[i].generateEditor?editor=lang.hitch(this._toLoad[i],this._toLoad[i].generateEditor)():editor=this._toLoad[i],this._editors[this._toLoad[i].name]=editor,this._toLoad[i]=null}this._toLoad=null}}}),PeopleEditor=declare("dojox.atom.widget.PeopleEditor",[_Widget,_Templated,_Container],{templateString:peopleEditorTemplate,_rows:[],_editors:[],_index:0,_numRows:0,postCreate:function(){var _nlsResources=i18nPeople;this.name?this.name=="Author"?this.peopleEditorButton.appendChild(document.createTextNode("["+_nlsResources.addAuthor+"]")):this.name=="Contributor"&&this.peopleEditorButton.appendChild(document.createTextNode("["+_nlsResources.addContributor+"]")):this.peopleEditorButton.appendChild(document.createTextNode("["+_nlsResources.add+"]")),this._editors=[];if(!this.data||this.data.length===0)this._createEditors(null,null,null,0,this.name),this._index=1;else for(var i in this.data)this._createEditors(this.data[i].name,this.data[i].email,this.data[i].uri,i),this._index++,this._numRows++},destroy:function(){for(var key in this._editors)for(var key2 in this._editors[key])this._editors[key][key2].destroy();this._editors=[]},_createEditors:function(name,email,uri,index,widgetName){var row=document.createElement("tr");this.peopleEditorEditors.appendChild(row),row.id="removeRow"+index;var node=document.createElement("td");node.setAttribute("align","right"),row.appendChild(node),node.colSpan=2;if(this._numRows>0){var hr=document.createElement("hr");node.appendChild(hr),hr.id="hr"+index}row=document.createElement("span"),node.appendChild(row),row.className="peopleEditorButton",domStyle.set(row,"font-size","x-small"),connect.connect(row,"onclick",this,"_removeEditor"),row.id="remove"+index,node=document.createTextNode("[X]"),row.appendChild(node),row=document.createElement("tr"),this.peopleEditorEditors.appendChild(row),row.id="editorsRow"+index;var labelNode=document.createElement("td");row.appendChild(labelNode),domStyle.set(labelNode,"width","20%"),node=document.createElement("td"),row.appendChild(node),row=document.createElement("table"),labelNode.appendChild(row),domStyle.set(row,"width","100%"),labelNode=document.createElement("tbody"),row.appendChild(labelNode),row=document.createElement("table"),node.appendChild(row),domStyle.set(row,"width","100%"),node=document.createElement("tbody"),row.appendChild(node),this._editors[index]=[],this._editors[index].push(this._createEditor(name,widgetName+"name"+index,"Name:",labelNode,node)),this._editors[index].push(this._createEditor(email,widgetName+"email"+index,"Email:",labelNode,node)),this._editors[index].push(this._createEditor(uri,widgetName+"uri"+index,"URI:",labelNode,node))},_createEditor:function(value,id,name,labelNode,node){var row=document.createElement("tr");labelNode.appendChild(row);var label=document.createElement("label");label.setAttribute("for",id),label.appendChild(document.createTextNode(name)),labelNode=document.createElement("td"),labelNode.appendChild(label),row.appendChild(labelNode),row=document.createElement("tr"),node.appendChild(row),node=document.createElement("td"),row.appendChild(node);var viewNode=document.createElement("input");viewNode.setAttribute("id",id),node.appendChild(viewNode),domStyle.set(viewNode,"width","95%");var box=new TextBox({},viewNode);return box.attr("value",value),box},_removeEditor:function(event){var target=null;has("ie")?target=event.srcElement:target=event.target;var id=target.id;id=id.substring(6);for(var key in this._editors[id])this._editors[id][key].destroy();var node=domUtil.byId("editorsRow"+id),parent=node.parentNode;parent.removeChild(node),node=domUtil.byId("removeRow"+id),parent=node.parentNode,parent.removeChild(node),this._numRows--,this._numRows===1&&parent.firstChild.firstChild.firstChild.tagName.toLowerCase()==="hr"&&(node=parent.firstChild.firstChild,node.removeChild(node.firstChild)),this._editors[id]=null},_add:function(){this._createEditors(null,null,null,this._index),this._index++,this._numRows++},getValues:function(){var values=[];for(var i in this._editors)this._editors[i]&&values.push({name:this._editors[i][0].attr("value"),email:this._editors[i][1].attr("value"),uri:this._editors[i][2].attr("value")});return values}});return FeedEntryEditor})