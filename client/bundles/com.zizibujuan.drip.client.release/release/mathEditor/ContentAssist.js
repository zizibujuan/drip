//>>built
define("mathEditor/ContentAssist","dojo/_base/declare,dojo/_base/array,dojo/_base/lang,dojo/on,dojo/dom-construct,dojo/dom-class,dojo/dom-style,dijit/popup,dijit/DropDownMenu,dijit/MenuItem,mathEditor/mathContentAssist".split(","),function(h,g,f,i,m,n,o,e,j,k,l){return h("mathEditor.ContentAssist",j,{proposals:null,view:null,cacheString:"",opened:!1,postCreate:function(){this.inherited(arguments);i(this.view.editorDiv,"mousedown",f.hitch(this,function(){this.opened&&e.close(this)}))},startup:function(){this.inherited(arguments)},
_scheduleOpen:function(a,c,b){view=this.view;var d=this;if(!this._openTimer)this._openTimer=this.defer(function(){delete this._openTimer;e.open({popup:a,x:c,y:b,onExecute:function(){e.close(a);view.focus();d.opened=!1},onCancel:function(){e.close(a);d.opened=!1;view.focus()},onClose:function(){view.focus();d.opened=!1}});this.opened=!0;a.select()},0)},_open:function(){var a=this.view.getCursorPosition();this._scheduleOpen(this,a.x,a.y)},_clear:function(){var a=this.getChildren();g.forEach(a,f.hitch(this,
function(a){this.removeChild(a)}))},_setProposals:function(a){this._clear();this.proposals=a;g.forEach(a,f.hitch(this,function(a){var b=new k({label:a.label,iconClass:a.iconClass});b.on("click",f.hitch(this,this._onApplyProposal,a.map,a.nodeName));this.addChild(b)}))},show:function(a){this.cacheString=!1==this.opened?a:this.cacheString+a;a=l.getProposals(this.cacheString);this._setProposals(a);if(0<a.length)return this._open(),a[0].map;this.cacheString="";if(this.opened)e.close(this),this.opened=
!1;return null},_onApplyProposal:function(a,c,b){this.apply(a,c,this.cacheString.length,b)},apply:function(){},enter:function(a){this.onItemClick(this.selectedChild,a)},select:function(){this.selectFirstChild()},selectFirstChild:function(){this.selectChild(this._getFirstSelectableChild())},selectPrev:function(){this.selectChild(this._getNextSelectableChild(this.selectedChild,-1),!0)},selectNext:function(){this.selectChild(this._getNextSelectableChild(this.selectedChild,1))},_getFirstSelectableChild:function(){return this._getNextSelectableChild(null,
1)},_getLastFocusableChild:function(){return this._getNextSelectableChild(null,-1)},_getNextSelectableChild:function(a,c){a&&(a=this._getSiblingOfChild(a,c));for(var b=this.getChildren(),d=0;d<b.length;d++){a||(a=b[0<c?0:b.length-1]);if(a.isFocusable())return a;a=this._getSiblingOfChild(a,c)}return null},selectChild:function(a){if(a)this.selectedChild&&a!==this.selectedChild&&this.selectedChild._setSelected(!1),this.selectedChild=a,a._setSelected(!0)}})});