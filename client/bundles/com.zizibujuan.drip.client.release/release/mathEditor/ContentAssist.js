//>>built
define("mathEditor/ContentAssist","dojo/_base/declare,dojo/_base/array,dojo/_base/lang,dojo/on,dojo/dom-construct,dojo/dom-class,dojo/dom-style,dijit/popup,dijit/DropDownMenu,dijit/MenuItem,mathEditor/mathContentAssist".split(","),function(i,g,f,j,m,n,o,e,k,l,h){return i("mathEditor.ContentAssist",k,{proposals:null,view:null,cacheString:"",opened:!1,postCreate:function(){this.inherited(arguments);j(this.view.editorDiv,"mousedown",f.hitch(this,function(){this.opened&&e.close(this)}))},startup:function(){this.inherited(arguments)},
_scheduleOpen:function(a,b,c){view=this.view;var d=this;if(!this._openTimer)this._openTimer=this.defer(function(){this._openTimer.remove();delete this._openTimer;e.open({popup:a,x:b,y:c,onExecute:function(){e.close(a);view.focus();d.opened=!1},onCancel:function(){e.close(a);d.opened=!1;view.focus()},onClose:function(){view.focus();d.opened=!1}});this.opened=!0;a.select()},0)},_open:function(){var a=this.view.getCursorPosition();this._scheduleOpen(this,a.x,a.y);this.opened=!0},_clear:function(){var a=
this.getChildren();g.forEach(a,f.hitch(this,function(a){this.removeChild(a)}))},_setProposals:function(a){this._clear();this.proposals=a;g.forEach(a,f.hitch(this,function(a){var c=new l({label:a.label+" ( \\"+a.input+" )",iconClass:a.iconClass});c.on("click",f.hitch(this,this._onApplyProposal,a.map,a.nodeName));this.addChild(c)}))},show:function(a){if(!1==this.opened)this.cacheString=a;else{var b=h.getProposals(this.cacheString+a);this.cacheString=0==b.length?a:this.cacheString+a}b=h.getProposals(this.cacheString);
this._setProposals(b);if(0<b.length)return this._open(),b[0].map;this.cacheString="";if(this.opened)e.close(this),this.opened=!1;return null},_onApplyProposal:function(a,b,c){this.apply(a,b,this.cacheString.length,c)},apply:function(){},enter:function(a){this.onItemClick(this.selectedChild,a)},select:function(){this.selectFirstChild()},selectFirstChild:function(){this.selectChild(this._getFirstSelectableChild())},selectPrev:function(){this.selectChild(this._getNextSelectableChild(this.selectedChild,
-1),!0)},selectNext:function(){this.selectChild(this._getNextSelectableChild(this.selectedChild,1))},_getFirstSelectableChild:function(){return this._getNextSelectableChild(null,1)},_getLastFocusableChild:function(){return this._getNextSelectableChild(null,-1)},_getNextSelectableChild:function(a,b){a&&(a=this._getSiblingOfChild(a,b));for(var c=this.getChildren(),d=0;d<c.length;d++){a||(a=c[0<b?0:c.length-1]);if(a.isFocusable())return a;a=this._getSiblingOfChild(a,b)}return null},selectChild:function(a){if(a)this.selectedChild&&
a!==this.selectedChild&&this.selectedChild._setSelected(!1),this.selectedChild=a,a._setSelected(!0)}})});