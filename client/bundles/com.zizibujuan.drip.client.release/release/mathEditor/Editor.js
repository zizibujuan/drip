//>>built
define("mathEditor/Editor","dojo/_base/declare,dojo/_base/lang,dojo/_base/event,dijit/_WidgetBase,dojo/on,dojo/sniff,dojo/keys,dojo/aspect,dojo/dom-construct,dojo/dom-style,dojo/dom-class,mathEditor/Model,mathEditor/View,mathEditor/ContentAssist".split(","),function(g,b,f,h,c,i,d,j,k,l,m,n,o,p){return g("mathEditor.Editor",[h],{model:null,view:null,textarea:null,value:"",_getValueAttr:function(){return this.model.getXML()},_setValueAttr:function(a){this.model.clear();a&&""!=a&&this.model.setData({data:a})},
postCreate:function(){this.inherited(arguments);l.set(this.domNode,{position:"relative"});var a=this.textarea=k.create("textarea",{style:{position:"absolute"}},this.domNode);m.add(a,"drip_text_input");a.wrap="off";a.autocorrect="off";a.autocapitalize="off";a.spellcheck=!1;var q=this.model=new n;this.view=new o({model:this.model,parentNode:this.domNode,textarea:this.textarea});var r=this.contentAssist=new p({view:this.view});j.after(r,"apply",function(s,b,c){q.setData({data:s,nodeName:b,removeCount:c});
setTimeout(function(){a.value=""})},!0);if(i("chrome"))c(a,"textInput",b.hitch(this,function(a){this._onTextInput(a.data)}));else{var e=!1;c(a,"input",b.hitch(this,function(){if(!e)inputData=a.value,""!=inputData&&this._onTextInput(inputData)}));c(a,"compositionstart",b.hitch(this,function(){e=!0}));c(a,"compositionend",b.hitch(this,function(){e=!1}))}c(a,"blur",b.hitch(this,function(){this.view.blur()}));c(a,"keydown",b.hitch(this,function(a){a.keyCode===d.LEFT_ARROW?(this.model.moveLeft(),this.view.showCursor()):
a.keyCode===d.RIGHT_ARROW?this.model.moveRight():a.keyCode===d.UP_ARROW?this.contentAssist.opened?this.contentAssist.selectPrev():this.model.moveUp():a.keyCode===d.DOWN_ARROW?this.contentAssist.opened?this.contentAssist.selectNext():this.model.moveDown():a.keyCode===d.BACKSPACE?this.model.doDelete():a.altKey&&191===a.keyCode?(this.contentAssist.open(),f.stop(a)):a.keyCode===d.ENTER&&(this.contentAssist.opened?this.contentAssist.enter(a):this.model.setData({data:"\n"}),f.stop(a))}))},_onTextInput:function(a){var b=
this.contentAssist.show(a);null!=b&&(a=b);this.model.setData({data:a});var c=this.textarea;setTimeout(function(){c.value=""})}})});