//>>built
require({cache:{"url:drip/templates/MemberNode.html":'<li>\n\t<a data-dojo-attach-point="userImgLinkNode"><img class="avatar" width="20px" height="20px" data-dojo-attach-point="userImgNode"/></a>\n\t<span><a  data-dojo-attach-point="userNickNameLinkNode">\u6635\u79f0</a><em data-dojo-attach-point="userRealNameNode">(\u59d3\u540d)</em></span>\n\t<span class="user-following"><input type="button" data-dojo-attach-point="actionNode"/></span>\n</li>'}});
define("drip/MemberList","dojo/_base/declare,dojo/_base/lang,dojo/_base/array,dojo/dom-construct,dojo/on,dojo/topic,dojo/request/xhr,dijit/_WidgetBase,dijit/_TemplatedMixin,dojo/text!./templates/MemberNode.html".split(","),function(d,b,h,i,e,j,c,f,g,k){var l=d("drip.MemberNode",[f,g],{templateString:k,data:{},postCreate:function(){this.inherited(arguments);var a=this.data,b=a.nickName||a.loginName,c="/users/"+a.digitalId;this.userImgLinkNode.href=c;this.userImgNode.src=a.smallImageUrl||"/drip/resources/images/profile_50_50.gif";
this.userImgNode.alt=b;this.userNickNameLinkNode.innerHTML=b;this.userNickNameLinkNode.href=c;this.userRealNameNode.innerHTML=a.realName?"("+a.realName+")":"";b=a.connectUserId;"0"==a.watched?i.destroy(this.actionNode):"1"==a.watched?this._cancelWatch(b):"2"==a.watched&&this._watch(b)},_cancelWatch:function(a){this.actionNode.value="\u53d6\u6d88\u5173\u6ce8";e.once(this.actionNode,"click",b.hitch(this,function(){c.put("/follow/"+a,{handleAs:"json",query:{op:"off"}}).then(b.hitch(this,function(){this._watch(a);
this.updateFollowingCount(-1)}),b.hitch(this,function(){}))}))},_watch:function(a){this.actionNode.value="+ \u5173\u6ce8";e.once(this.actionNode,"click",b.hitch(this,function(){c.put("/follow/"+a,{handleAs:"json",query:{op:"on"}}).then(b.hitch(this,function(){this._cancelWatch(a);this.updateFollowingCount(1)}),b.hitch(this,function(){}))}))},updateFollowingCount:function(a){j.publish("memberList/updateFollowingCount",a)}});return d("drip.MemberList",[f,g],{templateString:"<ul class='members'></ul>",
url:null,emptyHtml:"",postCreate:function(){this.inherited(arguments);c.get(this.url,{handleAs:"json",preventCache:!0}).then(b.hitch(this,this._load))},_load:function(a){0==a.length?this.domNode.innerHTML=this.emptyHtml:h.forEach(a,b.hitch(this,function(a){this.domNode.appendChild((new l({data:a})).domNode)}))}})});