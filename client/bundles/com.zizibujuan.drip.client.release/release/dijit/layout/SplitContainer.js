//>>built
define("dijit/layout/SplitContainer",["dojo/_base/array","dojo/cookie","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/sniff","../registry","../_WidgetBase","./_LayoutWidget"],function(array,cookie,declare,dom,domClass,domConstruct,domGeometry,domStyle,event,kernel,lang,on,has,registry,_WidgetBase,_LayoutWidget){var SplitContainer=declare("dijit.layout.SplitContainer",_LayoutWidget,{constructor:function(){kernel.deprecated("dijit.layout.SplitContainer is deprecated","use BorderContainer with splitter instead",2)},activeSizing:!1,sizerWidth:7,orientation:"horizontal",persist:!0,baseClass:"dijitSplitContainer",postMixInProperties:function(){this.inherited("postMixInProperties",arguments),this.isHorizontal=this.orientation=="horizontal"},postCreate:function(){this.inherited(arguments),this.sizers=[],has("mozilla")&&(this.domNode.style.overflow="-moz-scrollbars-none");if(typeof this.sizerWidth=="object")try{this.sizerWidth=parseInt(this.sizerWidth.toString())}catch(e){this.sizerWidth=7}var sizer=this.ownerDocument.createElement("div");this.virtualSizer=sizer,sizer.style.position="relative",sizer.style.zIndex=10,sizer.className=this.isHorizontal?"dijitSplitContainerVirtualSizerH":"dijitSplitContainerVirtualSizerV",this.domNode.appendChild(sizer),dom.setSelectable(sizer,!1)},destroy:function(){delete this.virtualSizer;if(this._ownconnects){var h;while(h=this._ownconnects.pop())h.remove()}this.inherited(arguments)},startup:function(){if(this._started)return;array.forEach(this.getChildren(),function(child,i,children){this._setupChild(child),i<children.length-1&&this._addSizer()},this),this.persist&&this._restoreState(),this.inherited(arguments)},_setupChild:function(child){this.inherited(arguments),child.domNode.style.position="absolute",domClass.add(child.domNode,"dijitSplitPane")},_onSizerMouseDown:function(e){if(e.target.id){for(var i=0;i<this.sizers.length;i++)if(this.sizers[i].id==e.target.id)break;i<this.sizers.length&&this.beginSizing(e,i)}},_addSizer:function(index){index=index===undefined?this.sizers.length:index;var sizer=this.ownerDocument.createElement("div");sizer.id=registry.getUniqueId("dijit_layout_SplitterContainer_Splitter"),this.sizers.splice(index,0,sizer),this.domNode.appendChild(sizer),sizer.className=this.isHorizontal?"dijitSplitContainerSizerH":"dijitSplitContainerSizerV";var thumb=this.ownerDocument.createElement("div");thumb.className="thumb",sizer.appendChild(thumb),this.connect(sizer,"onmousedown","_onSizerMouseDown"),dom.setSelectable(sizer,!1)},removeChild:function(widget){if(this.sizers.length){var i=array.indexOf(this.getChildren(),widget);i!=-1&&(i==this.sizers.length&&i--,domConstruct.destroy(this.sizers[i]),this.sizers.splice(i,1))}this.inherited(arguments),this._started&&this.layout()},addChild:function(child,insertIndex){if(typeof insertIndex=="undefined"||insertIndex=="last")insertIndex=this.getChildren().length;this.inherited(arguments,[child,insertIndex]);if(this._started){var children=this.getChildren();children.length>1&&this._addSizer(insertIndex),this.layout()}},layout:function(){this.paneWidth=this._contentBox.w,this.paneHeight=this._contentBox.h;var children=this.getChildren();if(!children.length)return;var space=this.isHorizontal?this.paneWidth:this.paneHeight;children.length>1&&(space-=this.sizerWidth*(children.length-1));var outOf=0;array.forEach(children,function(child){outOf+=child.sizeShare});var pixPerUnit=space/outOf,totalSize=0;array.forEach(children.slice(0,children.length-1),function(child){var size=Math.round(pixPerUnit*child.sizeShare);child.sizeActual=size,totalSize+=size}),children[children.length-1].sizeActual=space-totalSize,this._checkSizes();var pos=0,size=children[0].sizeActual;this._movePanel(children[0],pos,size),children[0].position=pos,pos+=size;if(!this.sizers)return;array.some(children.slice(1),function(child,i){if(!this.sizers[i])return!0;this._moveSlider(this.sizers[i],pos,this.sizerWidth),this.sizers[i].position=pos,pos+=this.sizerWidth,size=child.sizeActual,this._movePanel(child,pos,size),child.position=pos,pos+=size},this)},_movePanel:function(panel,pos,size){var box;this.isHorizontal?(panel.domNode.style.left=pos+"px",panel.domNode.style.top=0,box={w:size,h:this.paneHeight},panel.resize?panel.resize(box):domGeometry.setMarginBox(panel.domNode,box)):(panel.domNode.style.left=0,panel.domNode.style.top=pos+"px",box={w:this.paneWidth,h:size},panel.resize?panel.resize(box):domGeometry.setMarginBox(panel.domNode,box))},_moveSlider:function(slider,pos,size){this.isHorizontal?(slider.style.left=pos+"px",slider.style.top=0,domGeometry.setMarginBox(slider,{w:size,h:this.paneHeight})):(slider.style.left=0,slider.style.top=pos+"px",domGeometry.setMarginBox(slider,{w:this.paneWidth,h:size}))},_growPane:function(growth,pane){return growth>0&&pane.sizeActual>pane.sizeMin&&(pane.sizeActual-pane.sizeMin>growth?(pane.sizeActual=pane.sizeActual-growth,growth=0):(growth-=pane.sizeActual-pane.sizeMin,pane.sizeActual=pane.sizeMin)),growth},_checkSizes:function(){var totalMinSize=0,totalSize=0,children=this.getChildren();array.forEach(children,function(child){totalSize+=child.sizeActual,totalMinSize+=child.sizeMin});if(totalMinSize<=totalSize){var growth=0;array.forEach(children,function(child){child.sizeActual<child.sizeMin&&(growth+=child.sizeMin-child.sizeActual,child.sizeActual=child.sizeMin)});if(growth>0){var list=this.isDraggingLeft?children.reverse():children;array.forEach(list,function(child){growth=this._growPane(growth,child)},this)}}else array.forEach(children,function(child){child.sizeActual=Math.round(totalSize*(child.sizeMin/totalMinSize))})},beginSizing:function(e,i){var children=this.getChildren();this.paneBefore=children[i],this.paneAfter=children[i+1],this.paneBefore.sizeBeforeDrag=this.paneBefore.sizeActual,this.paneAfter.sizeBeforeDrag=this.paneAfter.sizeActual,this.paneAfter.positionBeforeDrag=this.paneAfter.position,this.isSizing=!0,this.sizingSplitter=this.sizers[i],this.sizingSplitter.positionBeforeDrag=domStyle.get(this.sizingSplitter,this.isHorizontal?"left":"top"),this.cover?this.cover.style.zIndex=5:this.cover=domConstruct.create("div",{style:{position:"absolute",zIndex:5,top:0,left:0,width:"100%",height:"100%"}},this.domNode),this.sizingSplitter.style.zIndex=6,this.startPoint=this.lastPoint=this.isHorizontal?e.pageX:e.pageY,this.maxDelta=this.paneAfter.sizeActual-this.paneAfter.sizeMin,this.minDelta=-1*(this.paneBefore.sizeActual-this.paneBefore.sizeMin),this.activeSizing||this._showSizingLine(),this._ownconnects=[on(this.ownerDocument.documentElement,"mousemove",lang.hitch(this,"changeSizing")),on(this.ownerDocument.documentElement,"mouseup",lang.hitch(this,"endSizing"))],event.stop(e)},changeSizing:function(e){if(!this.isSizing)return;this.lastPoint=this.isHorizontal?e.pageX:e.pageY;var delta=Math.max(Math.min(this.lastPoint-this.startPoint,this.maxDelta),this.minDelta);this.activeSizing?this._updateSize(delta):this._moveSizingLine(delta),event.stop(e)},endSizing:function(){if(!this.isSizing)return;this.cover&&(this.cover.style.zIndex=-1),this.activeSizing||this._hideSizingLine();var delta=Math.max(Math.min(this.lastPoint-this.startPoint,this.maxDelta),this.minDelta);this._updateSize(delta),this.isSizing=!1,this.persist&&this._saveState(this);var h;while(h=this._ownconnects.pop())h.remove()},_updateSize:function(delta){this.paneBefore.sizeActual=this.paneBefore.sizeBeforeDrag+delta,this.paneAfter.position=this.paneAfter.positionBeforeDrag+delta,this.paneAfter.sizeActual=this.paneAfter.sizeBeforeDrag-delta,array.forEach(this.getChildren(),function(child){child.sizeShare=child.sizeActual}),this._started&&this.layout()},_showSizingLine:function(){this._moveSizingLine(0),domGeometry.setMarginBox(this.virtualSizer,this.isHorizontal?{w:this.sizerWidth,h:this.paneHeight}:{w:this.paneWidth,h:this.sizerWidth}),this.virtualSizer.style.display="block"},_hideSizingLine:function(){this.virtualSizer.style.display="none"},_moveSizingLine:function(delta){var pos=delta+this.sizingSplitter.positionBeforeDrag;domStyle.set(this.virtualSizer,this.isHorizontal?"left":"top",pos+"px")},_getCookieName:function(i){return this.id+"_"+i},_restoreState:function(){array.forEach(this.getChildren(),function(child,i){var cookieName=this._getCookieName(i),cookieValue=cookie(cookieName);if(cookieValue){var pos=parseInt(cookieValue);typeof pos=="number"&&(child.sizeShare=pos)}},this)},_saveState:function(){if(!this.persist)return;array.forEach(this.getChildren(),function(child,i){cookie(this._getCookieName(i),child.sizeShare,{expires:365})},this)}});return SplitContainer.ChildWidgetProperties={sizeMin:10,sizeShare:10},lang.extend(_WidgetBase,SplitContainer.ChildWidgetProperties),SplitContainer})