//>>built
define("dijit/layout/StackContainer",["dojo/_base/array","dojo/cookie","dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/has","dojo/_base/lang","dojo/on","dojo/ready","dojo/topic","dojo/when","../registry","../_WidgetBase","./_LayoutWidget","dojo/i18n!../nls/common"],function(array,cookie,declare,domClass,domConstruct,has,lang,on,ready,topic,when,registry,_WidgetBase,_LayoutWidget){has("dijit-legacy-requires")&&ready(0,function(){var requires=["dijit/layout/StackController"];require(requires)});var StackContainer=declare("dijit.layout.StackContainer",_LayoutWidget,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments),domClass.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments),this.own(on(this.domNode,"keydown",lang.hitch(this,"_onKeyDown")))},startup:function(){if(this._started)return;var children=this.getChildren();array.forEach(children,this._setupChild,this),this.persist?this.selectedChildWidget=registry.byId(cookie(this.id+"_selectedChild")):array.some(children,function(child){return child.selected&&(this.selectedChildWidget=child),child.selected},this);var selected=this.selectedChildWidget;!selected&&children[0]&&(selected=this.selectedChildWidget=children[0],selected.selected=!0),topic.publish(this.id+"-startup",{children:children,selected:selected,textDir:this.textDir}),this.inherited(arguments)},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var selected=this.selectedChildWidget;selected&&this._showChild(selected)}this.inherited(arguments)},_setupChild:function(child){var childNode=child.domNode,wrapper=domConstruct.place("<div role='tabpanel' class='"+this.baseClass+"ChildWrapper'>",child.domNode,"replace"),label=child["aria-label"]||child.title||child.label;label&&wrapper.setAttribute("aria-label",label),domConstruct.place(childNode,wrapper),child._wrapper=wrapper,this.inherited(arguments),domClass.replace(wrapper,"dijitHidden","dijitVisible"),childNode.style.display=="none"&&(childNode.style.display="block"),child.domNode.title=""},addChild:function(child,insertIndex){this.inherited(arguments),this._started&&(topic.publish(this.id+"-addChild",child,insertIndex),this.layout(),this.selectedChildWidget||this.selectChild(child))},removeChild:function(page){var idx=array.indexOf(this.getChildren(),page);this.inherited(arguments),domConstruct.destroy(page._wrapper),delete page._wrapper,this._started&&topic.publish(this.id+"-removeChild",page);if(this._descendantsBeingDestroyed)return;if(this.selectedChildWidget===page){this.selectedChildWidget=undefined;if(this._started){var children=this.getChildren();children.length&&this.selectChild(children[Math.max(idx-1,0)])}}this._started&&this.layout()},selectChild:function(page,animate){var d;return page=registry.byId(page),this.selectedChildWidget!=page&&(d=this._transition(page,this.selectedChildWidget,animate),this._set("selectedChildWidget",page),topic.publish(this.id+"-selectChild",page),this.persist&&cookie(this.id+"_selectedChild",this.selectedChildWidget.id)),when(d||!0)},_transition:function(newWidget,oldWidget){oldWidget&&this._hideChild(oldWidget);var d=this._showChild(newWidget);return newWidget.resize&&(this.doLayout?newWidget.resize(this._containerContentBox||this._contentBox):newWidget.resize()),d},_adjacent:function(forward){var children=this.getChildren(),index=array.indexOf(children,this.selectedChildWidget);return index+=forward?1:children.length-1,children[index%children.length]},forward:function(){return this.selectChild(this._adjacent(!0),!0)},back:function(){return this.selectChild(this._adjacent(!1),!0)},_onKeyDown:function(e){topic.publish(this.id+"-containerKeyDown",{e:e,page:this})},layout:function(){var child=this.selectedChildWidget;child&&child.resize&&(this.doLayout?child.resize(this._containerContentBox||this._contentBox):child.resize())},_showChild:function(page){var children=this.getChildren();return page.isFirstChild=page==children[0],page.isLastChild=page==children[children.length-1],page._set("selected",!0),domClass.replace(page._wrapper,"dijitVisible","dijitHidden"),page._onShow&&page._onShow()||!0},_hideChild:function(page){page._set("selected",!1),domClass.replace(page._wrapper,"dijitHidden","dijitVisible"),page.onHide&&page.onHide()},closeChild:function(page){var remove=page.onClose&&page.onClose(this,page);remove&&(this.removeChild(page),page.destroyRecursive())},destroyDescendants:function(preserveDom){this._descendantsBeingDestroyed=!0,this.selectedChildWidget=undefined,array.forEach(this.getChildren(),function(child){preserveDom||this.removeChild(child),child.destroyRecursive(preserveDom)},this),this._descendantsBeingDestroyed=!1}});return StackContainer.ChildWidgetProperties={selected:!1,disabled:!1,closable:!1,iconClass:"dijitNoIcon",showTitle:!0},lang.extend(_WidgetBase,StackContainer.ChildWidgetProperties),StackContainer})