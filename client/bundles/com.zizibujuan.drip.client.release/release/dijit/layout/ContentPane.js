//>>built
define("dijit/layout/ContentPane",["dojo/_base/kernel","dojo/_base/lang","../_Widget","../_Container","./_ContentPaneResizeMixin","dojo/string","dojo/html","dojo/i18n!../nls/loading","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/_base/xhr","dojo/i18n","dojo/when"],function(kernel,lang,_Widget,_Container,_ContentPaneResizeMixin,string,html,nlsLoading,array,declare,Deferred,dom,domAttr,domConstruct,xhr,i18n,when){return declare("dijit.layout.ContentPane",[_Widget,_Container,_ContentPaneResizeMixin],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:kernel._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"<span class='dijitContentPaneLoading'><span class='dijitInline dijitIconLoading'></span>${loadingState}</span>",errorMessage:"<span class='dijitContentPaneError'><span class='dijitInline dijitIconError'></span>${errorState}</span>",isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(params,node,ctor){var self=new ctor(params,node);return!self.href&&self._contentSetter&&self._contentSetter.parseDeferred&&!self._contentSetter.parseDeferred.isFulfilled()?self._contentSetter.parseDeferred.then(function(){return self}):self},create:function(params,srcNodeRef){if((!params||!params.template)&&srcNodeRef&&!("href"in params)&&!("content"in params)){srcNodeRef=dom.byId(srcNodeRef);var df=srcNodeRef.ownerDocument.createDocumentFragment();while(srcNodeRef.firstChild)df.appendChild(srcNodeRef.firstChild);params=lang.delegate(params,{content:df})}this.inherited(arguments,[params,srcNodeRef])},postMixInProperties:function(){this.inherited(arguments);var messages=i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=string.substitute(this.loadingMessage,messages),this.errorMessage=string.substitute(this.errorMessage,messages)},buildRendering:function(){this.inherited(arguments),this.containerNode||(this.containerNode=this.domNode),this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments),this._contentSetter&&array.forEach(this._contentSetter.parseResults,function(obj){!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)&&(obj.startup(),obj._started=!0)},this)},_startChildren:function(){array.forEach(this.getChildren(),function(obj){!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)&&(obj.startup(),obj._started=!0)}),this._contentSetter&&array.forEach(this._contentSetter.parseResults,function(obj){!obj._started&&!obj._destroyed&&lang.isFunction(obj.startup)&&(obj.startup(),obj._started=!0)},this)},setHref:function(href){return kernel.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0"),this.set("href",href)},_setHrefAttr:function(href){return this.cancel(),this.onLoadDeferred=new Deferred(lang.hitch(this,"cancel")),this.onLoadDeferred.then(lang.hitch(this,"onLoad")),this._set("href",href),this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0,this.onLoadDeferred},setContent:function(data){kernel.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0"),this.set("content",data)},_setContentAttr:function(data){return this._set("href",""),this.cancel(),this.onLoadDeferred=new Deferred(lang.hitch(this,"cancel")),this._created&&this.onLoadDeferred.then(lang.hitch(this,"onLoad")),this._setContent(data||""),this._isDownloaded=!1,this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&this._xhrDfd.fired==-1&&this._xhrDfd.cancel(),delete this._xhrDfd,this.onLoadDeferred=null},destroy:function(){this.cancel(),this.inherited(arguments)},destroyRecursive:function(preserveDom){if(this._beingDestroyed)return;this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){return this.cancel(),this.onLoadDeferred=new Deferred(lang.hitch(this,"cancel")),this.onLoadDeferred.then(lang.hitch(this,"onLoad")),this._load(),this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var self=this,getArgs={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};lang.isObject(this.ioArgs)&&lang.mixin(getArgs,this.ioArgs);var hand=this._xhrDfd=(this.ioMethod||xhr.get)(getArgs),returnedHtml;hand.then(function(html){returnedHtml=html;try{return self._isDownloaded=!0,self._setContent(html,!1)}catch(err){self._onError("Content",err)}},function(err){return hand.canceled||self._onError("Download",err),delete self._xhrDfd,err}).then(function(){return self.onDownloadEnd(),delete self._xhrDfd,returnedHtml}),delete this._hrefChanged},_onLoadHandler:function(data){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(data)}catch(e){0}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(e){0}},destroyDescendants:function(preserveDom){this.isLoaded&&this._onUnloadHandler();var setter=this._contentSetter;array.forEach(this.getChildren(),function(widget){widget.destroyRecursive?widget.destroyRecursive(preserveDom):widget.destroy&&widget.destroy(preserveDom),widget._destroyed=!0}),setter&&(array.forEach(setter.parseResults,function(widget){widget._destroyed||(widget.destroyRecursive?widget.destroyRecursive(preserveDom):widget.destroy&&widget.destroy(preserveDom),widget._destroyed=!0)}),delete setter.parseResults),preserveDom||domConstruct.empty(this.containerNode),delete this._singleChild},_setContent:function(cont,isFakeContent){this.destroyDescendants();var setter=this._contentSetter;setter&&setter instanceof html._ContentSetter||(setter=this._contentSetter=new html._ContentSetter({node:this.containerNode,_onError:lang.hitch(this,this._onError),onContentError:lang.hitch(this,function(e){var errMess=this.onContentError(e);try{this.containerNode.innerHTML=errMess}catch(e){0}})}));var setterParams=lang.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!cont.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),p=setter.set(lang.isObject(cont)&&cont.domNode?cont.domNode:cont,setterParams),self=this;return when(p&&p.then?p:setter.parseDeferred,function(){delete self._contentSetterParams,isFakeContent||(self._started&&(self._startChildren(),self._scheduleLayout()),self._onLoadHandler(cont))})},_onError:function(type,err,consoleText){this.onLoadDeferred.reject(err);var errText=this["on"+type+"Error"].call(this,err);consoleText?0:errText&&this._setContent(errText,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})