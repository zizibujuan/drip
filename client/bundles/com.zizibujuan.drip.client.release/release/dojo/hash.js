//>>built
define("dojo/hash",["./_base/kernel","require","./_base/config","./aspect","./_base/lang","./topic","./domReady","./sniff"],function(dojo,require,config,aspect,lang,topic,domReady,has){function _getSegment(str,delimiter){var i=str.indexOf(delimiter);return i>=0?str.substring(i+1):""}function _getHash(){return _getSegment(location.href,"#")}function _dispatchEvent(){topic.publish("/dojo/hashchange",_getHash())}function _pollLocation(){if(_getHash()===_recentHash)return;_recentHash=_getHash(),_dispatchEvent()}function _replace(hash){if(_ieUriMonitor){if(_ieUriMonitor.isTransitioning()){setTimeout(lang.hitch(null,_replace,hash),_pollFrequency);return}var href=_ieUriMonitor.iframe.location.href,index=href.indexOf("?");_ieUriMonitor.iframe.location.replace(href.substring(0,index)+"?"+hash);return}location.replace("#"+hash),!_connect&&_pollLocation()}function IEUriMonitor(){function resetState(){_recentHash=_getHash(),recentIframeQuery=ifrOffline?_recentHash:_getSegment(iframeLoc.href,"?"),transitioning=!1,expectedIFrameQuery=null}var ifr=document.createElement("iframe"),IFRAME_ID="dojo-hash-iframe",ifrSrc=config.dojoBlankHtmlUrl||require.toUrl("./resources/blank.html");config.useXDomain&&!config.dojoBlankHtmlUrl&&0,ifr.id=IFRAME_ID,ifr.src=ifrSrc+"?"+_getHash(),ifr.style.display="none",document.body.appendChild(ifr),this.iframe=dojo.global[IFRAME_ID];var recentIframeQuery,transitioning,expectedIFrameQuery,docTitle,ifrOffline,iframeLoc=this.iframe.location;this.isTransitioning=function(){return transitioning},this.pollLocation=function(){if(!ifrOffline)try{var iframeSearch=_getSegment(iframeLoc.href,"?");document.title!=docTitle&&(docTitle=this.iframe.document.title=document.title)}catch(e){ifrOffline=!0,0}var hash=_getHash();if(transitioning&&_recentHash===hash){if(!ifrOffline&&iframeSearch!==expectedIFrameQuery){setTimeout(lang.hitch(this,this.pollLocation),0);return}resetState(),_dispatchEvent()}else if(_recentHash!==hash||!ifrOffline&&recentIframeQuery!==iframeSearch){if(_recentHash!==hash){_recentHash=hash,transitioning=!0,expectedIFrameQuery=hash,ifr.src=ifrSrc+"?"+expectedIFrameQuery,ifrOffline=!1,setTimeout(lang.hitch(this,this.pollLocation),0);return}ifrOffline||(location.href="#"+iframeLoc.search.substring(1),resetState(),_dispatchEvent())}setTimeout(lang.hitch(this,this.pollLocation),_pollFrequency)},resetState(),setTimeout(lang.hitch(this,this.pollLocation),_pollFrequency)}dojo.hash=function(hash,replace){return arguments.length?(hash.charAt(0)=="#"&&(hash=hash.substring(1)),replace?_replace(hash):location.href="#"+hash,hash):_getHash()};var _recentHash,_ieUriMonitor,_connect,_pollFrequency=config.hashPollFrequency||100;return domReady(function(){"onhashchange"in dojo.global&&(!has("ie")||has("ie")>=8&&document.compatMode!="BackCompat")?_connect=aspect.after(dojo.global,"onhashchange",_dispatchEvent,!0):document.addEventListener?(_recentHash=_getHash(),setInterval(_pollLocation,_pollFrequency)):document.attachEvent&&(_ieUriMonitor=new IEUriMonitor)}),dojo.hash})