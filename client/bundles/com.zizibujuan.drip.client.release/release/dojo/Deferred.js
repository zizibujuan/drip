//>>built
define("dojo/Deferred",["./has","./_base/lang","./errors/CancelError","./promise/Promise","require"],function(r,s,n,o,l){var p=Object.freeze||function(){},j=function(b,a,c,d){for(var e=0;e<b.length;e++)m(b[e],a,c,d)},m=function(b,a,c){var d=b[a],e=b.deferred;if(d)try{var f=d(c);0===a?"undefined"!==typeof f&&g(e,a,f):f&&"function"===typeof f.then?(b.cancel=f.cancel,f.then(k(e,1),k(e,2),k(e,0))):g(e,1,f)}catch(h){g(e,2,h)}else g(e,a,c)},k=function(b,a){return function(c){g(b,a,c)}},g=function(b,a,c){if(!b.isCanceled())switch(a){case 0:b.progress(c);
break;case 1:b.resolve(c);break;case 2:b.reject(c)}},i=function(b){var a=this.promise=new o,c=this,d,e,f=!1,h=[];this.isResolved=a.isResolved=function(){return 1===d};this.isRejected=a.isRejected=function(){return 2===d};this.isFulfilled=a.isFulfilled=function(){return!!d};this.isCanceled=a.isCanceled=function(){return f};this.progress=function(q,b){if(d){if(!0===b)throw Error("This deferred has already been fulfilled.");return a}j(h,0,q,null,c);return a};this.resolve=function(b,f){if(d){if(!0===
f)throw Error("This deferred has already been fulfilled.");return a}j(h,d=1,e=b,null,c);h=null;return a};var g=this.reject=function(b,f){if(d){if(!0===f)throw Error("This deferred has already been fulfilled.");return a}j(h,d=2,e=b,void 0,c);h=null;return a};this.then=a.then=function(b,c,f){var g=[f,b,c];g.cancel=a.cancel;g.deferred=new i(function(a){return g.cancel&&g.cancel(a)});d&&!h?m(g,d,e,void 0):h.push(g);return g.deferred.promise};this.cancel=a.cancel=function(a,c){if(d){if(!0===c)throw Error("This deferred has already been fulfilled.");
}else{if(b)var h=b(a),a="undefined"===typeof h?a:h;f=!0;if(d){if(2===d&&e===a)return a}else return"undefined"===typeof a&&(a=new n),g(a),a}};p(a)};i.prototype.toString=function(){return"[object Deferred]"};l&&l(i);return i});