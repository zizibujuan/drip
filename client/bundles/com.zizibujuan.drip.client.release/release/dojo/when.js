//>>built
define("dojo/when",["./Deferred","./promise/Promise"],function(Deferred,Promise){"use strict";return function(valueOrPromise,callback,errback,progback){var receivedPromise=valueOrPromise&&typeof valueOrPromise.then=="function",nativePromise=receivedPromise&&valueOrPromise instanceof Promise;if(!receivedPromise)return callback?callback(valueOrPromise):(new Deferred).resolve(valueOrPromise);if(!nativePromise){var deferred=new Deferred(valueOrPromise.cancel);valueOrPromise.then(deferred.resolve,deferred.reject,deferred.progress),valueOrPromise=deferred.promise}return callback||errback||progback?valueOrPromise.then(callback,errback,progback):valueOrPromise}})