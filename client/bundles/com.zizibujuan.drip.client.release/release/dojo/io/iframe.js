//>>built
define("dojo/io/iframe",["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(config,json,kernel,lang,xhr,has,win,dom,domConstruct,query,require,aspect,_iframe){kernel.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var mid=_iframe._iframeName;mid=mid.substring(0,mid.lastIndexOf("_"));var iframe=lang.delegate(_iframe,{create:function(){return iframe._frame=_iframe.create.apply(_iframe,arguments)},get:null,post:null,send:function(args){var rDfd,dfd=xhr._ioSetArgs(args,function(dfd){rDfd&&rDfd.cancel()},function(dfd){var value=null,ioArgs=dfd.ioArgs;try{var handleAs=ioArgs.handleAs;handleAs==="xml"||handleAs==="html"?value=rDfd.response.data:(value=rDfd.response.text,handleAs==="json"?value=json.fromJson(value):handleAs==="javascript"&&(value=kernel.eval(value)))}catch(e){value=e}return value},function(error,dfd){return dfd.ioArgs._hasError=!0,error}),ioArgs=dfd.ioArgs,method="GET",form=dom.byId(args.form);args.method&&args.method.toUpperCase()==="POST"&&form&&(method="POST");var options={method:method,handleAs:args.handleAs==="json"||args.handleAs==="javascript"?"text":args.handleAs,form:args.form,query:form?null:args.content,data:form?args.content:null,timeout:args.timeout,ioArgs:ioArgs};options.method&&(options.method=options.method.toUpperCase());if(config.ioPublish&&kernel.publish&&ioArgs.args.ioPublish!==!1)var start=aspect.after(_iframe,"_notifyStart",function(data){data.options.ioArgs===ioArgs&&(start.remove(),xhr._ioNotifyStart(dfd))},!0);return rDfd=_iframe(ioArgs.url,options,!0),ioArgs._callNext=rDfd._callNext,rDfd.then(function(){dfd.resolve(dfd)}).otherwise(function(error){dfd.ioArgs.error=error,dfd.reject(error)}),dfd},_iframeOnload:win.global[mid+"_onload"]});return lang.setObject("dojo.io.iframe",iframe),iframe})