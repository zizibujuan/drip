//>>built
define("dojo/promise/all",["../_base/array","../Deferred","../when"],function(array,Deferred,when){"use strict";var some=array.some;return function(objectOrArray){var object,array;objectOrArray instanceof Array?array=objectOrArray:objectOrArray&&typeof objectOrArray=="object"&&(object=objectOrArray);var results,keyLookup=[];if(object){array=[];for(var key in object)Object.hasOwnProperty.call(object,key)&&(keyLookup.push(key),array.push(object[key]));results={}}else array&&(results=[]);if(!array||!array.length)return(new Deferred).resolve(results);var deferred=new Deferred;deferred.promise.always(function(){results=keyLookup=null});var waiting=array.length;return some(array,function(valueOrPromise,index){return object||keyLookup.push(index),when(valueOrPromise,function(value){deferred.isFulfilled()||(results[keyLookup[index]]=value,--waiting===0&&deferred.resolve(results))},deferred.reject),deferred.isFulfilled()}),deferred.promise}})