//>>built
define("dojo/selector/lite",["../has","../_base/kernel"],function(has,dojo){"use strict";var testDiv=document.createElement("div"),matchesSelector=testDiv.matchesSelector||testDiv.webkitMatchesSelector||testDiv.mozMatchesSelector||testDiv.msMatchesSelector||testDiv.oMatchesSelector,querySelectorAll=testDiv.querySelectorAll,unionSplit=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;has.add("dom-matches-selector",!!matchesSelector),has.add("dom-qsa",!!querySelectorAll);var liteEngine=function(selector,root){if(combine&&selector.indexOf(",")>-1)return combine(selector,root);var doc=root?root.ownerDocument||root:dojo.doc||document,match=(querySelectorAll?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(selector);root=root||doc;if(match){if(match[2]){var found=dojo.byId?dojo.byId(match[2]):doc.getElementById(match[2]);if(!found||match[1]&&match[1]!=found.tagName.toLowerCase())return[];if(root!=doc){var parent=found;while(parent!=root){parent=parent.parentNode;if(!parent)return[]}}return match[3]?liteEngine(match[3],found):[found]}if(match[3]&&root.getElementsByClassName)return root.getElementsByClassName(match[4]);var found;if(match[5]){found=root.getElementsByTagName(match[5]);if(!match[4]&&!match[6])return found;selector=(match[4]||"")+match[6]}}if(querySelectorAll)return root.nodeType===1&&root.nodeName.toLowerCase()!=="object"?useRoot(root,selector,root.querySelectorAll):root.querySelectorAll(selector);found||(found=root.getElementsByTagName("*"));var results=[];for(var i=0,l=found.length;i<l;i++){var node=found[i];node.nodeType==1&&jsMatchesSelector(node,selector,root)&&results.push(node)}return results},useRoot=function(context,query,method){var oldContext=context,old=context.getAttribute("id"),nid=old||"__dojo__",hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(relativeHierarchySelector&&!hasParent)return[];old?nid=nid.replace(/'/g,"\\$&"):context.setAttribute("id",nid),relativeHierarchySelector&&hasParent&&(context=context.parentNode);var selectors=query.match(unionSplit);for(var i=0;i<selectors.length;i++)selectors[i]="[id='"+nid+"'] "+selectors[i];query=selectors.join(",");try{return method.call(context,query)}finally{old||oldContext.removeAttribute("id")}};if(!has("dom-matches-selector"))var jsMatchesSelector=function(){function attr(name,value,type){var firstChar=value.charAt(0);if(firstChar=='"'||firstChar=="'")value=value.slice(1,-1);value=value.replace(/\\/g,"");var comparator=attrComparators[type||""];return function(node){var attrValue=node.getAttribute(name);return attrValue&&comparator(attrValue,value)}}function ancestor(matcher){return function(node,root){while((node=node.parentNode)!=root)if(matcher(node,root))return!0}}function parent(matcher){return function(node,root){return node=node.parentNode,matcher?node!=root&&matcher(node,root):node==root}}function and(matcher,next){return matcher?function(node,root){return next(node)&&matcher(node,root)}:next}var caseFix=testDiv.tagName=="div"?"toLowerCase":"toUpperCase",selectorTypes={"":function(tagName){return tagName=tagName[caseFix](),function(node){return node.tagName==tagName}},".":function(className){var classNameSpaced=" "+className+" ";return function(node){return node.className.indexOf(className)>-1&&(" "+node.className+" ").indexOf(classNameSpaced)>-1}},"#":function(id){return function(node){return node.id==id}}},attrComparators={"^=":function(attrValue,value){return attrValue.indexOf(value)==0},"*=":function(attrValue,value){return attrValue.indexOf(value)>-1},"$=":function(attrValue,value){return attrValue.substring(attrValue.length-value.length,attrValue.length)==value},"~=":function(attrValue,value){return(" "+attrValue+" ").indexOf(" "+value+" ")>-1},"|=":function(attrValue,value){return(attrValue+"-").indexOf(value+"-")==0},"=":function(attrValue,value){return attrValue==value},"":function(attrValue,value){return!0}},cache={};return function(node,selector,root){var matcher=cache[selector];if(!matcher){if(selector.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,function(t,combinator,type,value,attrName,attrType,attrValue){return value?matcher=and(matcher,selectorTypes[type||""](value.replace(/\\/g,""))):combinator?matcher=(combinator==" "?ancestor:parent)(matcher):attrName&&(matcher=and(matcher,attr(attrName,attrValue,attrType))),""}))throw new Error("Syntax error in query");if(!matcher)return!0;cache[selector]=matcher}return matcher(node,root)}}();if(!has("dom-qsa"))var combine=function(selector,root){var selectors=selector.match(unionSplit),indexed=[];for(var i=0;i<selectors.length;i++){selector=new String(selectors[i].replace(/\s*$/,"")),selector.indexOf=escape;var results=liteEngine(selector,root);for(var j=0,l=results.length;j<l;j++){var node=results[j];indexed[node.sourceIndex]=node}}var totalResults=[];for(i in indexed)totalResults.push(indexed[i]);return totalResults};return liteEngine.match=matchesSelector?function(node,selector,root){return root&&root.nodeType!=9?useRoot(root,selector,function(query){return matchesSelector.call(node,query)}):matchesSelector.call(node,selector)}:jsMatchesSelector,liteEngine})