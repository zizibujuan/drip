<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>关注我的人 · 孜孜不倦</title>
<link type="text/css" rel="stylesheet" href="/drip/resources/app.css" />

<script type="text/javascript" 
	data-dojo-config="
		async:true,
		parseOnLoad:false,
		isDebug:true" 
	src="/dojo/dojo.js"></script>

<script type="text/javascript">
require(["dojo/parser",
         "dojo/dom",
         "drip/user",
         "drip/MemberList",
         "dojo/domReady!"], function(
        		 parser,
        		 dom,
        		 user){
	// TODO:获取要查看用户信息的标识
	// 第一个版本先从cookie中获取，后续编码改为在后台jsp或者其他模板语言中赋值
	// 或者从链接中的参数中获取值
	var splitPathName = window.location.pathname.split("/");
	var action = splitPathName[1];
	var userId = splitPathName[2];
	//如果userId为null，则从session中获取
	// 修改标题
	// 选择tab
	
	// 这里不应该是获取登录用户信息，而是id标识的用户信息
	user.getLoggedUserInfo().then(function(userInfo){
		console.log("登录用户信息:", userInfo);
		// 在右侧用户信息区域显示
		var displayName = userInfo.nickName;
		// 在顶部用户信息区域显示
		var topProfileImage = dom.byId("topProfileImage");
		topProfileImage.src = userInfo.smallImageUrl || "/drip/resources/images/profile_50_50.gif";;
		topProfileImage.alt = displayName;
		dom.byId("topUserName").innerHTML = displayName;
	});
	
	parser.parse(dom.byId('memberList'));
});
</script>

</head>
<body class="claro">
	<div id="wrapper" class="drip_body">
		<div class="drip_header drip_header_logged_in" style="position: fixed; width: 100%">
			<div class="container clearfix">
				<a href="/" class="drip_header_logo" style="height:25px;">
					<img alt="孜孜不倦" style="height:25px;" src="/drip/resources/images/home_logo.png">
				</a>
				<div class="divider-vertical"></div>
				<ul class="drip_top_nav">
					<li><a href="/">首页</a></li>
					<li><a href="/exercises">题库</a></li>
				</ul>
				<ul class="drip_user_links">
					<li>
					<a href="#" class="drip_name">
						<img width="20px" height="20px" id="topProfileImage">
						<span id="topUserName"></span>
					</a>
					</li>
					<li><a href="/exercises/new" title="录入新习题" class="drip_new_exercise">+习题</a></li>
					<li><input type="button" title="退出" id="logout" value="退出" class="logout"></input></li>
				</ul>
			</div>
		</div>
		<div class="container" style="padding-top: 60px;">
			<div>
				<div class="drip_tab_nav">
					<ul class="drip_tab_nav_tabs">
						<li>
							<a href="/followers/xxxx(用户标识)" class="drip_tab_nav_tab">关注 <span class="counter" id="followers_count">0</span></a>
						</li>
						<li>
							<a href="/following/xxxx(用户标识)" class="selected drip_tab_nav_tab">粉丝 <span class="counter" id="following_count">0</span></a>
						</li>
					</ul>
				</div>
				<!-- 如何传递xxx的值 -->
				<div class="drip_activity_list" style="padding-top:20px">
					<div id="memberList" 
					data-dojo-type="drip/MemberList" 
					data-dojo-props="url:'/followers/xxxx',emptyHtml:'还没有粉丝'"
					style="padding-top: 10px;padding-left: 10px;padding-right:10px">加载中...</div>
				</div>
			</div>
		</div>
	</div>

</body>
</html>